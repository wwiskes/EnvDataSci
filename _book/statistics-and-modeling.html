<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7 Statistics and Modeling | Introduction to Environmental Data Science</title>
  <meta name="description" content="Background, concepts and exercises for using R for environmental data science. The focus is on applying the R language and various libraries for data manipulation, data analysis, time series, modeling, and spatial data/mapping. The output format for this example is bookdown::gitbook. Book is under development, and currently just has five chapters, including this prerequisite chapter." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="7 Statistics and Modeling | Introduction to Environmental Data Science" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Background, concepts and exercises for using R for environmental data science. The focus is on applying the R language and various libraries for data manipulation, data analysis, time series, modeling, and spatial data/mapping. The output format for this example is bookdown::gitbook. Book is under development, and currently just has five chapters, including this prerequisite chapter." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7 Statistics and Modeling | Introduction to Environmental Data Science" />
  
  <meta name="twitter:description" content="Background, concepts and exercises for using R for environmental data science. The focus is on applying the R language and various libraries for data manipulation, data analysis, time series, modeling, and spatial data/mapping. The output format for this example is bookdown::gitbook. Book is under development, and currently just has five chapters, including this prerequisite chapter." />
  

<meta name="author" content="Jerry Davis" />


<meta name="date" content="2021-04-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="spatial-data-and-maps.html"/>
<link rel="next" href="time-series.html"/>
<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.2/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.3/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.3/leaflet-providers-plugin.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Environmental Data Science</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prerequisites</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#packages-to-install"><i class="fa fa-check"></i><b>1.1</b> Packages to install</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#data"><i class="fa fa-check"></i><b>1.2</b> Data</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction-to-r.html"><a href="introduction-to-r.html"><i class="fa fa-check"></i><b>2</b> Introduction to R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#variables"><i class="fa fa-check"></i><b>2.1</b> Variables</a></li>
<li class="chapter" data-level="2.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#functions"><i class="fa fa-check"></i><b>2.2</b> Functions</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#expressions-and-statements"><i class="fa fa-check"></i><b>2.3</b> Expressions and Statements</a></li>
<li class="chapter" data-level="2.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#data-types"><i class="fa fa-check"></i><b>2.4</b> Data Types</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#integers"><i class="fa fa-check"></i><b>2.4.1</b> Integers</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="introduction-to-r.html"><a href="introduction-to-r.html#rectangular-data"><i class="fa fa-check"></i><b>2.5</b> Rectangular data</a></li>
<li class="chapter" data-level="2.6" data-path="introduction-to-r.html"><a href="introduction-to-r.html#data-structures-in-r"><i class="fa fa-check"></i><b>2.6</b> Data Structures in R</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#vectors"><i class="fa fa-check"></i><b>2.6.1</b> Vectors</a></li>
<li class="chapter" data-level="2.6.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#lists"><i class="fa fa-check"></i><b>2.6.2</b> Lists</a></li>
<li class="chapter" data-level="2.6.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#matrices"><i class="fa fa-check"></i><b>2.6.3</b> Matrices</a></li>
<li class="chapter" data-level="2.6.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#data-frames"><i class="fa fa-check"></i><b>2.6.4</b> Data frames</a></li>
<li class="chapter" data-level="2.6.5" data-path="introduction-to-r.html"><a href="introduction-to-r.html#factors"><i class="fa fa-check"></i><b>2.6.5</b> Factors</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="introduction-to-r.html"><a href="introduction-to-r.html#programming-scripts-in-rstudio"><i class="fa fa-check"></i><b>2.7</b> Programming scripts in RStudio</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#subsetting-with-logic"><i class="fa fa-check"></i><b>2.7.1</b> Subsetting with logic</a></li>
<li class="chapter" data-level="2.7.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#apply-functions"><i class="fa fa-check"></i><b>2.7.2</b> Apply functions</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="introduction-to-r.html"><a href="introduction-to-r.html#exercises"><i class="fa fa-check"></i><b>2.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-abstraction.html"><a href="data-abstraction.html"><i class="fa fa-check"></i><b>3</b> Data Abstraction</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-abstraction.html"><a href="data-abstraction.html#background-exploratory-data-analysis"><i class="fa fa-check"></i><b>3.1</b> Background: Exploratory Data Analysis</a></li>
<li class="chapter" data-level="3.2" data-path="data-abstraction.html"><a href="data-abstraction.html#the-tidyverse-and-what-well-explore-in-this-chapter"><i class="fa fa-check"></i><b>3.2</b> The Tidyverse and what we’ll explore in this chapter</a></li>
<li class="chapter" data-level="3.3" data-path="data-abstraction.html"><a href="data-abstraction.html#tibbles"><i class="fa fa-check"></i><b>3.3</b> Tibbles</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="data-abstraction.html"><a href="data-abstraction.html#read_csv-vs.-read.csv"><i class="fa fa-check"></i><b>3.3.1</b> <code>read_csv</code> vs. <code>read.csv</code></a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="data-abstraction.html"><a href="data-abstraction.html#statistical-summary-of-variables"><i class="fa fa-check"></i><b>3.4</b> Statistical summary of variables</a></li>
<li class="chapter" data-level="3.5" data-path="data-abstraction.html"><a href="data-abstraction.html#visualizing-data-with-a-tukey-box-plot"><i class="fa fa-check"></i><b>3.5</b> Visualizing data with a Tukey box plot</a></li>
<li class="chapter" data-level="3.6" data-path="data-abstraction.html"><a href="data-abstraction.html#database-operations-with-dplyr"><i class="fa fa-check"></i><b>3.6</b> Database operations with <code>dplyr</code></a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="data-abstraction.html"><a href="data-abstraction.html#select-mutate-and-the-pipe"><i class="fa fa-check"></i><b>3.6.1</b> Select, mutate, and the pipe</a></li>
<li class="chapter" data-level="3.6.2" data-path="data-abstraction.html"><a href="data-abstraction.html#filter"><i class="fa fa-check"></i><b>3.6.2</b> filter</a></li>
<li class="chapter" data-level="3.6.3" data-path="data-abstraction.html"><a href="data-abstraction.html#writing-a-data-frame-to-a-csv"><i class="fa fa-check"></i><b>3.6.3</b> Writing a data frame to a csv</a></li>
<li class="chapter" data-level="3.6.4" data-path="data-abstraction.html"><a href="data-abstraction.html#summarize-by-group"><i class="fa fa-check"></i><b>3.6.4</b> Summarize by group</a></li>
<li class="chapter" data-level="3.6.5" data-path="data-abstraction.html"><a href="data-abstraction.html#count"><i class="fa fa-check"></i><b>3.6.5</b> Count</a></li>
<li class="chapter" data-level="3.6.6" data-path="data-abstraction.html"><a href="data-abstraction.html#sorting-after-summarizing"><i class="fa fa-check"></i><b>3.6.6</b> Sorting after summarizing</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="data-abstraction.html"><a href="data-abstraction.html#the-dot-operator"><i class="fa fa-check"></i><b>3.7</b> The dot operator</a></li>
<li class="chapter" data-level="3.8" data-path="data-abstraction.html"><a href="data-abstraction.html#exercises-1"><i class="fa fa-check"></i><b>3.8</b> Exercises</a></li>
<li class="chapter" data-level="3.9" data-path="data-abstraction.html"><a href="data-abstraction.html#string-abstraction"><i class="fa fa-check"></i><b>3.9</b> String Abstraction</a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="data-abstraction.html"><a href="data-abstraction.html#detecting-matches"><i class="fa fa-check"></i><b>3.9.1</b> Detecting matches</a></li>
<li class="chapter" data-level="3.9.2" data-path="data-abstraction.html"><a href="data-abstraction.html#subsetting-strings"><i class="fa fa-check"></i><b>3.9.2</b> Subsetting Strings</a></li>
<li class="chapter" data-level="3.9.3" data-path="data-abstraction.html"><a href="data-abstraction.html#string-length"><i class="fa fa-check"></i><b>3.9.3</b> String Length</a></li>
<li class="chapter" data-level="3.9.4" data-path="data-abstraction.html"><a href="data-abstraction.html#replacing-substrings-with-other-text-mutating-strings"><i class="fa fa-check"></i><b>3.9.4</b> Replacing substrings with other text (“mutating” strings)</a></li>
<li class="chapter" data-level="3.9.5" data-path="data-abstraction.html"><a href="data-abstraction.html#concatenating-and-splitting"><i class="fa fa-check"></i><b>3.9.5</b> Concatenating and splitting</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="data-abstraction.html"><a href="data-abstraction.html#dates-and-times-with-lubridate"><i class="fa fa-check"></i><b>3.10</b> Dates and times with <code>lubridate</code></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="visualization.html"><a href="visualization.html"><i class="fa fa-check"></i><b>4</b> Visualization</a>
<ul>
<li class="chapter" data-level="4.1" data-path="visualization.html"><a href="visualization.html#ggplot2"><i class="fa fa-check"></i><b>4.1</b> ggplot2</a></li>
<li class="chapter" data-level="4.2" data-path="visualization.html"><a href="visualization.html#plotting-one-variable"><i class="fa fa-check"></i><b>4.2</b> Plotting one variable</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="visualization.html"><a href="visualization.html#histogram"><i class="fa fa-check"></i><b>4.2.1</b> Histogram</a></li>
<li class="chapter" data-level="4.2.2" data-path="visualization.html"><a href="visualization.html#density-plot"><i class="fa fa-check"></i><b>4.2.2</b> Density Plot</a></li>
<li class="chapter" data-level="4.2.3" data-path="visualization.html"><a href="visualization.html#boxplot"><i class="fa fa-check"></i><b>4.2.3</b> boxplot</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="visualization.html"><a href="visualization.html#plotting-two-variables"><i class="fa fa-check"></i><b>4.3</b> Plotting two variables</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="visualization.html"><a href="visualization.html#two-continuous-variables"><i class="fa fa-check"></i><b>4.3.1</b> Two continuous variables</a></li>
<li class="chapter" data-level="4.3.2" data-path="visualization.html"><a href="visualization.html#two-variables-one-discrete-eucoak"><i class="fa fa-check"></i><b>4.3.2</b> Two variables, one discrete [<code>eucoak</code>]</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="visualization.html"><a href="visualization.html#color-systems"><i class="fa fa-check"></i><b>4.4</b> Color systems</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="visualization.html"><a href="visualization.html#color-from-variable-in-aesthetics"><i class="fa fa-check"></i><b>4.4.1</b> Color from variable, in aesthetics</a></li>
<li class="chapter" data-level="4.4.2" data-path="visualization.html"><a href="visualization.html#trend-line-sierra"><i class="fa fa-check"></i><b>4.4.2</b> Trend line [<code>sierra</code>]</a></li>
<li class="chapter" data-level="4.4.3" data-path="visualization.html"><a href="visualization.html#general-symbology"><i class="fa fa-check"></i><b>4.4.3</b> General symbology</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="visualization.html"><a href="visualization.html#titles-and-subtitles"><i class="fa fa-check"></i><b>4.5</b> Titles and subtitles</a></li>
<li class="chapter" data-level="4.6" data-path="visualization.html"><a href="visualization.html#pairs-plot-sierra"><i class="fa fa-check"></i><b>4.6</b> Pairs Plot [<code>sierra</code>]</a></li>
<li class="chapter" data-level="4.7" data-path="visualization.html"><a href="visualization.html#exercises-2"><i class="fa fa-check"></i><b>4.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-transformation.html"><a href="data-transformation.html"><i class="fa fa-check"></i><b>5</b> Data Transformation</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-transformation.html"><a href="data-transformation.html#data-joins"><i class="fa fa-check"></i><b>5.1</b> Data joins</a></li>
<li class="chapter" data-level="5.2" data-path="data-transformation.html"><a href="data-transformation.html#set-operations"><i class="fa fa-check"></i><b>5.2</b> Set Operations</a></li>
<li class="chapter" data-level="5.3" data-path="data-transformation.html"><a href="data-transformation.html#binding-rows-and-columns"><i class="fa fa-check"></i><b>5.3</b> Binding Rows and Columns</a></li>
<li class="chapter" data-level="5.4" data-path="data-transformation.html"><a href="data-transformation.html#pivotting-data-frames"><i class="fa fa-check"></i><b>5.4</b> Pivotting data frames</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html"><i class="fa fa-check"></i><b>6</b> Spatial Data and Maps</a>
<ul>
<li class="chapter" data-level="6.1" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#spatial-data"><i class="fa fa-check"></i><b>6.1</b> Spatial Data</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#examples-of-simple-geometry-building-in-sf"><i class="fa fa-check"></i><b>6.1.1</b> Examples of simple geometry building in sf</a></li>
<li class="chapter" data-level="6.1.2" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#building-a-mappable-sfc-from-scratch"><i class="fa fa-check"></i><b>6.1.2</b> Building a mappable sfc from scratch</a></li>
<li class="chapter" data-level="6.1.3" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#creating-features-from-shapefiles-or-tables"><i class="fa fa-check"></i><b>6.1.3</b> Creating features from shapefiles or tables</a></li>
<li class="chapter" data-level="6.1.4" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#coordinate-referencing-system"><i class="fa fa-check"></i><b>6.1.4</b> Coordinate Referencing System</a></li>
<li class="chapter" data-level="6.1.5" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#spatial-join-st_join"><i class="fa fa-check"></i><b>6.1.5</b> Spatial join <code>st_join</code></a></li>
<li class="chapter" data-level="6.1.6" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#plotting-maps-in-the-base-plot-system"><i class="fa fa-check"></i><b>6.1.6</b> Plotting maps in the base plot system</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#raster-gis-in-r"><i class="fa fa-check"></i><b>6.2</b> Raster GIS in R</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#raster-from-scratch"><i class="fa fa-check"></i><b>6.2.1</b> Raster from scratch</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#ggplot2-for-maps"><i class="fa fa-check"></i><b>6.3</b> ggplot2 for maps</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#rasters-in-ggplot2"><i class="fa fa-check"></i><b>6.3.1</b> Rasters in ggplot2</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#tmap"><i class="fa fa-check"></i><b>6.4</b> tmap</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#interactive-maps"><i class="fa fa-check"></i><b>6.4.1</b> Interactive Maps</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#exercises-3"><i class="fa fa-check"></i><b>6.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="statistics-and-modeling.html"><a href="statistics-and-modeling.html"><i class="fa fa-check"></i><b>7</b> Statistics and Modeling</a>
<ul>
<li class="chapter" data-level="7.1" data-path="statistics-and-modeling.html"><a href="statistics-and-modeling.html#goals-of-statistical-analysis"><i class="fa fa-check"></i><b>7.1</b> Goals of statistical analysis</a></li>
<li class="chapter" data-level="7.2" data-path="statistics-and-modeling.html"><a href="statistics-and-modeling.html#summary-statistics"><i class="fa fa-check"></i><b>7.2</b> Summary Statistics</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="statistics-and-modeling.html"><a href="statistics-and-modeling.html#summarize-by-group-stratifying-a-summary"><i class="fa fa-check"></i><b>7.2.1</b> Summarize by group: <em>stratifying a summary</em></a></li>
<li class="chapter" data-level="7.2.2" data-path="statistics-and-modeling.html"><a href="statistics-and-modeling.html#boxplot-for-visualizing-distributions-by-group"><i class="fa fa-check"></i><b>7.2.2</b> Boxplot for visualizing distributions by group</a></li>
<li class="chapter" data-level="7.2.3" data-path="statistics-and-modeling.html"><a href="statistics-and-modeling.html#generating-pseudorandom-numbers"><i class="fa fa-check"></i><b>7.2.3</b> Generating pseudorandom numbers</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="statistics-and-modeling.html"><a href="statistics-and-modeling.html#statistical-tests"><i class="fa fa-check"></i><b>7.3</b> Statistical tests</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="statistics-and-modeling.html"><a href="statistics-and-modeling.html#comparing-samples-and-groupings"><i class="fa fa-check"></i><b>7.3.1</b> Comparing samples and groupings</a></li>
<li class="chapter" data-level="7.3.2" data-path="statistics-and-modeling.html"><a href="statistics-and-modeling.html#correlation"><i class="fa fa-check"></i><b>7.3.2</b> Correlation</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="statistics-and-modeling.html"><a href="statistics-and-modeling.html#modeling-in-r"><i class="fa fa-check"></i><b>7.4</b> Modeling in R</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="statistics-and-modeling.html"><a href="statistics-and-modeling.html#analysis-of-covariance"><i class="fa fa-check"></i><b>7.4.1</b> Analysis of Covariance</a></li>
<li class="chapter" data-level="7.4.2" data-path="statistics-and-modeling.html"><a href="statistics-and-modeling.html#generalized-linear-model-glm"><i class="fa fa-check"></i><b>7.4.2</b> Generalized Linear Model (GLM)</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="statistics-and-modeling.html"><a href="statistics-and-modeling.html#spatial-statistical-analysis"><i class="fa fa-check"></i><b>7.5</b> Spatial Statistical Analysis</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="statistics-and-modeling.html"><a href="statistics-and-modeling.html#spatial-autocorrelation"><i class="fa fa-check"></i><b>7.5.1</b> Spatial Autocorrelation</a></li>
<li class="chapter" data-level="7.5.2" data-path="statistics-and-modeling.html"><a href="statistics-and-modeling.html#mapping-residuals"><i class="fa fa-check"></i><b>7.5.2</b> Mapping Residuals</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="time-series.html"><a href="time-series.html"><i class="fa fa-check"></i><b>8</b> Time Series</a>
<ul>
<li class="chapter" data-level="8.0.1" data-path="time-series.html"><a href="time-series.html#frequency-setting"><i class="fa fa-check"></i><b>8.0.1</b> frequency setting</a></li>
<li class="chapter" data-level="8.0.2" data-path="time-series.html"><a href="time-series.html#moving-average-ma"><i class="fa fa-check"></i><b>8.0.2</b> moving average (ma)</a></li>
<li class="chapter" data-level="8.0.3" data-path="time-series.html"><a href="time-series.html#loess-local-regression-smoothing"><i class="fa fa-check"></i><b>8.0.3</b> loess (local regression) smoothing</a></li>
<li class="chapter" data-level="8.1" data-path="time-series.html"><a href="time-series.html#decomposing-time-series"><i class="fa fa-check"></i><b>8.1</b> Decomposing time series</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="time-series.html"><a href="time-series.html#lag-regression"><i class="fa fa-check"></i><b>8.1.1</b> lag regression</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="machine-learning.html"><a href="machine-learning.html"><i class="fa fa-check"></i><b>9</b> Machine Learning</a></li>
<li class="chapter" data-level="10" data-path="building-a-data-package-for-github.html"><a href="building-a-data-package-for-github.html"><i class="fa fa-check"></i><b>10</b> Building a Data Package for GitHub</a>
<ul>
<li class="chapter" data-level="10.1" data-path="building-a-data-package-for-github.html"><a href="building-a-data-package-for-github.html#rda-files"><i class="fa fa-check"></i><b>10.1</b> <code>rda</code> files</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="building-a-data-package-for-github.html"><a href="building-a-data-package-for-github.html#usethisuse_data"><i class="fa fa-check"></i><b>10.1.1</b> <code>usethis::use_data()</code></a></li>
<li class="chapter" data-level="10.1.2" data-path="building-a-data-package-for-github.html"><a href="building-a-data-package-for-github.html#usethiscreate_package"><i class="fa fa-check"></i><b>10.1.2</b> <code>usethis::create_package()</code></a></li>
<li class="chapter" data-level="10.1.3" data-path="building-a-data-package-for-github.html"><a href="building-a-data-package-for-github.html#devtoolsdocument"><i class="fa fa-check"></i><b>10.1.3</b> <code>devtools::document()</code></a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="building-a-data-package-for-github.html"><a href="building-a-data-package-for-github.html#raw-data"><i class="fa fa-check"></i><b>10.2</b> Raw data</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to Environmental Data Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="statistics-and-modeling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Statistics and Modeling</h1>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-162-1.png" width="672" /></p>
<div id="goals-of-statistical-analysis" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> Goals of statistical analysis</h2>
<p>To frame how we might approach statistical analysis and modeling, there are
various goals that are commonly involved:</p>
<ul>
<li>To understand our data
<ul>
<li>nature of our data, through summary statistics and various graphics like histograms</li>
<li>spatial statistical analysis</li>
<li>time series analysis</li>
</ul></li>
<li>To <em>group</em> or <em>classify</em> things based on their properties
<ul>
<li>using factors to define groups, and deriving grouped summaries</li>
<li>comparing <em>observed</em> vs <em>expected</em> counts or probabilities</li>
</ul></li>
<li>To understand how variables relate to one another
<ul>
<li>or maybe even explain variations in other variables, through correlation analysis</li>
</ul></li>
<li>To <em>model</em> behavior and maybe <em>predict</em> it
<ul>
<li>various linear models</li>
</ul></li>
<li>To <em>confirm</em> our observations from exploration (field/lab/vis)
<ul>
<li>inferential statistics e.g. difference of means tests, ANOVA, X^2</li>
</ul></li>
<li>To have the confidence to draw conclusions, make informed decisions</li>
<li>To help <em>communicate</em> our work</li>
</ul>
<p>These goals can be seen in the context of a typical research paper or thesis outline in environmental science:</p>
<ul>
<li>Introduction</li>
<li>Literature Review</li>
<li>Methodology</li>
<li>Results
<ul>
<li>field, lab, geospatial data</li>
</ul></li>
<li>Analysis
<ul>
<li>statistical analysis</li>
<li>qualitative analysis</li>
<li>visualization</li>
</ul></li>
<li>Discussion
<ul>
<li>making sense of analysis</li>
<li>possibly recursive, with visualization</li>
</ul></li>
<li>Conclusion
<ul>
<li>conclusion about what the above shows</li>
<li>new questions for further research</li>
<li>possible policy recommendation</li>
</ul></li>
</ul>
<p>The scope and theory of statistical analysis and models is extensive, and there are many good books
on the subject that employ the R language. This chapter is a short review of some of
these methods and how they apply to environmental data science.</p>
</div>
<div id="summary-statistics" class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> Summary Statistics</h2>
<p>Summary statistics such as mean, standard deviation, variance, minimum, maximum, and range are derived in quite a few
R functions, commonly as a parameter or a sub-function (see <code>mutate</code>). A an overall simple statistical summary is very easy to do in base R:</p>
<div class="sourceCode" id="cb400"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb400-1"><a href="statistics-and-modeling.html#cb400-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(tidy_eucoak)</span></code></pre></div>
<pre><code>##      site               site #          tree                Date               month              rain_mm      rain_subcanopy 
##  Length:180         Min.   :1.000   Length:180         Min.   :2006-11-08   Length:180         Min.   : 1.00   Min.   : 1.00  
##  Class :character   1st Qu.:2.000   Class :character   1st Qu.:2006-12-07   Class :character   1st Qu.:16.00   1st Qu.:16.00  
##  Mode  :character   Median :4.000   Mode  :character   Median :2007-01-30   Mode  :character   Median :28.50   Median :30.00  
##                     Mean   :4.422                      Mean   :2007-01-29                      Mean   :37.99   Mean   :34.84  
##                     3rd Qu.:6.000                      3rd Qu.:2007-03-22                      3rd Qu.:63.25   3rd Qu.:50.00  
##                     Max.   :8.000                      Max.   :2007-05-07                      Max.   :99.00   Max.   :98.00  
##                                                                                                NA&#39;s   :36      NA&#39;s   :4      
##      slope           aspect         runoff_L      surface_tension runoff_rainfall_ratio
##  Min.   : 9.00   Min.   :100.0   Min.   : 0.000   Min.   :28.51   Min.   :0.00000      
##  1st Qu.:12.00   1st Qu.:143.0   1st Qu.: 0.000   1st Qu.:37.40   1st Qu.:0.00000      
##  Median :24.00   Median :196.0   Median : 0.825   Median :62.60   Median :0.03347      
##  Mean   :20.48   Mean   :186.6   Mean   : 2.244   Mean   :55.73   Mean   :0.05981      
##  3rd Qu.:27.00   3rd Qu.:221.8   3rd Qu.: 3.200   3rd Qu.:72.75   3rd Qu.:0.08474      
##  Max.   :32.00   Max.   :296.0   Max.   :16.000   Max.   :72.75   Max.   :0.42000      
##                                  NA&#39;s   :8        NA&#39;s   :44      NA&#39;s   :8</code></pre>
<div id="summarize-by-group-stratifying-a-summary" class="section level3" number="7.2.1">
<h3><span class="header-section-number">7.2.1</span> Summarize by group: <em>stratifying a summary</em></h3>
<div class="sourceCode" id="cb402"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb402-1"><a href="statistics-and-modeling.html#cb402-1" aria-hidden="true" tabindex="-1"></a>eucoakrainfallrunoffTDR <span class="sc">%&gt;%</span></span>
<span id="cb402-2"><a href="statistics-and-modeling.html#cb402-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(site) <span class="sc">%&gt;%</span></span>
<span id="cb402-3"><a href="statistics-and-modeling.html#cb402-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb402-4"><a href="statistics-and-modeling.html#cb402-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">rain =</span> <span class="fu">mean</span>(rain_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb402-5"><a href="statistics-and-modeling.html#cb402-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">rainSD =</span> <span class="fu">sd</span>(rain_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb402-6"><a href="statistics-and-modeling.html#cb402-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">runoffL_oak =</span> <span class="fu">mean</span>(runoffL_oak, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb402-7"><a href="statistics-and-modeling.html#cb402-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">runoffL_euc =</span> <span class="fu">mean</span>(runoffL_euc, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb402-8"><a href="statistics-and-modeling.html#cb402-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">runoffL_oakMax =</span> <span class="fu">max</span>(runoffL_oak, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb402-9"><a href="statistics-and-modeling.html#cb402-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">runoffL_eucMax =</span> <span class="fu">max</span>(runoffL_oak, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb402-10"><a href="statistics-and-modeling.html#cb402-10" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 8 x 7
##   site   rain rainSD runoffL_oak runoffL_euc runoffL_oakMax runoffL_eucMax
##   &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;          &lt;dbl&gt;          &lt;dbl&gt;
## 1 AB1    48.4   28.2      6.80         6.03          6.80           6.80  
## 2 AB2    34.1   27.9      4.91         3.65          4.91           4.91  
## 3 KM1    48     32.0      1.94         0.592         1.94           1.94  
## 4 PR1    56.5   19.1      0.459        2.31          0.459          0.459 
## 5 TP1    38.4   29.5      0.877        1.66          0.877          0.877 
## 6 TP2    34.3   29.2      0.0955       1.53          0.0955         0.0955
## 7 TP3    32.1   28.4      0.381        0.815         0.381          0.381 
## 8 TP4    32.5   28.2      0.231        2.83          0.231          0.231</code></pre>
</div>
<div id="boxplot-for-visualizing-distributions-by-group" class="section level3" number="7.2.2">
<h3><span class="header-section-number">7.2.2</span> Boxplot for visualizing distributions by group</h3>
<p>A Tukey boxplot is a good way to visualize distributions by group. In this soil CO_2
study of the Marble Mountains, some sites had much greater variance, and some sites
tended to be low vs high:</p>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb404-1"><a href="statistics-and-modeling.html#cb404-1" aria-hidden="true" tabindex="-1"></a>soilCO2_97<span class="sc">$</span>SITE <span class="ot">&lt;-</span> <span class="fu">factor</span>(soilCO2_97<span class="sc">$</span>SITE)</span>
<span id="cb404-2"><a href="statistics-and-modeling.html#cb404-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> soilCO2_97, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> SITE, <span class="at">y =</span> <span class="st">`</span><span class="at">CO2%</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb404-3"><a href="statistics-and-modeling.html#cb404-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-165-1.png" width="672" /></p>
</div>
<div id="generating-pseudorandom-numbers" class="section level3" number="7.2.3">
<h3><span class="header-section-number">7.2.3</span> Generating pseudorandom numbers</h3>
<p>Functions commonly used in R books for quickly creating a lot of numbers to display are those
that generate pseudorandom numbers. These are also useful in statistical methods that
need a lot of these, such as in Monte Carlo simulation. The two most commonly used are:</p>
<ul>
<li><strong><code>runif()</code></strong> generates a vector of <code>n</code> pseudorandom numbers ranging by default from <code>min=0</code> to <code>max=1</code>.</li>
<li><strong><code>rnorm()</code></strong> generates a vector of <code>n</code> normally distributed pseudorandom numbers with a default
<code>mean=0</code> and <code>sd=0</code>.</li>
</ul>
<p>To see both in action as x and y:</p>
<div class="sourceCode" id="cb405"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb405-1"><a href="statistics-and-modeling.html#cb405-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">runif</span>(<span class="at">n=</span><span class="dv">1000</span>, <span class="at">min=</span><span class="dv">10</span>, <span class="at">max=</span><span class="dv">20</span>))</span>
<span id="cb405-2"><a href="statistics-and-modeling.html#cb405-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(x) <span class="ot">&lt;-</span> <span class="st">&#39;x&#39;</span></span>
<span id="cb405-3"><a href="statistics-and-modeling.html#cb405-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(x, <span class="fu">aes</span>(<span class="at">x=</span>x)) <span class="sc">+</span> <span class="fu">geom_histogram</span>()</span></code></pre></div>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-166-1.png" width="672" /></p>
<div class="sourceCode" id="cb406"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb406-1"><a href="statistics-and-modeling.html#cb406-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">rnorm</span>(<span class="at">n=</span><span class="dv">1000</span>, <span class="at">mean=</span><span class="dv">100</span>, <span class="at">sd=</span><span class="dv">10</span>))</span>
<span id="cb406-2"><a href="statistics-and-modeling.html#cb406-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(y) <span class="ot">&lt;-</span> <span class="st">&#39;y&#39;</span></span>
<span id="cb406-3"><a href="statistics-and-modeling.html#cb406-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(y, <span class="fu">aes</span>(<span class="at">x=</span>y)) <span class="sc">+</span> <span class="fu">geom_histogram</span>()</span></code></pre></div>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-166-2.png" width="672" /></p>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb407-1"><a href="statistics-and-modeling.html#cb407-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(y, <span class="fu">aes</span>(<span class="at">x=</span>y)) <span class="sc">+</span> <span class="fu">geom_density</span>()</span></code></pre></div>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-166-3.png" width="672" /></p>
<div class="sourceCode" id="cb408"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb408-1"><a href="statistics-and-modeling.html#cb408-1" aria-hidden="true" tabindex="-1"></a>xy <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(x,y)</span>
<span id="cb408-2"><a href="statistics-and-modeling.html#cb408-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(xy, <span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>y)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-166-4.png" width="672" /></p>
</div>
</div>
<div id="statistical-tests" class="section level2" number="7.3">
<h2><span class="header-section-number">7.3</span> Statistical tests</h2>
<p>Tests that compare our data to other data or look at relationships among variables are important statistical
methods, and you should refer to statistical references to best understand how to apply
the appropriate methods for your research.</p>
<div id="comparing-samples-and-groupings" class="section level3" number="7.3.1">
<h3><span class="header-section-number">7.3.1</span> Comparing samples and groupings</h3>
<p>A common need in environmental research is to compare samples of a phenomenon or compare samples with an assumed standard population. The simplest application of this is the t-test, which can only involve comparing two samples or one sample with a population. Analysis of Variance extends this to allow for more than two groups, and can be seen as a linear model where the categorical grouping (as a factor in R) is one of the variables.</p>
<div id="t.test-and-a-non-parametric-alternative-the-kruskal-wallis-rank-sum-test" class="section level4" number="7.3.1.1">
<h4><span class="header-section-number">7.3.1.1</span> t.test and a non-parametric alternative, the Kruskal-Wallis Rank Sum test</h4>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb409-1"><a href="statistics-and-modeling.html#cb409-1" aria-hidden="true" tabindex="-1"></a>XSptsPheno <span class="sc">%&gt;%</span></span>
<span id="cb409-2"><a href="statistics-and-modeling.html#cb409-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(NDVI, <span class="at">fill=</span>phenology)) <span class="sc">+</span></span>
<span id="cb409-3"><a href="statistics-and-modeling.html#cb409-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha=</span><span class="fl">0.2</span>)</span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-168"></span>
<img src="EnvDataSci_files/figure-html/unnamed-chunk-168-1.png" alt="NDVI by phenology" width="672" />
<p class="caption">
Figure 7.1: NDVI by phenology
</p>
</div>
<div class="sourceCode" id="cb410"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb410-1"><a href="statistics-and-modeling.html#cb410-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(NDVI<span class="sc">~</span>phenology, <span class="at">data=</span>XSptsPheno) </span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  NDVI by phenology
## t = 5.4952, df = 52.03, p-value = 1.19e-06
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  0.1421785 0.3057412
## sample estimates:
##   mean in group growing mean in group senescent 
##               0.5901186               0.3661588</code></pre>
<p>While these data sets appear reasonably normal, the Shapiro-Wilk test (which uses a null hypothesis of normal)
has a p value &lt; 0.05 for the senescent group, so the data can’t be assumed to be normal.</p>
<div class="sourceCode" id="cb412"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb412-1"><a href="statistics-and-modeling.html#cb412-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(XSptsPheno<span class="sc">$</span>NDVI[XSptsPheno<span class="sc">$</span>phenology<span class="sc">==</span><span class="st">&quot;growing&quot;</span>])</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  XSptsPheno$NDVI[XSptsPheno$phenology == &quot;growing&quot;]
## W = 0.93608, p-value = 0.07918</code></pre>
<div class="sourceCode" id="cb414"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb414-1"><a href="statistics-and-modeling.html#cb414-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(XSptsPheno<span class="sc">$</span>NDVI[XSptsPheno<span class="sc">$</span>phenology<span class="sc">==</span><span class="st">&quot;senescent&quot;</span>])</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  XSptsPheno$NDVI[XSptsPheno$phenology == &quot;senescent&quot;]
## W = 0.88728, p-value = 0.004925</code></pre>
<p>Therefore we should use a non-parametric alternative such as the Kruskal-Wallis Rank Sum test:</p>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb416-1"><a href="statistics-and-modeling.html#cb416-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kruskal.test</span>(NDVI<span class="sc">~</span>phenology, <span class="at">data=</span>XSptsPheno)</span></code></pre></div>
<pre><code>## 
##  Kruskal-Wallis rank sum test
## 
## data:  NDVI by phenology
## Kruskal-Wallis chi-squared = 19.164, df = 1, p-value = 1.199e-05</code></pre>
<p>[<strong><code>eucoak</code></strong>] For the question “Is the runoff under Eucalyptus canopy significantly different from that under oaks?” we’ll then start by test for normality of each of the two samples (euc and oak)</p>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb418-1"><a href="statistics-and-modeling.html#cb418-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(tidy_eucoak<span class="sc">$</span>runoff_L[tidy_eucoak<span class="sc">$</span>tree <span class="sc">==</span> <span class="st">&quot;euc&quot;</span>])</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  tidy_eucoak$runoff_L[tidy_eucoak$tree == &quot;euc&quot;]
## W = 0.74241, p-value = 4.724e-11</code></pre>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb420-1"><a href="statistics-and-modeling.html#cb420-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(tidy_eucoak<span class="sc">$</span>runoff_L[tidy_eucoak<span class="sc">$</span>tree <span class="sc">==</span> <span class="st">&quot;oak&quot;</span>])</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  tidy_eucoak$runoff_L[tidy_eucoak$tree == &quot;oak&quot;]
## W = 0.71744, p-value = 1.698e-11</code></pre>
<p>which shows clearly that both samples are non-normal. So we might apply the non-parametric Kruskal-Wallis
test:</p>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb422-1"><a href="statistics-and-modeling.html#cb422-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kruskal.test</span>(runoff_L<span class="sc">~</span>tree, <span class="at">data=</span>tidy_eucoak)</span></code></pre></div>
<pre><code>## 
##  Kruskal-Wallis rank sum test
## 
## data:  runoff_L by tree
## Kruskal-Wallis chi-squared = 2.2991, df = 1, p-value = 0.1294</code></pre>
<p>and no significant difference can be seen. If we look at the data graphically, this makes sense:</p>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb424-1"><a href="statistics-and-modeling.html#cb424-1" aria-hidden="true" tabindex="-1"></a>tidy_eucoak <span class="sc">%&gt;%</span></span>
<span id="cb424-2"><a href="statistics-and-modeling.html#cb424-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="fu">log</span>(runoff_L),<span class="at">fill=</span>tree)) <span class="sc">+</span></span>
<span id="cb424-3"><a href="statistics-and-modeling.html#cb424-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha=</span><span class="fl">0.2</span>)</span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-173"></span>
<img src="EnvDataSci_files/figure-html/unnamed-chunk-173-1.png" alt="Runoff under Eucalyptus and Oak in Bay Area sites" width="672" />
<p class="caption">
Figure 7.2: Runoff under Eucalyptus and Oak in Bay Area sites
</p>
</div>
<p>However, some of this may result from major variations among sites, which is apparent in this boxplot:</p>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb425-1"><a href="statistics-and-modeling.html#cb425-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> tidy_eucoak) <span class="sc">+</span></span>
<span id="cb425-2"><a href="statistics-and-modeling.html#cb425-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>site, <span class="at">y=</span>runoff_L, <span class="at">color=</span>tree))</span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-174"></span>
<img src="EnvDataSci_files/figure-html/unnamed-chunk-174-1.png" alt="runoff at various sites contrasting euc and oak" width="672" />
<p class="caption">
Figure 7.3: runoff at various sites contrasting euc and oak
</p>
</div>
<p>We might restrict our analysis to Tilden Park sites in the East Bay.</p>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb426-1"><a href="statistics-and-modeling.html#cb426-1" aria-hidden="true" tabindex="-1"></a>tilden <span class="ot">&lt;-</span> tidy_eucoak <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">str_detect</span>(tidy_eucoak<span class="sc">$</span>site,<span class="st">&quot;TP&quot;</span>))</span>
<span id="cb426-2"><a href="statistics-and-modeling.html#cb426-2" aria-hidden="true" tabindex="-1"></a>tilden <span class="sc">%&gt;%</span></span>
<span id="cb426-3"><a href="statistics-and-modeling.html#cb426-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="fu">log</span>(runoff_L),<span class="at">fill=</span>tree)) <span class="sc">+</span></span>
<span id="cb426-4"><a href="statistics-and-modeling.html#cb426-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha=</span><span class="fl">0.2</span>)</span></code></pre></div>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-175-1.png" width="672" /></p>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb427-1"><a href="statistics-and-modeling.html#cb427-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(tilden<span class="sc">$</span>runoff_L[tilden<span class="sc">$</span>tree <span class="sc">==</span> <span class="st">&quot;euc&quot;</span>])</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  tilden$runoff_L[tilden$tree == &quot;euc&quot;]
## W = 0.73933, p-value = 1.764e-07</code></pre>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb429-1"><a href="statistics-and-modeling.html#cb429-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(tilden<span class="sc">$</span>runoff_L[tilden<span class="sc">$</span>tree <span class="sc">==</span> <span class="st">&quot;oak&quot;</span>])</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  tilden$runoff_L[tilden$tree == &quot;oak&quot;]
## W = 0.59535, p-value = 8.529e-10</code></pre>
<p>So once again, as is common with small sample sets, we need a non-parametric test.</p>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="statistics-and-modeling.html#cb431-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kruskal.test</span>(runoff_L<span class="sc">~</span>tree, <span class="at">data=</span>tilden)</span></code></pre></div>
<pre><code>## 
##  Kruskal-Wallis rank sum test
## 
## data:  runoff_L by tree
## Kruskal-Wallis chi-squared = 14.527, df = 1, p-value = 0.0001382</code></pre>
<p><strong>Analysis process from exploration to testing</strong></p>
<p>[<strong><code>eucoak</code></strong>] In the year runoff was studied, there were no runoff events sufficient to mobilize sediments. The next year, January had a big event, so we collected sediments and processed them in the lab.</p>
<p>Questions:</p>
<ul>
<li>Is there a difference between eucs and oaks in terms of fine sediment yield?</li>
<li>Is there a difference between eucs and oaks in terms of total sediment yield? (includes litter)</li>
</ul>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb433-1"><a href="statistics-and-modeling.html#cb433-1" aria-hidden="true" tabindex="-1"></a>csvPath <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;eucoaksediment.csv&quot;</span>, <span class="at">package=</span><span class="st">&quot;iGIScData&quot;</span>)</span>
<span id="cb433-2"><a href="statistics-and-modeling.html#cb433-2" aria-hidden="true" tabindex="-1"></a>eucoaksed <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(csvPath)</span>
<span id="cb433-3"><a href="statistics-and-modeling.html#cb433-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(eucoaksed)</span></code></pre></div>
<pre><code>##       id                site              trtype              slope        bulkDensity        litter         Jan08rain    
##  Length:14          Length:14          Length:14          Min.   : 9.00   Min.   :0.960   Min.   : 25.00   Min.   :228.1  
##  Class :character   Class :character   Class :character   1st Qu.:12.00   1st Qu.:1.060   1st Qu.: 51.25   1st Qu.:290.8  
##  Mode  :character   Mode  :character   Mode  :character   Median :21.00   Median :1.125   Median : 77.00   Median :301.1  
##                                                           Mean   :20.04   Mean   :1.156   Mean   : 76.64   Mean   :298.5  
##                                                           3rd Qu.:25.00   3rd Qu.:1.245   3rd Qu.: 95.75   3rd Qu.:317.0  
##                                                           Max.   :32.00   Max.   :1.490   Max.   :135.00   Max.   :328.5  
##                                                                                                                           
##  mean_runoff_ratio med_runoff_ratio  std_runoff_ratio     fines_g         litter_g        total_g       fineTotalRatio   fineRainRatio  
##  Min.   :0.00450   Min.   :0.00000   Min.   :0.01070   Min.   : 7.50   Min.   :14.00   Min.   : 23.50   Min.   :0.1300   Min.   :0.025  
##  1st Qu.:0.02285   1st Qu.:0.01105   1st Qu.:0.01642   1st Qu.:13.30   1st Qu.:18.80   1st Qu.: 35.00   1st Qu.:0.2700   1st Qu.:0.044  
##  Median :0.04835   Median :0.04950   Median :0.02740   Median :18.10   Median :40.40   Median : 60.50   Median :0.3900   Median :0.064  
##  Mean   :0.06679   Mean   :0.06179   Mean   :0.04355   Mean   :27.77   Mean   :41.32   Mean   : 69.12   Mean   :0.3715   Mean   :0.097  
##  3rd Qu.:0.12172   3rd Qu.:0.09492   3rd Qu.:0.05735   3rd Qu.:45.00   3rd Qu.:57.50   3rd Qu.: 95.50   3rd Qu.:0.4900   3rd Qu.:0.141  
##  Max.   :0.16480   Max.   :0.16430   Max.   :0.11480   Max.   :66.70   Max.   :97.80   Max.   :125.90   Max.   :0.5500   Max.   :0.293  
##                                                        NA&#39;s   :1       NA&#39;s   :1       NA&#39;s   :1        NA&#39;s   :1        NA&#39;s   :1</code></pre>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb435-1"><a href="statistics-and-modeling.html#cb435-1" aria-hidden="true" tabindex="-1"></a>eucoaksed <span class="sc">%&gt;%</span></span>
<span id="cb435-2"><a href="statistics-and-modeling.html#cb435-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(trtype) <span class="sc">%&gt;%</span></span>
<span id="cb435-3"><a href="statistics-and-modeling.html#cb435-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">meanfines =</span> <span class="fu">mean</span>(fines_g, <span class="at">na.rm=</span>T), <span class="at">sdfines =</span> <span class="fu">sd</span>(fines_g, <span class="at">na.rm=</span>T),</span>
<span id="cb435-4"><a href="statistics-and-modeling.html#cb435-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">meantotal =</span> <span class="fu">mean</span>(total_g, <span class="at">na.rm=</span>T), <span class="at">sdtotal =</span> <span class="fu">sd</span>(total_g, <span class="at">na.rm=</span>T))</span></code></pre></div>
<pre><code>## # A tibble: 2 x 5
##   trtype meanfines sdfines meantotal sdtotal
##   &lt;chr&gt;      &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
## 1 euc         14.2    3.50      48.6    35.0
## 2 oak         39.4   20.4       86.7    26.2</code></pre>
<div class="sourceCode" id="cb437"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb437-1"><a href="statistics-and-modeling.html#cb437-1" aria-hidden="true" tabindex="-1"></a>eucoakLong <span class="ot">&lt;-</span> eucoaksed <span class="sc">%&gt;%</span> </span>
<span id="cb437-2"><a href="statistics-and-modeling.html#cb437-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">col=</span><span class="fu">c</span>(fines_g,litter_g), </span>
<span id="cb437-3"><a href="statistics-and-modeling.html#cb437-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;sed_type&quot;</span>, </span>
<span id="cb437-4"><a href="statistics-and-modeling.html#cb437-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;sed_g&quot;</span>)</span>
<span id="cb437-5"><a href="statistics-and-modeling.html#cb437-5" aria-hidden="true" tabindex="-1"></a>eucoakLong <span class="sc">%&gt;%</span></span>
<span id="cb437-6"><a href="statistics-and-modeling.html#cb437-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(trtype, sed_g, <span class="at">col=</span>sed_type)) <span class="sc">+</span> </span>
<span id="cb437-7"><a href="statistics-and-modeling.html#cb437-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-178-1.png" width="672" /></p>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb438-1"><a href="statistics-and-modeling.html#cb438-1" aria-hidden="true" tabindex="-1"></a>eucoakLong <span class="sc">%&gt;%</span></span>
<span id="cb438-2"><a href="statistics-and-modeling.html#cb438-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(sed_g, <span class="at">col=</span>sed_type)) <span class="sc">+</span> </span>
<span id="cb438-3"><a href="statistics-and-modeling.html#cb438-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>() <span class="sc">+</span></span>
<span id="cb438-4"><a href="statistics-and-modeling.html#cb438-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(trtype <span class="sc">~</span> .)</span></code></pre></div>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-178-2.png" width="672" /></p>
<div class="sourceCode" id="cb439"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb439-1"><a href="statistics-and-modeling.html#cb439-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(eucoaksed<span class="sc">$</span>fines_g[eucoaksed<span class="sc">$</span>trtype <span class="sc">==</span> <span class="st">&quot;euc&quot;</span>])</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  eucoaksed$fines_g[eucoaksed$trtype == &quot;euc&quot;]
## W = 0.9374, p-value = 0.6383</code></pre>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb441-1"><a href="statistics-and-modeling.html#cb441-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(eucoaksed<span class="sc">$</span>fines_g[eucoaksed<span class="sc">$</span>trtype <span class="sc">==</span> <span class="st">&quot;oak&quot;</span>])</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  eucoaksed$fines_g[eucoaksed$trtype == &quot;oak&quot;]
## W = 0.96659, p-value = 0.8729</code></pre>
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb443-1"><a href="statistics-and-modeling.html#cb443-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(fines_g<span class="sc">~</span>trtype, <span class="at">data=</span>eucoaksed) </span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  fines_g by trtype
## t = -3.2102, df = 6.4104, p-value = 0.01675
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -44.059797  -6.278299
## sample estimates:
## mean in group euc mean in group oak 
##          14.21667          39.38571</code></pre>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb445-1"><a href="statistics-and-modeling.html#cb445-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(eucoaksed<span class="sc">$</span>total_g[eucoaksed<span class="sc">$</span>trtype <span class="sc">==</span> <span class="st">&quot;euc&quot;</span>])</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  eucoaksed$total_g[eucoaksed$trtype == &quot;euc&quot;]
## W = 0.76405, p-value = 0.02725</code></pre>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb447-1"><a href="statistics-and-modeling.html#cb447-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(eucoaksed<span class="sc">$</span>total_g[eucoaksed<span class="sc">$</span>trtype <span class="sc">==</span> <span class="st">&quot;oak&quot;</span>])</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  eucoaksed$total_g[eucoaksed$trtype == &quot;oak&quot;]
## W = 0.94988, p-value = 0.7286</code></pre>
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb449-1"><a href="statistics-and-modeling.html#cb449-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kruskal.test</span>(total_g<span class="sc">~</span>trtype, <span class="at">data=</span>eucoaksed) </span></code></pre></div>
<pre><code>## 
##  Kruskal-Wallis rank sum test
## 
## data:  total_g by trtype
## Kruskal-Wallis chi-squared = 3.449, df = 1, p-value = 0.06329</code></pre>
<p>So we used a t test for the fines_g, and the test suggests that there’s a significant
difference in sediment yield for fines, but the Kruskal-Wallis test on total sediment
(including litter) did not show a significant difference. Both results support
the conclusion that oaks in this study produced more soil erosion, largely because
the Eucalyptus stands generate so much litter cover, and that litter also made the
total sediment yield not significantly different.</p>
</div>
<div id="analysis-of-variance" class="section level4" number="7.3.1.2">
<h4><span class="header-section-number">7.3.1.2</span> Analysis of Variance</h4>
<p>Purpose is to compare groups based upon continuous variables. Can be thought of as an extension of a t test where you have more than two groups, or as a linear model where one variable is a factor.</p>
<ul>
<li>Response variable is a continuous variable</li>
<li>Explanatory variable is the grouping – categorical (a factor in R)</li>
</ul>
<p><em>“Are water samples from streams draining sandstone, limestone, and shale different based on pH?”</em>
<img src="img/PigeonMtWaterSample.png" align = "left">
<img src="img/CaveCoveSink.png" align = "center">
<img src="img/HelenHighwaterSpring.png" align = "right"></p>
</div>
</div>
<div id="correlation" class="section level3" number="7.3.2">
<h3><span class="header-section-number">7.3.2</span> Correlation</h3>
<p>r = Pearson’s product-moment correlation – negative or positive</p>
<p>r<sup>2</sup> = amount of variance in one variable “explained” by the other – always positive.</p>
<p>Can show with a pairs plot: <code>pairs(dataframe)</code>, but is tricky</p>
<p>Here’s an easier method from the psych package [<strong><code>sierra</code></strong>]</p>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb451-1"><a href="statistics-and-modeling.html#cb451-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb451-2"><a href="statistics-and-modeling.html#cb451-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs.panels</span>(sierraFeb <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(LATITUDE, LONGITUDE, ELEVATION, PRECIPITATION, TEMPERATURE))</span></code></pre></div>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-179-1.png" width="672" /></p>
</div>
</div>
<div id="modeling-in-r" class="section level2" number="7.4">
<h2><span class="header-section-number">7.4</span> Modeling in R</h2>
<ul>
<li><code>lm(y ~ x)</code> linear regression</li>
<li><code>lm(y ~ x1 + x2 + x3)</code> multiple regression</li>
<li><code>glm(y ~ x, family = poisson)</code> generalized linear model, poisson distribution;
see ?family to see those supported, including binomial, gaussian, poisson, etc.</li>
<li><code>aov(y ~ x)</code> analysis of variance (same as lm except in the summary)</li>
<li>gam(y ~ x) generalized additive models</li>
<li>tree(y ~ x) or rpart(y ~ x) regression/classification trees</li>
</ul>
<div class="sourceCode" id="cb452"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb452-1"><a href="statistics-and-modeling.html#cb452-1" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(TEMPERATURE <span class="sc">~</span> ELEVATION, <span class="at">data =</span> sierraFeb)</span>
<span id="cb452-2"><a href="statistics-and-modeling.html#cb452-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = TEMPERATURE ~ ELEVATION, data = sierraFeb)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -2.9126 -1.0466 -0.0027  0.7940  4.5327 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 11.8813804  0.3825302   31.06   &lt;2e-16 ***
## ELEVATION   -0.0061018  0.0002968  -20.56   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.533 on 60 degrees of freedom
## Multiple R-squared:  0.8757, Adjusted R-squared:  0.8736 
## F-statistic: 422.6 on 1 and 60 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Probably the most important statistic is the p value for the predictor variable ELEVATION, which in this case is very small &lt;2e-16.</p>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-181-1.png" width="672" /></p>
<pre><code>## 
## Call:
## lm(formula = TEMPERATURE ~ ELEVATION, data = sierraFeb)
## 
## Coefficients:
## (Intercept)    ELEVATION  
##   11.881380    -0.006102</code></pre>
<p><strong>Making Predictions</strong></p>
<div class="sourceCode" id="cb455"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb455-1"><a href="statistics-and-modeling.html#cb455-1" aria-hidden="true" tabindex="-1"></a>eqn</span></code></pre></div>
<pre><code>## [1] &quot;temperature = 11.88 + -0.006*elevation + e&quot;</code></pre>
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb457-1"><a href="statistics-and-modeling.html#cb457-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> model1<span class="sc">$</span>coefficients[<span class="dv">1</span>]</span>
<span id="cb457-2"><a href="statistics-and-modeling.html#cb457-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> model1<span class="sc">$</span>coefficients[<span class="dv">2</span>]</span>
<span id="cb457-3"><a href="statistics-and-modeling.html#cb457-3" aria-hidden="true" tabindex="-1"></a>elevations <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">500</span>, <span class="dv">1000</span>, <span class="dv">1500</span>, <span class="dv">2000</span>)</span>
<span id="cb457-4"><a href="statistics-and-modeling.html#cb457-4" aria-hidden="true" tabindex="-1"></a>elevations</span></code></pre></div>
<pre><code>## [1]  500 1000 1500 2000</code></pre>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb459-1"><a href="statistics-and-modeling.html#cb459-1" aria-hidden="true" tabindex="-1"></a>tempEstimate <span class="ot">&lt;-</span> a <span class="sc">+</span> b <span class="sc">*</span> elevations</span>
<span id="cb459-2"><a href="statistics-and-modeling.html#cb459-2" aria-hidden="true" tabindex="-1"></a>tempEstimate</span></code></pre></div>
<pre><code>## [1]  8.8304692  5.7795580  2.7286468 -0.3222645</code></pre>
<div id="analysis-of-covariance" class="section level3" number="7.4.1">
<h3><span class="header-section-number">7.4.1</span> Analysis of Covariance</h3>
<p>Same purpose as Analysis of Variance, but also takes into account the influence of other variables called covariates. In a way, combines a linear model with an analysis of variance.</p>
<p><em>“Are water samples from streams draining sandstone, limestone, and shale different based on pH, while taking into account elevation?”</em></p>
<p><img src="img/UpperSinkingCoveGeology.png"></p>
<p>Response variable is modeled from the factor (ANOVA) plus the covariate (regression)</p>
<ul>
<li>ANOVA: pH ~ rocktype</li>
<li>Regression: pH ~ elevation</li>
<li>ANCOVA: pH ~ rocktype + elevation
<ul>
<li>Yet shouldn’t involve interaction between rocktype and elevation</li>
</ul></li>
</ul>
<p><strong>Example: stream types distinguished by discharge and slope</strong></p>
<p>Three common river types are meandering, braided and anastomosed. For each, their slope
varies by bankfull discharge in a relationship that looks something like:</p>
<p><img src="img/SbyQ_rivers.png"></p>
<p><img src="img/braided.png" alt="braided">
<img src="img/meandering.png" alt="meandering">
<img src="img/anastomosed.png" alt="anastomosed"></p>
<p>No interaction between covariate and factor</p>
<ul>
<li>No relationship between discharge and channel type.<br />
</li>
<li>Another interpretation: the slope of the relationship between the covariate and response variable is about the same for each group; only the intercept differs. Assumes parallel slopes.</li>
</ul>
<p><code>log10(S) ~ strtype * log10(Q)</code> … interaction between covariate and factor</p>
<p><code>log10(S) ~ strtype + log10(Q)</code> … no interaction, parallel slopes</p>
<p>If models are not significantly different, remove interaction term due to parsimony, and satisfies this ANCOVA requirement.</p>
<div class="sourceCode" id="cb461"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb461-1"><a href="statistics-and-modeling.html#cb461-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb461-2"><a href="statistics-and-modeling.html#cb461-2" aria-hidden="true" tabindex="-1"></a>csvPath <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>,<span class="st">&quot;streams.csv&quot;</span>, <span class="at">package=</span><span class="st">&quot;iGIScData&quot;</span>)</span>
<span id="cb461-3"><a href="statistics-and-modeling.html#cb461-3" aria-hidden="true" tabindex="-1"></a>streams <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(csvPath)</span>
<span id="cb461-4"><a href="statistics-and-modeling.html#cb461-4" aria-hidden="true" tabindex="-1"></a>streams<span class="sc">$</span>strtype <span class="ot">&lt;-</span> <span class="fu">factor</span>(streams<span class="sc">$</span>type, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;Anastomosing&quot;</span>,<span class="st">&quot;Braided&quot;</span>,<span class="st">&quot;Meandering&quot;</span>))</span>
<span id="cb461-5"><a href="statistics-and-modeling.html#cb461-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(streams)</span></code></pre></div>
<pre><code>##      type                 Q                S                    strtype  
##  Length:41          Min.   :     6   Min.   :0.000011   Anastomosing: 8  
##  Class :character   1st Qu.:    15   1st Qu.:0.000100   Braided     :12  
##  Mode  :character   Median :    40   Median :0.000700   Meandering  :21  
##                     Mean   :  4159   Mean   :0.001737                    
##                     3rd Qu.:   550   3rd Qu.:0.002800                    
##                     Max.   :100000   Max.   :0.009500</code></pre>
<div class="sourceCode" id="cb463"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb463-1"><a href="statistics-and-modeling.html#cb463-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(streams, <span class="fu">aes</span>(Q, S, <span class="at">color=</span>strtype)) <span class="sc">+</span></span>
<span id="cb463-2"><a href="statistics-and-modeling.html#cb463-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-183-1.png" width="672" /></p>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb464-1"><a href="statistics-and-modeling.html#cb464-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales) <span class="co"># needed for the trans_format function below</span></span>
<span id="cb464-2"><a href="statistics-and-modeling.html#cb464-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(streams, <span class="fu">aes</span>(Q, S, <span class="at">color=</span>strtype)) <span class="sc">+</span></span>
<span id="cb464-3"><a href="statistics-and-modeling.html#cb464-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb464-4"><a href="statistics-and-modeling.html#cb464-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="fu">log10_trans</span>(),</span>
<span id="cb464-5"><a href="statistics-and-modeling.html#cb464-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">trans_format</span>(<span class="st">&quot;log10&quot;</span>, <span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x))) <span class="sc">+</span></span>
<span id="cb464-6"><a href="statistics-and-modeling.html#cb464-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">trans=</span><span class="fu">log10_trans</span>(),</span>
<span id="cb464-7"><a href="statistics-and-modeling.html#cb464-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">trans_format</span>(<span class="st">&quot;log10&quot;</span>, <span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x)))</span></code></pre></div>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-183-2.png" width="672" /></p>
<div class="sourceCode" id="cb465"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb465-1"><a href="statistics-and-modeling.html#cb465-1" aria-hidden="true" tabindex="-1"></a>ancova <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log10</span>(S)<span class="sc">~</span>strtype<span class="sc">*</span><span class="fu">log10</span>(Q), <span class="at">data=</span>streams)</span>
<span id="cb465-2"><a href="statistics-and-modeling.html#cb465-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ancova)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = log10(S) ~ strtype * log10(Q), data = streams)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.63636 -0.13903 -0.00032  0.12652  0.60750 
## 
## Coefficients:
##                            Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                -3.91819    0.31094 -12.601 1.45e-14 ***
## strtypeBraided              2.20085    0.35383   6.220 3.96e-07 ***
## strtypeMeandering           1.63479    0.33153   4.931 1.98e-05 ***
## log10(Q)                   -0.43537    0.18073  -2.409   0.0214 *  
## strtypeBraided:log10(Q)    -0.01488    0.19102  -0.078   0.9384    
## strtypeMeandering:log10(Q)  0.05183    0.18748   0.276   0.7838    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.2656 on 35 degrees of freedom
## Multiple R-squared:  0.9154, Adjusted R-squared:  0.9033 
## F-statistic: 75.73 on 5 and 35 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb467"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb467-1"><a href="statistics-and-modeling.html#cb467-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(ancova)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: log10(S)
##                  Df  Sum Sq Mean Sq  F value    Pr(&gt;F)    
## strtype           2 18.3914  9.1957 130.3650 &lt; 2.2e-16 ***
## log10(Q)          1  8.2658  8.2658 117.1821 1.023e-12 ***
## strtype:log10(Q)  2  0.0511  0.0255   0.3619    0.6989    
## Residuals        35  2.4688  0.0705                       
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb469"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb469-1"><a href="statistics-and-modeling.html#cb469-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Now an additive model, which does not have that interaction</span></span>
<span id="cb469-2"><a href="statistics-and-modeling.html#cb469-2" aria-hidden="true" tabindex="-1"></a>ancova2 <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log10</span>(S)<span class="sc">~</span>strtype<span class="sc">+</span><span class="fu">log10</span>(Q), <span class="at">data=</span>streams)</span>
<span id="cb469-3"><a href="statistics-and-modeling.html#cb469-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(ancova2)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: log10(S)
##           Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
## strtype    2 18.3914  9.1957  135.02 &lt; 2.2e-16 ***
## log10(Q)   1  8.2658  8.2658  121.37  3.07e-13 ***
## Residuals 37  2.5199  0.0681                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb471"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb471-1"><a href="statistics-and-modeling.html#cb471-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(ancova,ancova2)   </span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Model 1: log10(S) ~ strtype * log10(Q)
## Model 2: log10(S) ~ strtype + log10(Q)
##   Res.Df    RSS Df Sum of Sq      F Pr(&gt;F)
## 1     35 2.4688                           
## 2     37 2.5199 -2 -0.051051 0.3619 0.6989</code></pre>
<div class="sourceCode" id="cb473"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb473-1"><a href="statistics-and-modeling.html#cb473-1" aria-hidden="true" tabindex="-1"></a>   <span class="co"># not significantly different, so model simplification is justified</span></span>
<span id="cb473-2"><a href="statistics-and-modeling.html#cb473-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb473-3"><a href="statistics-and-modeling.html#cb473-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Now we remove the strtype term</span></span>
<span id="cb473-4"><a href="statistics-and-modeling.html#cb473-4" aria-hidden="true" tabindex="-1"></a>ancova3 <span class="ot">=</span> <span class="fu">update</span>(ancova2, <span class="sc">~</span> . <span class="sc">-</span> strtype)  </span>
<span id="cb473-5"><a href="statistics-and-modeling.html#cb473-5" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(ancova2,ancova3)  </span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Model 1: log10(S) ~ strtype + log10(Q)
## Model 2: log10(S) ~ log10(Q)
##   Res.Df     RSS Df Sum of Sq      F    Pr(&gt;F)    
## 1     37  2.5199                                  
## 2     39 25.5099 -2    -22.99 168.78 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb475"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb475-1"><a href="statistics-and-modeling.html#cb475-1" aria-hidden="true" tabindex="-1"></a>   <span class="co"># Goes too far.  Removing the strtype creates a significantly different model</span></span>
<span id="cb475-2"><a href="statistics-and-modeling.html#cb475-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-3"><a href="statistics-and-modeling.html#cb475-3" aria-hidden="true" tabindex="-1"></a><span class="fu">step</span>(ancova)</span></code></pre></div>
<pre><code>## Start:  AIC=-103.2
## log10(S) ~ strtype * log10(Q)
## 
##                    Df Sum of Sq    RSS     AIC
## - strtype:log10(Q)  2  0.051051 2.5199 -106.36
## &lt;none&gt;                          2.4688 -103.20
## 
## Step:  AIC=-106.36
## log10(S) ~ strtype + log10(Q)
## 
##            Df Sum of Sq     RSS      AIC
## &lt;none&gt;                   2.5199 -106.364
## - log10(Q)  1    8.2658 10.7857  -48.750
## - strtype   2   22.9901 25.5099  -15.455</code></pre>
<pre><code>## 
## Call:
## lm(formula = log10(S) ~ strtype + log10(Q), data = streams)
## 
## Coefficients:
##       (Intercept)     strtypeBraided  strtypeMeandering           log10(Q)  
##           -3.9583             2.1453             1.7294            -0.4109</code></pre>
<p><strong>Part of general linear model (lm)</strong></p>
<p>ANOVA &amp; ANCOVA are applications of a general linear model.</p>
<ul>
<li>Uses lm in R</li>
<li>Response variable is continuous, assumed normally distributed</li>
</ul>
<p><em>Not the same as Generalized Linear Model (GLM)</em></p>
<ul>
<li><em>With GLM, response variable may be from count data (e.g. Poisson), probabilities of occurrence (logistic regression) or other non-normal distributions.</em></li>
</ul>
<p><code>mymodel = lm(log10(s) ~ strtype + log10(Q))</code></p>
<ul>
<li>The linear model, with categorical explanatory variable + covariate</li>
</ul>
<p><code>anova(mymodel)</code></p>
<ul>
<li>Displays the Analysis of Variance table from the linear model</li>
</ul>
</div>
<div id="generalized-linear-model-glm" class="section level3" number="7.4.2">
<h3><span class="header-section-number">7.4.2</span> Generalized Linear Model (GLM)</h3>
<p>The glm in R allows you to work with various types of data using various distributions, described as families such as:</p>
<ul>
<li>gaussian : normal distribution – what is used with lm</li>
<li>binomial : logit – used with probabilities.
<ul>
<li>Used for <em>logistic regression</em></li>
</ul></li>
<li>poisson : for counts. Commonly used for species counts.</li>
<li>see help(glm) for other examples</li>
</ul>
<p>Great explanation of poisson distribution using meteor showers at:</p>
<p><a href="https://towardsdatascience.com/the-poisson-distribution-and-poisson-process-explained-4e2cb17d459">https://towardsdatascience.com/the-poisson-distribution-and-poisson-process-explained-4e2cb17d459</a></p>
</div>
</div>
<div id="spatial-statistical-analysis" class="section level2" number="7.5">
<h2><span class="header-section-number">7.5</span> Spatial Statistical Analysis</h2>
<p>Spatial statistical analysis brings in the spatial dimension to a statistical analysis,
ranging from visual analysis of patterns to specialized spatial statistical methods.
There are many applications for these methods in environmental research, since
spatial patterns are generally highly relevant. We might ask:</p>
<ul>
<li>What patterns can we see?</li>
<li>What is the effect of scale?</li>
<li>Relationships among variables – do they vary spatially?</li>
</ul>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-184-1.png" width="672" /></p>
<div id="spatial-autocorrelation" class="section level3" number="7.5.1">
<h3><span class="header-section-number">7.5.1</span> Spatial Autocorrelation</h3>
<p>[Need to add a Moran’s I section here]</p>
</div>
<div id="mapping-residuals" class="section level3" number="7.5.2">
<h3><span class="header-section-number">7.5.2</span> Mapping Residuals</h3>
<p>If the <em>residuals</em> from regression are spatially autocorrelated, look for patterns in the residuals to find other explanatory variables.</p>
<div class="sourceCode" id="cb478"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb478-1"><a href="statistics-and-modeling.html#cb478-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb478-2"><a href="statistics-and-modeling.html#cb478-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(iGIScData)</span>
<span id="cb478-3"><a href="statistics-and-modeling.html#cb478-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf); <span class="fu">library</span>(raster)</span>
<span id="cb478-4"><a href="statistics-and-modeling.html#cb478-4" aria-hidden="true" tabindex="-1"></a>rasPath <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;ca_hillsh_WGS84.tif&quot;</span>, <span class="at">package=</span><span class="st">&quot;iGIScData&quot;</span>)</span>
<span id="cb478-5"><a href="statistics-and-modeling.html#cb478-5" aria-hidden="true" tabindex="-1"></a>hillsh <span class="ot">&lt;-</span> <span class="fu">raster</span>(rasPath)</span>
<span id="cb478-6"><a href="statistics-and-modeling.html#cb478-6" aria-hidden="true" tabindex="-1"></a>hillshpts <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">rasterToPoints</span>(hillsh))</span>
<span id="cb478-7"><a href="statistics-and-modeling.html#cb478-7" aria-hidden="true" tabindex="-1"></a>CAbasemap <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb478-8"><a href="statistics-and-modeling.html#cb478-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_raster</span>(<span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">fill=</span>ca_hillsh_WGS84), hillshpts) <span class="sc">+</span> <span class="fu">guides</span>(<span class="at">fill=</span>F) <span class="sc">+</span></span>
<span id="cb478-9"><a href="statistics-and-modeling.html#cb478-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data=</span>CA_counties, <span class="at">fill=</span><span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb478-10"><a href="statistics-and-modeling.html#cb478-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">&quot;#606060&quot;</span>, <span class="at">high =</span> <span class="st">&quot;#FFFFFF&quot;</span>) <span class="sc">+</span></span>
<span id="cb478-11"><a href="statistics-and-modeling.html#cb478-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&#39;&#39;</span>, <span class="at">y=</span><span class="st">&#39;&#39;</span>)</span>
<span id="cb478-12"><a href="statistics-and-modeling.html#cb478-12" aria-hidden="true" tabindex="-1"></a>sierra <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(<span class="fu">filter</span>(sierraFeb, <span class="sc">!</span><span class="fu">is.na</span>(TEMPERATURE)), <span class="at">coords=</span><span class="fu">c</span>(<span class="st">&quot;LONGITUDE&quot;</span>, <span class="st">&quot;LATITUDE&quot;</span>), <span class="at">crs=</span><span class="dv">4326</span>)</span>
<span id="cb478-13"><a href="statistics-and-modeling.html#cb478-13" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(TEMPERATURE <span class="sc">~</span> ELEVATION, <span class="at">data =</span> sierra)</span>
<span id="cb478-14"><a href="statistics-and-modeling.html#cb478-14" aria-hidden="true" tabindex="-1"></a>cc <span class="ot">&lt;-</span> model1<span class="sc">$</span>coefficients</span>
<span id="cb478-15"><a href="statistics-and-modeling.html#cb478-15" aria-hidden="true" tabindex="-1"></a>sierra<span class="sc">$</span>resid <span class="ot">&lt;-</span> <span class="fu">resid</span>(model1)</span>
<span id="cb478-16"><a href="statistics-and-modeling.html#cb478-16" aria-hidden="true" tabindex="-1"></a>sierra<span class="sc">$</span>predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(model1) </span>
<span id="cb478-17"><a href="statistics-and-modeling.html#cb478-17" aria-hidden="true" tabindex="-1"></a>eqn <span class="ot">=</span> <span class="fu">paste</span>(<span class="st">&quot;temperature =&quot;</span>, <span class="fu">paste</span>(<span class="fu">round</span>(cc[<span class="dv">1</span>],<span class="dv">2</span>), <span class="fu">paste</span>(<span class="fu">round</span>(cc[<span class="sc">-</span><span class="dv">1</span>], <span class="at">digits=</span><span class="dv">3</span>), <span class="at">sep=</span><span class="st">&quot;*&quot;</span>, <span class="at">collapse=</span><span class="st">&quot; + &quot;</span>, <span class="fu">paste</span>(<span class="st">&quot;elevation&quot;</span>)), <span class="at">sep=</span><span class="st">&quot; + &quot;</span>), <span class="st">&quot;+ e&quot;</span>)</span>
<span id="cb478-18"><a href="statistics-and-modeling.html#cb478-18" aria-hidden="true" tabindex="-1"></a>ct <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>,<span class="st">&quot;CA_places.shp&quot;</span>,<span class="at">package=</span><span class="st">&quot;iGIScData&quot;</span>))</span>
<span id="cb478-19"><a href="statistics-and-modeling.html#cb478-19" aria-hidden="true" tabindex="-1"></a>ct<span class="sc">$</span>AREANAME_pad <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">str_replace_all</span>(ct<span class="sc">$</span>AREANAME, <span class="st">&#39;[A-Za-z]&#39;</span>,<span class="st">&#39; &#39;</span>), ct<span class="sc">$</span>AREANAME)</span>
<span id="cb478-20"><a href="statistics-and-modeling.html#cb478-20" aria-hidden="true" tabindex="-1"></a>bounds <span class="ot">&lt;-</span> <span class="fu">st_bbox</span>(sierra)</span>
<span id="cb478-21"><a href="statistics-and-modeling.html#cb478-21" aria-hidden="true" tabindex="-1"></a>sierrabasemap <span class="ot">&lt;-</span> CAbasemap <span class="sc">+</span> </span>
<span id="cb478-22"><a href="statistics-and-modeling.html#cb478-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data=</span>ct) <span class="sc">+</span></span>
<span id="cb478-23"><a href="statistics-and-modeling.html#cb478-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf_text</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">label=</span>AREANAME_pad), <span class="at">data=</span>ct, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">nudge_x =</span> <span class="fl">0.1</span>, <span class="at">nudge_y =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb478-24"><a href="statistics-and-modeling.html#cb478-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_sf</span>(<span class="at">xlim =</span> <span class="fu">c</span>(bounds[<span class="dv">1</span>], bounds[<span class="dv">3</span>]), <span class="at">ylim =</span> <span class="fu">c</span>(bounds[<span class="dv">2</span>],bounds[<span class="dv">4</span>]))</span>
<span id="cb478-25"><a href="statistics-and-modeling.html#cb478-25" aria-hidden="true" tabindex="-1"></a>sierrabasemap <span class="sc">+</span></span>
<span id="cb478-26"><a href="statistics-and-modeling.html#cb478-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">color =</span> resid), <span class="at">alpha=</span><span class="fl">0.7</span>, <span class="at">data=</span>sierra, <span class="at">size=</span><span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb478-27"><a href="statistics-and-modeling.html#cb478-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gradient2</span>(<span class="at">low=</span><span class="st">&quot;blue&quot;</span>, <span class="at">mid=</span><span class="st">&quot;ivory2&quot;</span>, <span class="at">high=</span><span class="st">&quot;red&quot;</span>, </span>
<span id="cb478-28"><a href="statistics-and-modeling.html#cb478-28" aria-hidden="true" tabindex="-1"></a>                        <span class="at">midpoint=</span><span class="fu">mean</span>(sierra<span class="sc">$</span>resid)) <span class="sc">+</span></span>
<span id="cb478-29"><a href="statistics-and-modeling.html#cb478-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_sf</span>(<span class="at">xlim =</span> <span class="fu">c</span>(bounds[<span class="dv">1</span>], bounds[<span class="dv">3</span>]), <span class="at">ylim =</span> <span class="fu">c</span>(bounds[<span class="dv">2</span>],bounds[<span class="dv">4</span>]))  <span class="sc">+</span></span>
<span id="cb478-30"><a href="statistics-and-modeling.html#cb478-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Residuals&quot;</span>, <span class="at">subtitle=</span>eqn) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.85</span>)) <span class="sc">+</span> </span>
<span id="cb478-31"><a href="statistics-and-modeling.html#cb478-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&#39;cm&#39;</span>), </span>
<span id="cb478-32"><a href="statistics-and-modeling.html#cb478-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>))</span></code></pre></div>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-185-1.png" width="672" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="spatial-data-and-maps.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="time-series.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["EnvDataSci.pdf", "EnvDataSci.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
