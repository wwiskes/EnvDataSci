<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7 Statistical Summaries and Tests | Introduction to Environmental Data Science</title>
  <meta name="description" content="Background, concepts and exercises for using R for environmental data science. The focus is on applying the R language and various libraries for data abstraction, transformation, data analysis, spatial data/mapping, statistical modeling, and time series, applied to environmental research. Applies exploratory data analysis methods and tidyverse approaches in R, and includes contributed chapters presenting research applications, with associated data and code packages." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="7 Statistical Summaries and Tests | Introduction to Environmental Data Science" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Background, concepts and exercises for using R for environmental data science. The focus is on applying the R language and various libraries for data abstraction, transformation, data analysis, spatial data/mapping, statistical modeling, and time series, applied to environmental research. Applies exploratory data analysis methods and tidyverse approaches in R, and includes contributed chapters presenting research applications, with associated data and code packages." />
  <meta name="github-repo" content="iGISc/EnvDataSci" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7 Statistical Summaries and Tests | Introduction to Environmental Data Science" />
  
  <meta name="twitter:description" content="Background, concepts and exercises for using R for environmental data science. The focus is on applying the R language and various libraries for data abstraction, transformation, data analysis, spatial data/mapping, statistical modeling, and time series, applied to environmental research. Applies exploratory data analysis methods and tidyverse approaches in R, and includes contributed chapters presenting research applications, with associated data and code packages." />
  



<meta name="date" content="2021-05-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="spatial-data-and-maps.html"/>
<link rel="next" href="modeling-in-r.html"/>
<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.2/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.18/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.3/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.3/leaflet-providers-plugin.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Environmental Data Science</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#tools-for-environmental-data-science"><i class="fa fa-check"></i><b>1.1</b> Tools for Environmental Data Science</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#big-data-data-mining-and-exploratory-data-analysis"><i class="fa fa-check"></i><b>1.2</b> Big Data, Data Mining, and Exploratory Data Analysis</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#exploratory-data-analysis"><i class="fa fa-check"></i><b>1.2.1</b> Exploratory Data Analysis</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#software-and-data-well-need"><i class="fa fa-check"></i><b>1.3</b> Software and data we’ll need</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="index.html"><a href="index.html#data"><i class="fa fa-check"></i><b>1.3.1</b> Data</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>I R for Exploratory Data Analysis</b></span></li>
<li class="chapter" data-level="2" data-path="introduction-to-r.html"><a href="introduction-to-r.html"><i class="fa fa-check"></i><b>2</b> Introduction to R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#variables"><i class="fa fa-check"></i><b>2.1</b> Variables</a></li>
<li class="chapter" data-level="2.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#functions"><i class="fa fa-check"></i><b>2.2</b> Functions</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#expressions-and-statements"><i class="fa fa-check"></i><b>2.3</b> Expressions and Statements</a></li>
<li class="chapter" data-level="2.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#data-types"><i class="fa fa-check"></i><b>2.4</b> Data Types</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#integers"><i class="fa fa-check"></i><b>2.4.1</b> Integers</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="introduction-to-r.html"><a href="introduction-to-r.html#rectangular-data"><i class="fa fa-check"></i><b>2.5</b> Rectangular data</a></li>
<li class="chapter" data-level="2.6" data-path="introduction-to-r.html"><a href="introduction-to-r.html#data-structures-in-r"><i class="fa fa-check"></i><b>2.6</b> Data Structures in R</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#vectors"><i class="fa fa-check"></i><b>2.6.1</b> Vectors</a></li>
<li class="chapter" data-level="2.6.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#lists"><i class="fa fa-check"></i><b>2.6.2</b> Lists</a></li>
<li class="chapter" data-level="2.6.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#matrices"><i class="fa fa-check"></i><b>2.6.3</b> Matrices</a></li>
<li class="chapter" data-level="2.6.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#data-frames"><i class="fa fa-check"></i><b>2.6.4</b> Data frames</a></li>
<li class="chapter" data-level="2.6.5" data-path="introduction-to-r.html"><a href="introduction-to-r.html#factors"><i class="fa fa-check"></i><b>2.6.5</b> Factors</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="introduction-to-r.html"><a href="introduction-to-r.html#programming-scripts-in-rstudio"><i class="fa fa-check"></i><b>2.7</b> Programming scripts in RStudio</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#subsetting-with-logic"><i class="fa fa-check"></i><b>2.7.1</b> Subsetting with logic</a></li>
<li class="chapter" data-level="2.7.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#apply-functions"><i class="fa fa-check"></i><b>2.7.2</b> Apply functions</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="introduction-to-r.html"><a href="introduction-to-r.html#exercises"><i class="fa fa-check"></i><b>2.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-abstraction.html"><a href="data-abstraction.html"><i class="fa fa-check"></i><b>3</b> Data Abstraction</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-abstraction.html"><a href="data-abstraction.html#background-exploratory-data-analysis"><i class="fa fa-check"></i><b>3.1</b> Background: Exploratory Data Analysis</a></li>
<li class="chapter" data-level="3.2" data-path="data-abstraction.html"><a href="data-abstraction.html#the-tidyverse-and-what-well-explore-in-this-chapter"><i class="fa fa-check"></i><b>3.2</b> The Tidyverse and what we’ll explore in this chapter</a></li>
<li class="chapter" data-level="3.3" data-path="data-abstraction.html"><a href="data-abstraction.html#tibbles"><i class="fa fa-check"></i><b>3.3</b> Tibbles</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="data-abstraction.html"><a href="data-abstraction.html#read_csv-vs.-read.csv"><i class="fa fa-check"></i><b>3.3.1</b> <code>read_csv</code> vs. <code>read.csv</code></a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="data-abstraction.html"><a href="data-abstraction.html#statistical-summary-of-variables"><i class="fa fa-check"></i><b>3.4</b> Statistical summary of variables</a></li>
<li class="chapter" data-level="3.5" data-path="data-abstraction.html"><a href="data-abstraction.html#visualizing-data-with-a-tukey-box-plot"><i class="fa fa-check"></i><b>3.5</b> Visualizing data with a Tukey box plot</a></li>
<li class="chapter" data-level="3.6" data-path="data-abstraction.html"><a href="data-abstraction.html#database-operations-with-dplyr"><i class="fa fa-check"></i><b>3.6</b> Database operations with <code>dplyr</code></a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="data-abstraction.html"><a href="data-abstraction.html#select-mutate-and-the-pipe"><i class="fa fa-check"></i><b>3.6.1</b> Select, mutate, and the pipe</a></li>
<li class="chapter" data-level="3.6.2" data-path="data-abstraction.html"><a href="data-abstraction.html#filter"><i class="fa fa-check"></i><b>3.6.2</b> filter</a></li>
<li class="chapter" data-level="3.6.3" data-path="data-abstraction.html"><a href="data-abstraction.html#writing-a-data-frame-to-a-csv"><i class="fa fa-check"></i><b>3.6.3</b> Writing a data frame to a csv</a></li>
<li class="chapter" data-level="3.6.4" data-path="data-abstraction.html"><a href="data-abstraction.html#summarize-by-group"><i class="fa fa-check"></i><b>3.6.4</b> Summarize by group</a></li>
<li class="chapter" data-level="3.6.5" data-path="data-abstraction.html"><a href="data-abstraction.html#count"><i class="fa fa-check"></i><b>3.6.5</b> Count</a></li>
<li class="chapter" data-level="3.6.6" data-path="data-abstraction.html"><a href="data-abstraction.html#sorting-after-summarizing"><i class="fa fa-check"></i><b>3.6.6</b> Sorting after summarizing</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="data-abstraction.html"><a href="data-abstraction.html#the-dot-operator"><i class="fa fa-check"></i><b>3.7</b> The dot operator</a></li>
<li class="chapter" data-level="3.8" data-path="data-abstraction.html"><a href="data-abstraction.html#exercises-1"><i class="fa fa-check"></i><b>3.8</b> Exercises</a></li>
<li class="chapter" data-level="3.9" data-path="data-abstraction.html"><a href="data-abstraction.html#string-abstraction"><i class="fa fa-check"></i><b>3.9</b> String Abstraction</a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="data-abstraction.html"><a href="data-abstraction.html#detecting-matches"><i class="fa fa-check"></i><b>3.9.1</b> Detecting matches</a></li>
<li class="chapter" data-level="3.9.2" data-path="data-abstraction.html"><a href="data-abstraction.html#subsetting-strings"><i class="fa fa-check"></i><b>3.9.2</b> Subsetting Strings</a></li>
<li class="chapter" data-level="3.9.3" data-path="data-abstraction.html"><a href="data-abstraction.html#string-length"><i class="fa fa-check"></i><b>3.9.3</b> String Length</a></li>
<li class="chapter" data-level="3.9.4" data-path="data-abstraction.html"><a href="data-abstraction.html#replacing-substrings-with-other-text-mutating-strings"><i class="fa fa-check"></i><b>3.9.4</b> Replacing substrings with other text (“mutating” strings)</a></li>
<li class="chapter" data-level="3.9.5" data-path="data-abstraction.html"><a href="data-abstraction.html#concatenating-and-splitting"><i class="fa fa-check"></i><b>3.9.5</b> Concatenating and splitting</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="data-abstraction.html"><a href="data-abstraction.html#dates-and-times-with-lubridate"><i class="fa fa-check"></i><b>3.10</b> Dates and times with <code>lubridate</code></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="visualization.html"><a href="visualization.html"><i class="fa fa-check"></i><b>4</b> Visualization</a>
<ul>
<li class="chapter" data-level="4.1" data-path="visualization.html"><a href="visualization.html#ggplot2"><i class="fa fa-check"></i><b>4.1</b> ggplot2</a></li>
<li class="chapter" data-level="4.2" data-path="visualization.html"><a href="visualization.html#plotting-one-variable"><i class="fa fa-check"></i><b>4.2</b> Plotting one variable</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="visualization.html"><a href="visualization.html#histogram"><i class="fa fa-check"></i><b>4.2.1</b> Histogram</a></li>
<li class="chapter" data-level="4.2.2" data-path="visualization.html"><a href="visualization.html#density-plot"><i class="fa fa-check"></i><b>4.2.2</b> Density Plot</a></li>
<li class="chapter" data-level="4.2.3" data-path="visualization.html"><a href="visualization.html#boxplot"><i class="fa fa-check"></i><b>4.2.3</b> boxplot</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="visualization.html"><a href="visualization.html#plotting-two-variables"><i class="fa fa-check"></i><b>4.3</b> Plotting two variables</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="visualization.html"><a href="visualization.html#two-continuous-variables"><i class="fa fa-check"></i><b>4.3.1</b> Two continuous variables</a></li>
<li class="chapter" data-level="4.3.2" data-path="visualization.html"><a href="visualization.html#two-variables-one-discrete"><i class="fa fa-check"></i><b>4.3.2</b> Two variables, one discrete</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="visualization.html"><a href="visualization.html#color-systems"><i class="fa fa-check"></i><b>4.4</b> Color systems</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="visualization.html"><a href="visualization.html#color-from-variable-in-aesthetics"><i class="fa fa-check"></i><b>4.4.1</b> Color from variable, in aesthetics</a></li>
<li class="chapter" data-level="4.4.2" data-path="visualization.html"><a href="visualization.html#trend-line"><i class="fa fa-check"></i><b>4.4.2</b> Trend line</a></li>
<li class="chapter" data-level="4.4.3" data-path="visualization.html"><a href="visualization.html#general-symbology"><i class="fa fa-check"></i><b>4.4.3</b> General symbology</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="visualization.html"><a href="visualization.html#titles-and-subtitles"><i class="fa fa-check"></i><b>4.5</b> Titles and subtitles</a></li>
<li class="chapter" data-level="4.6" data-path="visualization.html"><a href="visualization.html#pairs-plot"><i class="fa fa-check"></i><b>4.6</b> Pairs Plot</a></li>
<li class="chapter" data-level="4.7" data-path="visualization.html"><a href="visualization.html#exercises-2"><i class="fa fa-check"></i><b>4.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-transformation.html"><a href="data-transformation.html"><i class="fa fa-check"></i><b>5</b> Data Transformation</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-transformation.html"><a href="data-transformation.html#data-joins"><i class="fa fa-check"></i><b>5.1</b> Data joins</a></li>
<li class="chapter" data-level="5.2" data-path="data-transformation.html"><a href="data-transformation.html#set-operations"><i class="fa fa-check"></i><b>5.2</b> Set Operations</a></li>
<li class="chapter" data-level="5.3" data-path="data-transformation.html"><a href="data-transformation.html#binding-rows-and-columns"><i class="fa fa-check"></i><b>5.3</b> Binding Rows and Columns</a></li>
<li class="chapter" data-level="5.4" data-path="data-transformation.html"><a href="data-transformation.html#pivotting-data-frames"><i class="fa fa-check"></i><b>5.4</b> Pivotting data frames</a></li>
</ul></li>
<li class="part"><span><b>II Spatial</b></span></li>
<li class="chapter" data-level="6" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html"><i class="fa fa-check"></i><b>6</b> Spatial Data and Maps</a>
<ul>
<li class="chapter" data-level="6.1" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#spatial-data"><i class="fa fa-check"></i><b>6.1</b> Spatial Data</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#examples-of-simple-geometry-building-in-sf"><i class="fa fa-check"></i><b>6.1.1</b> Examples of simple geometry building in sf</a></li>
<li class="chapter" data-level="6.1.2" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#building-a-mappable-sfc-from-scratch"><i class="fa fa-check"></i><b>6.1.2</b> Building a mappable sfc from scratch</a></li>
<li class="chapter" data-level="6.1.3" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#creating-features-from-shapefiles-or-tables"><i class="fa fa-check"></i><b>6.1.3</b> Creating features from shapefiles or tables</a></li>
<li class="chapter" data-level="6.1.4" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#coordinate-referencing-system"><i class="fa fa-check"></i><b>6.1.4</b> Coordinate Referencing System</a></li>
<li class="chapter" data-level="6.1.5" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#spatial-join-st_join"><i class="fa fa-check"></i><b>6.1.5</b> Spatial join <code>st_join</code></a></li>
<li class="chapter" data-level="6.1.6" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#plotting-maps-in-the-base-plot-system"><i class="fa fa-check"></i><b>6.1.6</b> Plotting maps in the base plot system</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#raster-gis-in-r"><i class="fa fa-check"></i><b>6.2</b> Raster GIS in R</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#raster-from-scratch"><i class="fa fa-check"></i><b>6.2.1</b> Raster from scratch</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#ggplot2-for-maps"><i class="fa fa-check"></i><b>6.3</b> ggplot2 for maps</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#rasters-in-ggplot2"><i class="fa fa-check"></i><b>6.3.1</b> Rasters in ggplot2</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#tmap"><i class="fa fa-check"></i><b>6.4</b> tmap</a></li>
<li class="chapter" data-level="6.5" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#interactive-maps"><i class="fa fa-check"></i><b>6.5</b> Interactive Maps</a></li>
<li class="chapter" data-level="6.6" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#exercises-3"><i class="fa fa-check"></i><b>6.6</b> Exercises</a></li>
</ul></li>
<li class="part"><span><b>III Statistics &amp; Modeling</b></span></li>
<li class="chapter" data-level="7" data-path="statistical-summaries-and-tests.html"><a href="statistical-summaries-and-tests.html"><i class="fa fa-check"></i><b>7</b> Statistical Summaries and Tests</a>
<ul>
<li class="chapter" data-level="7.1" data-path="statistical-summaries-and-tests.html"><a href="statistical-summaries-and-tests.html#goals-of-statistical-analysis"><i class="fa fa-check"></i><b>7.1</b> Goals of statistical analysis</a></li>
<li class="chapter" data-level="7.2" data-path="statistical-summaries-and-tests.html"><a href="statistical-summaries-and-tests.html#summary-statistics"><i class="fa fa-check"></i><b>7.2</b> Summary Statistics</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="statistical-summaries-and-tests.html"><a href="statistical-summaries-and-tests.html#summarize-by-group-stratifying-a-summary"><i class="fa fa-check"></i><b>7.2.1</b> Summarize by group: <em>stratifying a summary</em></a></li>
<li class="chapter" data-level="7.2.2" data-path="statistical-summaries-and-tests.html"><a href="statistical-summaries-and-tests.html#boxplot-for-visualizing-distributions-by-group"><i class="fa fa-check"></i><b>7.2.2</b> Boxplot for visualizing distributions by group</a></li>
<li class="chapter" data-level="7.2.3" data-path="statistical-summaries-and-tests.html"><a href="statistical-summaries-and-tests.html#generating-pseudorandom-numbers"><i class="fa fa-check"></i><b>7.2.3</b> Generating pseudorandom numbers</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="statistical-summaries-and-tests.html"><a href="statistical-summaries-and-tests.html#statistical-tests"><i class="fa fa-check"></i><b>7.3</b> Statistical tests</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="statistical-summaries-and-tests.html"><a href="statistical-summaries-and-tests.html#comparing-samples-and-groupings"><i class="fa fa-check"></i><b>7.3.1</b> Comparing samples and groupings</a></li>
<li class="chapter" data-level="7.3.2" data-path="statistical-summaries-and-tests.html"><a href="statistical-summaries-and-tests.html#correlation"><i class="fa fa-check"></i><b>7.3.2</b> Correlation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="modeling-in-r.html"><a href="modeling-in-r.html"><i class="fa fa-check"></i><b>8</b> Modeling in R</a>
<ul>
<li class="chapter" data-level="8.1" data-path="modeling-in-r.html"><a href="modeling-in-r.html#some-common-statistical-models"><i class="fa fa-check"></i><b>8.1</b> Some common statistical models</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="modeling-in-r.html"><a href="modeling-in-r.html#analysis-of-covariance"><i class="fa fa-check"></i><b>8.1.1</b> Analysis of Covariance</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="modeling-in-r.html"><a href="modeling-in-r.html#generalized-linear-model-glm"><i class="fa fa-check"></i><b>8.2</b> Generalized Linear Model (GLM)</a></li>
<li class="chapter" data-level="8.3" data-path="modeling-in-r.html"><a href="modeling-in-r.html#models-employing-machine-learning"><i class="fa fa-check"></i><b>8.3</b> Models Employing Machine Learning</a></li>
<li class="chapter" data-level="8.4" data-path="modeling-in-r.html"><a href="modeling-in-r.html#spatial-statistical-analysis"><i class="fa fa-check"></i><b>8.4</b> Spatial Statistical Analysis</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="modeling-in-r.html"><a href="modeling-in-r.html#spatial-autocorrelation"><i class="fa fa-check"></i><b>8.4.1</b> Spatial Autocorrelation</a></li>
<li class="chapter" data-level="8.4.2" data-path="modeling-in-r.html"><a href="modeling-in-r.html#mapping-residuals"><i class="fa fa-check"></i><b>8.4.2</b> Mapping Residuals</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV Time Series</b></span></li>
<li class="chapter" data-level="9" data-path="time-series-visualization-analysis.html"><a href="time-series-visualization-analysis.html"><i class="fa fa-check"></i><b>9</b> Time Series Visualization &amp; Analysis</a>
<ul>
<li class="chapter" data-level="9.1" data-path="time-series-visualization-analysis.html"><a href="time-series-visualization-analysis.html#creation-of-time-series-ts-data"><i class="fa fa-check"></i><b>9.1</b> Creation of time series (ts) data</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="time-series-visualization-analysis.html"><a href="time-series-visualization-analysis.html#frequency-setting"><i class="fa fa-check"></i><b>9.1.1</b> frequency setting</a></li>
<li class="chapter" data-level="9.1.2" data-path="time-series-visualization-analysis.html"><a href="time-series-visualization-analysis.html#data-logger-data-from-marble-mountains-resurgence"><i class="fa fa-check"></i><b>9.1.2</b> Data logger data from Marble Mountains resurgence</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="time-series-visualization-analysis.html"><a href="time-series-visualization-analysis.html#data-smoothing-methods"><i class="fa fa-check"></i><b>9.2</b> Data smoothing methods</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="time-series-visualization-analysis.html"><a href="time-series-visualization-analysis.html#moving-average-ma"><i class="fa fa-check"></i><b>9.2.1</b> moving average (ma)</a></li>
<li class="chapter" data-level="9.2.2" data-path="time-series-visualization-analysis.html"><a href="time-series-visualization-analysis.html#loess-local-regression-smoothing"><i class="fa fa-check"></i><b>9.2.2</b> loess (local regression) smoothing</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="time-series-visualization-analysis.html"><a href="time-series-visualization-analysis.html#decomposing-time-series"><i class="fa fa-check"></i><b>9.3</b> Decomposing time series</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="time-series-visualization-analysis.html"><a href="time-series-visualization-analysis.html#lag-regression"><i class="fa fa-check"></i><b>9.3.1</b> lag regression</a></li>
<li class="chapter" data-level="9.3.2" data-path="time-series-visualization-analysis.html"><a href="time-series-visualization-analysis.html#ensemble-average"><i class="fa fa-check"></i><b>9.3.2</b> Ensemble Average</a></li>
<li class="chapter" data-level="9.3.3" data-path="time-series-visualization-analysis.html"><a href="time-series-visualization-analysis.html#julian-dates"><i class="fa fa-check"></i><b>9.3.3</b> Julian Dates</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="time-series-visualization-analysis.html"><a href="time-series-visualization-analysis.html#learning-more-about-time-series-in-r"><i class="fa fa-check"></i><b>9.4</b> Learning more about time series in R</a></li>
</ul></li>
<li class="part"><span><b>V Communication &amp; Special Topics</b></span></li>
<li class="chapter" data-level="10" data-path="communication.html"><a href="communication.html"><i class="fa fa-check"></i><b>10</b> Communication</a></li>
<li class="chapter" data-level="" data-path="appendix-building-a-data-package-for-github.html"><a href="appendix-building-a-data-package-for-github.html"><i class="fa fa-check"></i>Appendix: Building a Data Package for GitHub</a>
<ul>
<li><a href="appendix-building-a-data-package-for-github.html#rda-files"><code>rda</code> files</a>
<ul>
<li><a href="appendix-building-a-data-package-for-github.html#usethisuse_data"><code>usethis::use_data()</code></a></li>
<li><a href="appendix-building-a-data-package-for-github.html#usethiscreate_package"><code>usethis::create_package()</code></a></li>
<li><a href="appendix-building-a-data-package-for-github.html#devtoolsdocument"><code>devtools::document()</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix-building-a-data-package-for-github.html"><a href="appendix-building-a-data-package-for-github.html#raw-data"><i class="fa fa-check"></i>Raw data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to Environmental Data Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="statistical-summaries-and-tests" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Statistical Summaries and Tests</h1>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-177-1.png" width="672" /></p>
<div id="goals-of-statistical-analysis" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> Goals of statistical analysis</h2>
<p>To frame how we might approach statistical analysis and modeling, there are
various goals that are commonly involved:</p>
<ul>
<li>To understand our data
<ul>
<li>nature of our data, through summary statistics and various graphics like histograms</li>
<li>spatial statistical analysis</li>
<li>time series analysis</li>
</ul></li>
<li>To <em>group</em> or <em>classify</em> things based on their properties
<ul>
<li>using factors to define groups, and deriving grouped summaries</li>
<li>comparing <em>observed</em> vs <em>expected</em> counts or probabilities</li>
</ul></li>
<li>To understand how variables relate to one another
<ul>
<li>or maybe even explain variations in other variables, through correlation analysis</li>
</ul></li>
<li>To <em>model</em> behavior and maybe <em>predict</em> it
<ul>
<li>various linear models</li>
</ul></li>
<li>To <em>confirm</em> our observations from exploration (field/lab/vis)
<ul>
<li>inferential statistics e.g. difference of means tests, ANOVA, X^2</li>
</ul></li>
<li>To have the confidence to draw conclusions, make informed decisions</li>
<li>To help <em>communicate</em> our work</li>
</ul>
<p>These goals can be seen in the context of a typical research paper or thesis outline in environmental science:</p>
<ul>
<li>Introduction</li>
<li>Literature Review</li>
<li>Methodology</li>
<li>Results
<ul>
<li>field, lab, geospatial data</li>
</ul></li>
<li>Analysis
<ul>
<li>statistical analysis</li>
<li>qualitative analysis</li>
<li>visualization</li>
</ul></li>
<li>Discussion
<ul>
<li>making sense of analysis</li>
<li>possibly recursive, with visualization</li>
</ul></li>
<li>Conclusion
<ul>
<li>conclusion about what the above shows</li>
<li>new questions for further research</li>
<li>possible policy recommendation</li>
</ul></li>
</ul>
<p>The scope and theory of statistical analysis and models is extensive, and there are many good books
on the subject that employ the R language. This chapter is a short review of some of
these methods and how they apply to environmental data science.</p>
</div>
<div id="summary-statistics" class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> Summary Statistics</h2>
<p>Summary statistics such as mean, standard deviation, variance, minimum, maximum, and range are derived in quite a few
R functions, commonly as a parameter or a sub-function (see <code>mutate</code>). An overall simple statistical summary is very easy to do in base R:</p>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb371-1"><a href="statistical-summaries-and-tests.html#cb371-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(tidy_eucoak)</span></code></pre></div>
<pre><code>##      site               site #          tree                Date               month              rain_mm      rain_subcanopy 
##  Length:180         Min.   :1.000   Length:180         Min.   :2006-11-08   Length:180         Min.   : 1.00   Min.   : 1.00  
##  Class :character   1st Qu.:2.000   Class :character   1st Qu.:2006-12-07   Class :character   1st Qu.:16.00   1st Qu.:16.00  
##  Mode  :character   Median :4.000   Mode  :character   Median :2007-01-30   Mode  :character   Median :28.50   Median :30.00  
##                     Mean   :4.422                      Mean   :2007-01-29                      Mean   :37.99   Mean   :34.84  
##                     3rd Qu.:6.000                      3rd Qu.:2007-03-22                      3rd Qu.:63.25   3rd Qu.:50.00  
##                     Max.   :8.000                      Max.   :2007-05-07                      Max.   :99.00   Max.   :98.00  
##                                                                                                NA&#39;s   :36      NA&#39;s   :4      
##      slope           aspect         runoff_L      surface_tension runoff_rainfall_ratio
##  Min.   : 9.00   Min.   :100.0   Min.   : 0.000   Min.   :28.51   Min.   :0.00000      
##  1st Qu.:12.00   1st Qu.:143.0   1st Qu.: 0.000   1st Qu.:37.40   1st Qu.:0.00000      
##  Median :24.00   Median :196.0   Median : 0.825   Median :62.60   Median :0.03347      
##  Mean   :20.48   Mean   :186.6   Mean   : 2.244   Mean   :55.73   Mean   :0.05981      
##  3rd Qu.:27.00   3rd Qu.:221.8   3rd Qu.: 3.200   3rd Qu.:72.75   3rd Qu.:0.08474      
##  Max.   :32.00   Max.   :296.0   Max.   :16.000   Max.   :72.75   Max.   :0.42000      
##                                  NA&#39;s   :8        NA&#39;s   :44      NA&#39;s   :8</code></pre>
<div id="summarize-by-group-stratifying-a-summary" class="section level3" number="7.2.1">
<h3><span class="header-section-number">7.2.1</span> Summarize by group: <em>stratifying a summary</em></h3>
<div class="sourceCode" id="cb373"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb373-1"><a href="statistical-summaries-and-tests.html#cb373-1" aria-hidden="true" tabindex="-1"></a>eucoakrainfallrunoffTDR <span class="sc">%&gt;%</span></span>
<span id="cb373-2"><a href="statistical-summaries-and-tests.html#cb373-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(site) <span class="sc">%&gt;%</span></span>
<span id="cb373-3"><a href="statistical-summaries-and-tests.html#cb373-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb373-4"><a href="statistical-summaries-and-tests.html#cb373-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">rain =</span> <span class="fu">mean</span>(rain_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb373-5"><a href="statistical-summaries-and-tests.html#cb373-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">rainSD =</span> <span class="fu">sd</span>(rain_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb373-6"><a href="statistical-summaries-and-tests.html#cb373-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">runoffL_oak =</span> <span class="fu">mean</span>(runoffL_oak, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb373-7"><a href="statistical-summaries-and-tests.html#cb373-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">runoffL_euc =</span> <span class="fu">mean</span>(runoffL_euc, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb373-8"><a href="statistical-summaries-and-tests.html#cb373-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">runoffL_oakMax =</span> <span class="fu">max</span>(runoffL_oak, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb373-9"><a href="statistical-summaries-and-tests.html#cb373-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">runoffL_eucMax =</span> <span class="fu">max</span>(runoffL_oak, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb373-10"><a href="statistical-summaries-and-tests.html#cb373-10" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 8 x 7
##   site   rain rainSD runoffL_oak runoffL_euc runoffL_oakMax runoffL_eucMax
##   &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;          &lt;dbl&gt;          &lt;dbl&gt;
## 1 AB1    48.4   28.2      6.80         6.03          6.80           6.80  
## 2 AB2    34.1   27.9      4.91         3.65          4.91           4.91  
## 3 KM1    48     32.0      1.94         0.592         1.94           1.94  
## 4 PR1    56.5   19.1      0.459        2.31          0.459          0.459 
## 5 TP1    38.4   29.5      0.877        1.66          0.877          0.877 
## 6 TP2    34.3   29.2      0.0955       1.53          0.0955         0.0955
## 7 TP3    32.1   28.4      0.381        0.815         0.381          0.381 
## 8 TP4    32.5   28.2      0.231        2.83          0.231          0.231</code></pre>
</div>
<div id="boxplot-for-visualizing-distributions-by-group" class="section level3" number="7.2.2">
<h3><span class="header-section-number">7.2.2</span> Boxplot for visualizing distributions by group</h3>
<p>A Tukey boxplot is a good way to visualize distributions by group. In this soil CO<sub>2</sub>
study of the Marble Mountains <span class="citation">(<a href="references.html#ref-marblesCO2" role="doc-biblioref">J. D. Davis, Kiefer, and Amato 2001</a>)</span>, some sites had much greater variance, and some sites
tended to be low vs high:</p>
<div class="sourceCode" id="cb375"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb375-1"><a href="statistical-summaries-and-tests.html#cb375-1" aria-hidden="true" tabindex="-1"></a>soilCO2_97<span class="sc">$</span>SITE <span class="ot">&lt;-</span> <span class="fu">factor</span>(soilCO2_97<span class="sc">$</span>SITE)</span>
<span id="cb375-2"><a href="statistical-summaries-and-tests.html#cb375-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> soilCO2_97, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> SITE, <span class="at">y =</span> <span class="st">`</span><span class="at">CO2%</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb375-3"><a href="statistical-summaries-and-tests.html#cb375-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-180-1.png" width="672" /></p>
<p><img src="img/marblesCO2map.png">
<img src="img/marblesCO2ortho.png"></p>
</div>
<div id="generating-pseudorandom-numbers" class="section level3" number="7.2.3">
<h3><span class="header-section-number">7.2.3</span> Generating pseudorandom numbers</h3>
<p>Functions commonly used in R books for quickly creating a lot of numbers to display are those
that generate pseudorandom numbers. These are also useful in statistical methods that
need a lot of these, such as in Monte Carlo simulation. The two most commonly used are:</p>
<ul>
<li><strong><code>runif()</code></strong> generates a vector of <code>n</code> pseudorandom numbers ranging by default from <code>min=0</code> to <code>max=1</code>.</li>
<li><strong><code>rnorm()</code></strong> generates a vector of <code>n</code> normally distributed pseudorandom numbers with a default
<code>mean=0</code> and <code>sd=0</code>.</li>
</ul>
<p>To see both in action as x and y:</p>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb376-1"><a href="statistical-summaries-and-tests.html#cb376-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">runif</span>(<span class="at">n=</span><span class="dv">1000</span>, <span class="at">min=</span><span class="dv">10</span>, <span class="at">max=</span><span class="dv">20</span>))</span>
<span id="cb376-2"><a href="statistical-summaries-and-tests.html#cb376-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(x) <span class="ot">&lt;-</span> <span class="st">&#39;x&#39;</span></span>
<span id="cb376-3"><a href="statistical-summaries-and-tests.html#cb376-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(x, <span class="fu">aes</span>(<span class="at">x=</span>x)) <span class="sc">+</span> <span class="fu">geom_histogram</span>()</span></code></pre></div>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-181-1.png" width="672" /></p>
<div class="sourceCode" id="cb377"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb377-1"><a href="statistical-summaries-and-tests.html#cb377-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">rnorm</span>(<span class="at">n=</span><span class="dv">1000</span>, <span class="at">mean=</span><span class="dv">100</span>, <span class="at">sd=</span><span class="dv">10</span>))</span>
<span id="cb377-2"><a href="statistical-summaries-and-tests.html#cb377-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(y) <span class="ot">&lt;-</span> <span class="st">&#39;y&#39;</span></span>
<span id="cb377-3"><a href="statistical-summaries-and-tests.html#cb377-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(y, <span class="fu">aes</span>(<span class="at">x=</span>y)) <span class="sc">+</span> <span class="fu">geom_histogram</span>()</span></code></pre></div>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-181-2.png" width="672" /></p>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb378-1"><a href="statistical-summaries-and-tests.html#cb378-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(y, <span class="fu">aes</span>(<span class="at">x=</span>y)) <span class="sc">+</span> <span class="fu">geom_density</span>()</span></code></pre></div>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-181-3.png" width="672" /></p>
<div class="sourceCode" id="cb379"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb379-1"><a href="statistical-summaries-and-tests.html#cb379-1" aria-hidden="true" tabindex="-1"></a>xy <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(x,y)</span>
<span id="cb379-2"><a href="statistical-summaries-and-tests.html#cb379-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(xy, <span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>y)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-181-4.png" width="672" /></p>
</div>
</div>
<div id="statistical-tests" class="section level2" number="7.3">
<h2><span class="header-section-number">7.3</span> Statistical tests</h2>
<p>Tests that compare our data to other data or look at relationships among variables are important statistical
methods, and you should refer to statistical references to best understand how to apply
the appropriate methods for your research.</p>
<div id="comparing-samples-and-groupings" class="section level3" number="7.3.1">
<h3><span class="header-section-number">7.3.1</span> Comparing samples and groupings</h3>
<p>A common need in environmental research is to compare samples of a phenomenon or compare samples with an assumed standard population. The simplest application of this is the t-test, which can only involve comparing two samples or one sample with a population. Analysis of Variance extends this to allow for more than two groups, and can be seen as a linear model where the categorical grouping (as a factor in R) is one of the variables.</p>
<div id="t.test-and-a-non-parametric-alternative-the-kruskal-wallis-rank-sum-test" class="section level4" number="7.3.1.1">
<h4><span class="header-section-number">7.3.1.1</span> t.test and a non-parametric alternative, the Kruskal-Wallis Rank Sum test</h4>
<div class="sourceCode" id="cb380"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb380-1"><a href="statistical-summaries-and-tests.html#cb380-1" aria-hidden="true" tabindex="-1"></a>XSptsPheno <span class="sc">%&gt;%</span></span>
<span id="cb380-2"><a href="statistical-summaries-and-tests.html#cb380-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(NDVI, <span class="at">fill=</span>phenology)) <span class="sc">+</span></span>
<span id="cb380-3"><a href="statistical-summaries-and-tests.html#cb380-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha=</span><span class="fl">0.2</span>)</span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-183"></span>
<img src="EnvDataSci_files/figure-html/unnamed-chunk-183-1.png" alt="NDVI by phenology" width="672" />
<p class="caption">
Figure 7.1: NDVI by phenology
</p>
</div>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb381-1"><a href="statistical-summaries-and-tests.html#cb381-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(NDVI<span class="sc">~</span>phenology, <span class="at">data=</span>XSptsPheno) </span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  NDVI by phenology
## t = 5.4952, df = 52.03, p-value = 1.19e-06
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  0.1421785 0.3057412
## sample estimates:
##   mean in group growing mean in group senescent 
##               0.5901186               0.3661588</code></pre>
<p>While these data sets appear reasonably normal, the Shapiro-Wilk test (which uses a null hypothesis of normal)
has a p value &lt; 0.05 for the senescent group, so the data can’t be assumed to be normal.</p>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb383-1"><a href="statistical-summaries-and-tests.html#cb383-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(XSptsPheno<span class="sc">$</span>NDVI[XSptsPheno<span class="sc">$</span>phenology<span class="sc">==</span><span class="st">&quot;growing&quot;</span>])</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  XSptsPheno$NDVI[XSptsPheno$phenology == &quot;growing&quot;]
## W = 0.93608, p-value = 0.07918</code></pre>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb385-1"><a href="statistical-summaries-and-tests.html#cb385-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(XSptsPheno<span class="sc">$</span>NDVI[XSptsPheno<span class="sc">$</span>phenology<span class="sc">==</span><span class="st">&quot;senescent&quot;</span>])</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  XSptsPheno$NDVI[XSptsPheno$phenology == &quot;senescent&quot;]
## W = 0.88728, p-value = 0.004925</code></pre>
<p>Therefore we should use a non-parametric alternative such as the Kruskal-Wallis Rank Sum test:</p>
<div class="sourceCode" id="cb387"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb387-1"><a href="statistical-summaries-and-tests.html#cb387-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kruskal.test</span>(NDVI<span class="sc">~</span>phenology, <span class="at">data=</span>XSptsPheno)</span></code></pre></div>
<pre><code>## 
##  Kruskal-Wallis rank sum test
## 
## data:  NDVI by phenology
## Kruskal-Wallis chi-squared = 19.164, df = 1, p-value = 1.199e-05</code></pre>
<p>[<strong><code>eucoak</code></strong>] For the question “Is the runoff under Eucalyptus canopy significantly different from that under oaks?” we’ll then start by test for normality of each of the two samples (euc and oak)</p>
<div class="sourceCode" id="cb389"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb389-1"><a href="statistical-summaries-and-tests.html#cb389-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(tidy_eucoak<span class="sc">$</span>runoff_L[tidy_eucoak<span class="sc">$</span>tree <span class="sc">==</span> <span class="st">&quot;euc&quot;</span>])</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  tidy_eucoak$runoff_L[tidy_eucoak$tree == &quot;euc&quot;]
## W = 0.74241, p-value = 4.724e-11</code></pre>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb391-1"><a href="statistical-summaries-and-tests.html#cb391-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(tidy_eucoak<span class="sc">$</span>runoff_L[tidy_eucoak<span class="sc">$</span>tree <span class="sc">==</span> <span class="st">&quot;oak&quot;</span>])</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  tidy_eucoak$runoff_L[tidy_eucoak$tree == &quot;oak&quot;]
## W = 0.71744, p-value = 1.698e-11</code></pre>
<p>which shows clearly that both samples are non-normal. So we might apply the non-parametric Kruskal-Wallis
test:</p>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb393-1"><a href="statistical-summaries-and-tests.html#cb393-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kruskal.test</span>(runoff_L<span class="sc">~</span>tree, <span class="at">data=</span>tidy_eucoak)</span></code></pre></div>
<pre><code>## 
##  Kruskal-Wallis rank sum test
## 
## data:  runoff_L by tree
## Kruskal-Wallis chi-squared = 2.2991, df = 1, p-value = 0.1294</code></pre>
<p>and no significant difference can be seen. If we look at the data graphically, this makes sense:</p>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb395-1"><a href="statistical-summaries-and-tests.html#cb395-1" aria-hidden="true" tabindex="-1"></a>tidy_eucoak <span class="sc">%&gt;%</span></span>
<span id="cb395-2"><a href="statistical-summaries-and-tests.html#cb395-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="fu">log</span>(runoff_L),<span class="at">fill=</span>tree)) <span class="sc">+</span></span>
<span id="cb395-3"><a href="statistical-summaries-and-tests.html#cb395-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha=</span><span class="fl">0.2</span>)</span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-188"></span>
<img src="EnvDataSci_files/figure-html/unnamed-chunk-188-1.png" alt="Runoff under Eucalyptus and Oak in Bay Area sites" width="672" />
<p class="caption">
Figure 7.2: Runoff under Eucalyptus and Oak in Bay Area sites
</p>
</div>
<p>However, some of this may result from major variations among sites, which is apparent in this boxplot:</p>
<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb396-1"><a href="statistical-summaries-and-tests.html#cb396-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> tidy_eucoak) <span class="sc">+</span></span>
<span id="cb396-2"><a href="statistical-summaries-and-tests.html#cb396-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>site, <span class="at">y=</span>runoff_L, <span class="at">color=</span>tree))</span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-189"></span>
<img src="EnvDataSci_files/figure-html/unnamed-chunk-189-1.png" alt="runoff at various sites contrasting euc and oak" width="672" />
<p class="caption">
Figure 7.3: runoff at various sites contrasting euc and oak
</p>
</div>
<p>We might restrict our analysis to Tilden Park sites in the East Bay.</p>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb397-1"><a href="statistical-summaries-and-tests.html#cb397-1" aria-hidden="true" tabindex="-1"></a>tilden <span class="ot">&lt;-</span> tidy_eucoak <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">str_detect</span>(tidy_eucoak<span class="sc">$</span>site,<span class="st">&quot;TP&quot;</span>))</span>
<span id="cb397-2"><a href="statistical-summaries-and-tests.html#cb397-2" aria-hidden="true" tabindex="-1"></a>tilden <span class="sc">%&gt;%</span></span>
<span id="cb397-3"><a href="statistical-summaries-and-tests.html#cb397-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="fu">log</span>(runoff_L),<span class="at">fill=</span>tree)) <span class="sc">+</span></span>
<span id="cb397-4"><a href="statistical-summaries-and-tests.html#cb397-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha=</span><span class="fl">0.2</span>)</span></code></pre></div>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-190-1.png" width="672" /></p>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb398-1"><a href="statistical-summaries-and-tests.html#cb398-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(tilden<span class="sc">$</span>runoff_L[tilden<span class="sc">$</span>tree <span class="sc">==</span> <span class="st">&quot;euc&quot;</span>])</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  tilden$runoff_L[tilden$tree == &quot;euc&quot;]
## W = 0.73933, p-value = 1.764e-07</code></pre>
<div class="sourceCode" id="cb400"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb400-1"><a href="statistical-summaries-and-tests.html#cb400-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(tilden<span class="sc">$</span>runoff_L[tilden<span class="sc">$</span>tree <span class="sc">==</span> <span class="st">&quot;oak&quot;</span>])</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  tilden$runoff_L[tilden$tree == &quot;oak&quot;]
## W = 0.59535, p-value = 8.529e-10</code></pre>
<p>So once again, as is common with small sample sets, we need a non-parametric test.</p>
<div class="sourceCode" id="cb402"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb402-1"><a href="statistical-summaries-and-tests.html#cb402-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kruskal.test</span>(runoff_L<span class="sc">~</span>tree, <span class="at">data=</span>tilden)</span></code></pre></div>
<pre><code>## 
##  Kruskal-Wallis rank sum test
## 
## data:  runoff_L by tree
## Kruskal-Wallis chi-squared = 14.527, df = 1, p-value = 0.0001382</code></pre>
<p><strong>Analysis process from exploration to testing</strong></p>
<p>[<strong><code>eucoak</code></strong>] In the year runoff was studied, there were no runoff events sufficient to mobilize sediments. The next year, January had a big event, so we collected sediments and processed them in the lab. <span class="citation">(<a href="references.html#ref-eucoak" role="doc-biblioref">Thompson, Davis, and Oliphant 2016</a>)</span></p>
<p>Questions:</p>
<ul>
<li>Is there a difference between eucs and oaks in terms of fine sediment yield?</li>
<li>Is there a difference between eucs and oaks in terms of total sediment yield? (includes litter)</li>
</ul>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb404-1"><a href="statistical-summaries-and-tests.html#cb404-1" aria-hidden="true" tabindex="-1"></a>csvPath <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;eucoaksediment.csv&quot;</span>, <span class="at">package=</span><span class="st">&quot;iGIScData&quot;</span>)</span>
<span id="cb404-2"><a href="statistical-summaries-and-tests.html#cb404-2" aria-hidden="true" tabindex="-1"></a>eucoaksed <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(csvPath)</span>
<span id="cb404-3"><a href="statistical-summaries-and-tests.html#cb404-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(eucoaksed)</span></code></pre></div>
<pre><code>##       id                site              trtype              slope        bulkDensity        litter         Jan08rain    
##  Length:14          Length:14          Length:14          Min.   : 9.00   Min.   :0.960   Min.   : 25.00   Min.   :228.1  
##  Class :character   Class :character   Class :character   1st Qu.:12.00   1st Qu.:1.060   1st Qu.: 51.25   1st Qu.:290.8  
##  Mode  :character   Mode  :character   Mode  :character   Median :21.00   Median :1.125   Median : 77.00   Median :301.1  
##                                                           Mean   :20.04   Mean   :1.156   Mean   : 76.64   Mean   :298.5  
##                                                           3rd Qu.:25.00   3rd Qu.:1.245   3rd Qu.: 95.75   3rd Qu.:317.0  
##                                                           Max.   :32.00   Max.   :1.490   Max.   :135.00   Max.   :328.5  
##                                                                                                                           
##  mean_runoff_ratio med_runoff_ratio  std_runoff_ratio     fines_g         litter_g        total_g       fineTotalRatio   fineRainRatio  
##  Min.   :0.00450   Min.   :0.00000   Min.   :0.01070   Min.   : 7.50   Min.   :14.00   Min.   : 23.50   Min.   :0.1300   Min.   :0.025  
##  1st Qu.:0.02285   1st Qu.:0.01105   1st Qu.:0.01642   1st Qu.:13.30   1st Qu.:18.80   1st Qu.: 35.00   1st Qu.:0.2700   1st Qu.:0.044  
##  Median :0.04835   Median :0.04950   Median :0.02740   Median :18.10   Median :40.40   Median : 60.50   Median :0.3900   Median :0.064  
##  Mean   :0.06679   Mean   :0.06179   Mean   :0.04355   Mean   :27.77   Mean   :41.32   Mean   : 69.12   Mean   :0.3715   Mean   :0.097  
##  3rd Qu.:0.12172   3rd Qu.:0.09492   3rd Qu.:0.05735   3rd Qu.:45.00   3rd Qu.:57.50   3rd Qu.: 95.50   3rd Qu.:0.4900   3rd Qu.:0.141  
##  Max.   :0.16480   Max.   :0.16430   Max.   :0.11480   Max.   :66.70   Max.   :97.80   Max.   :125.90   Max.   :0.5500   Max.   :0.293  
##                                                        NA&#39;s   :1       NA&#39;s   :1       NA&#39;s   :1        NA&#39;s   :1        NA&#39;s   :1</code></pre>
<div class="sourceCode" id="cb406"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb406-1"><a href="statistical-summaries-and-tests.html#cb406-1" aria-hidden="true" tabindex="-1"></a>eucoaksed <span class="sc">%&gt;%</span></span>
<span id="cb406-2"><a href="statistical-summaries-and-tests.html#cb406-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(trtype) <span class="sc">%&gt;%</span></span>
<span id="cb406-3"><a href="statistical-summaries-and-tests.html#cb406-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">meanfines =</span> <span class="fu">mean</span>(fines_g, <span class="at">na.rm=</span>T), <span class="at">sdfines =</span> <span class="fu">sd</span>(fines_g, <span class="at">na.rm=</span>T),</span>
<span id="cb406-4"><a href="statistical-summaries-and-tests.html#cb406-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">meantotal =</span> <span class="fu">mean</span>(total_g, <span class="at">na.rm=</span>T), <span class="at">sdtotal =</span> <span class="fu">sd</span>(total_g, <span class="at">na.rm=</span>T))</span></code></pre></div>
<pre><code>## # A tibble: 2 x 5
##   trtype meanfines sdfines meantotal sdtotal
##   &lt;chr&gt;      &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
## 1 euc         14.2    3.50      48.6    35.0
## 2 oak         39.4   20.4       86.7    26.2</code></pre>
<div class="sourceCode" id="cb408"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb408-1"><a href="statistical-summaries-and-tests.html#cb408-1" aria-hidden="true" tabindex="-1"></a>eucoakLong <span class="ot">&lt;-</span> eucoaksed <span class="sc">%&gt;%</span> </span>
<span id="cb408-2"><a href="statistical-summaries-and-tests.html#cb408-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">col=</span><span class="fu">c</span>(fines_g,litter_g), </span>
<span id="cb408-3"><a href="statistical-summaries-and-tests.html#cb408-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;sed_type&quot;</span>, </span>
<span id="cb408-4"><a href="statistical-summaries-and-tests.html#cb408-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;sed_g&quot;</span>)</span>
<span id="cb408-5"><a href="statistical-summaries-and-tests.html#cb408-5" aria-hidden="true" tabindex="-1"></a>eucoakLong <span class="sc">%&gt;%</span></span>
<span id="cb408-6"><a href="statistical-summaries-and-tests.html#cb408-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(trtype, sed_g, <span class="at">col=</span>sed_type)) <span class="sc">+</span> </span>
<span id="cb408-7"><a href="statistical-summaries-and-tests.html#cb408-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-193-1.png" width="672" /></p>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb409-1"><a href="statistical-summaries-and-tests.html#cb409-1" aria-hidden="true" tabindex="-1"></a>eucoakLong <span class="sc">%&gt;%</span></span>
<span id="cb409-2"><a href="statistical-summaries-and-tests.html#cb409-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(sed_g, <span class="at">col=</span>sed_type)) <span class="sc">+</span> </span>
<span id="cb409-3"><a href="statistical-summaries-and-tests.html#cb409-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>() <span class="sc">+</span></span>
<span id="cb409-4"><a href="statistical-summaries-and-tests.html#cb409-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(trtype <span class="sc">~</span> .)</span></code></pre></div>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-193-2.png" width="672" /></p>
<div class="sourceCode" id="cb410"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb410-1"><a href="statistical-summaries-and-tests.html#cb410-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(eucoaksed<span class="sc">$</span>fines_g[eucoaksed<span class="sc">$</span>trtype <span class="sc">==</span> <span class="st">&quot;euc&quot;</span>])</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  eucoaksed$fines_g[eucoaksed$trtype == &quot;euc&quot;]
## W = 0.9374, p-value = 0.6383</code></pre>
<div class="sourceCode" id="cb412"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb412-1"><a href="statistical-summaries-and-tests.html#cb412-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(eucoaksed<span class="sc">$</span>fines_g[eucoaksed<span class="sc">$</span>trtype <span class="sc">==</span> <span class="st">&quot;oak&quot;</span>])</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  eucoaksed$fines_g[eucoaksed$trtype == &quot;oak&quot;]
## W = 0.96659, p-value = 0.8729</code></pre>
<div class="sourceCode" id="cb414"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb414-1"><a href="statistical-summaries-and-tests.html#cb414-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(fines_g<span class="sc">~</span>trtype, <span class="at">data=</span>eucoaksed) </span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  fines_g by trtype
## t = -3.2102, df = 6.4104, p-value = 0.01675
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -44.059797  -6.278299
## sample estimates:
## mean in group euc mean in group oak 
##          14.21667          39.38571</code></pre>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb416-1"><a href="statistical-summaries-and-tests.html#cb416-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(eucoaksed<span class="sc">$</span>total_g[eucoaksed<span class="sc">$</span>trtype <span class="sc">==</span> <span class="st">&quot;euc&quot;</span>])</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  eucoaksed$total_g[eucoaksed$trtype == &quot;euc&quot;]
## W = 0.76405, p-value = 0.02725</code></pre>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb418-1"><a href="statistical-summaries-and-tests.html#cb418-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(eucoaksed<span class="sc">$</span>total_g[eucoaksed<span class="sc">$</span>trtype <span class="sc">==</span> <span class="st">&quot;oak&quot;</span>])</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  eucoaksed$total_g[eucoaksed$trtype == &quot;oak&quot;]
## W = 0.94988, p-value = 0.7286</code></pre>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb420-1"><a href="statistical-summaries-and-tests.html#cb420-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kruskal.test</span>(total_g<span class="sc">~</span>trtype, <span class="at">data=</span>eucoaksed) </span></code></pre></div>
<pre><code>## 
##  Kruskal-Wallis rank sum test
## 
## data:  total_g by trtype
## Kruskal-Wallis chi-squared = 3.449, df = 1, p-value = 0.06329</code></pre>
<p>So we used a t test for the fines_g, and the test suggests that there’s a significant
difference in sediment yield for fines, but the Kruskal-Wallis test on total sediment
(including litter) did not show a significant difference. Both results support
the conclusion that oaks in this study produced more soil erosion, largely because
the Eucalyptus stands generate so much litter cover, and that litter also made the
total sediment yield not significantly different.</p>
</div>
<div id="analysis-of-variance" class="section level4" number="7.3.1.2">
<h4><span class="header-section-number">7.3.1.2</span> Analysis of Variance</h4>
<p>Purpose is to compare groups based upon continuous variables. Can be thought of as an extension of a t test where you have more than two groups, or as a linear model where one variable is a factor.</p>
<ul>
<li>Response variable is a continuous variable</li>
<li>Explanatory variable is the grouping – categorical (a factor in R)</li>
</ul>
<p>From a study of a karst system in Tennessee <span class="citation">(<a href="references.html#ref-davis1993geomorphology" role="doc-biblioref">Jerry D. Davis and Brook 1993</a>)</span>:</p>
<p><em>“Are water samples from streams draining sandstone, limestone, and shale different based on solutes measured as total hardness?”</em></p>
<p><img src="img/PigeonMtWaterSample.png" align = "left">
<img src="img/CaveCoveSink.png" align = "center">
<img src="img/HelenHighwaterSpring.png" align = "right"></p>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb422-1"><a href="statistical-summaries-and-tests.html#cb422-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf); <span class="fu">library</span>(tidyverse); <span class="fu">library</span>(readxl); <span class="fu">library</span>(tmap)</span>
<span id="cb422-2"><a href="statistical-summaries-and-tests.html#cb422-2" aria-hidden="true" tabindex="-1"></a>wChemData <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata/SinkingCove&quot;</span>,<span class="st">&quot;SinkingCoveWaterChem.xlsx&quot;</span>, <span class="at">package=</span><span class="st">&quot;iGIScData&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb422-3"><a href="statistical-summaries-and-tests.html#cb422-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">siteLoc =</span> <span class="fu">str_sub</span>(Site,<span class="at">start=</span>1L, <span class="at">end=</span>1L))</span>
<span id="cb422-4"><a href="statistical-summaries-and-tests.html#cb422-4" aria-hidden="true" tabindex="-1"></a>wChemTrunk <span class="ot">&lt;-</span> wChemData <span class="sc">%&gt;%</span> <span class="fu">filter</span>(siteLoc <span class="sc">==</span> <span class="st">&quot;T&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">siteType =</span> <span class="st">&quot;trunk&quot;</span>)</span>
<span id="cb422-5"><a href="statistical-summaries-and-tests.html#cb422-5" aria-hidden="true" tabindex="-1"></a>wChemDrip <span class="ot">&lt;-</span> wChemData <span class="sc">%&gt;%</span> <span class="fu">filter</span>(siteLoc <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;D&quot;</span>,<span class="st">&quot;S&quot;</span>)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">siteType =</span> <span class="st">&quot;dripwater&quot;</span>)</span>
<span id="cb422-6"><a href="statistical-summaries-and-tests.html#cb422-6" aria-hidden="true" tabindex="-1"></a>wChemTrib <span class="ot">&lt;-</span> wChemData <span class="sc">%&gt;%</span> <span class="fu">filter</span>(siteLoc <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;B&quot;</span>, <span class="st">&quot;F&quot;</span>, <span class="st">&quot;K&quot;</span>, <span class="st">&quot;W&quot;</span>, <span class="st">&quot;P&quot;</span>)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">siteType =</span> <span class="st">&quot;tributary&quot;</span>)</span>
<span id="cb422-7"><a href="statistical-summaries-and-tests.html#cb422-7" aria-hidden="true" tabindex="-1"></a>wChemData <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(wChemTrunk, wChemDrip, wChemTrib)</span>
<span id="cb422-8"><a href="statistical-summaries-and-tests.html#cb422-8" aria-hidden="true" tabindex="-1"></a>sites <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata/SinkingCove&quot;</span>, <span class="st">&quot;SinkingCoveSites.csv&quot;</span>, <span class="at">package=</span><span class="st">&quot;iGIScData&quot;</span>))</span>
<span id="cb422-9"><a href="statistical-summaries-and-tests.html#cb422-9" aria-hidden="true" tabindex="-1"></a>wChem <span class="ot">&lt;-</span> wChemData <span class="sc">%&gt;%</span></span>
<span id="cb422-10"><a href="statistical-summaries-and-tests.html#cb422-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(sites, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;Site&quot;</span> <span class="ot">=</span> <span class="st">&quot;site&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb422-11"><a href="statistical-summaries-and-tests.html#cb422-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>(<span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;longitude&quot;</span>, <span class="st">&quot;latitude&quot;</span>), <span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb422-12"><a href="statistical-summaries-and-tests.html#cb422-12" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">&quot;view&quot;</span>)</span>
<span id="cb422-13"><a href="statistical-summaries-and-tests.html#cb422-13" aria-hidden="true" tabindex="-1"></a>bounds <span class="ot">&lt;-</span> <span class="fu">st_bbox</span>()</span>
<span id="cb422-14"><a href="statistical-summaries-and-tests.html#cb422-14" aria-hidden="true" tabindex="-1"></a>wChem2map <span class="ot">&lt;-</span> <span class="fu">filter</span>(wChem, Month <span class="sc">==</span> <span class="dv">8</span>)</span>
<span id="cb422-15"><a href="statistical-summaries-and-tests.html#cb422-15" aria-hidden="true" tabindex="-1"></a>minVal <span class="ot">&lt;-</span> <span class="fu">min</span>(wChem2map<span class="sc">$</span>TH); maxVal <span class="ot">&lt;-</span> <span class="fu">max</span>(wChem2map<span class="sc">$</span>TH)</span>
<span id="cb422-16"><a href="statistical-summaries-and-tests.html#cb422-16" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_basemap</span>(leaflet<span class="sc">::</span>providers<span class="sc">$</span>Esri.WorldTopoMap) <span class="sc">+</span> </span>
<span id="cb422-17"><a href="statistical-summaries-and-tests.html#cb422-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(wChem2map) <span class="sc">+</span> <span class="fu">tm_symbols</span>(<span class="at">col=</span><span class="st">&quot;siteType&quot;</span>, <span class="at">size=</span><span class="st">&quot;TH&quot;</span>, <span class="at">scale=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb422-18"><a href="statistical-summaries-and-tests.html#cb422-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">title=</span><span class="fu">paste</span>(<span class="st">&quot;Total Hardness &quot;</span>,<span class="fu">as.character</span>(minVal),<span class="st">&quot;-&quot;</span>,<span class="fu">as.character</span>(maxVal),<span class="st">&quot; mg/L&quot;</span>, <span class="at">sep=</span><span class="st">&quot;&quot;</span>))</span></code></pre></div>
<div id="htmlwidget-dcbac24a4b293a8f4842" style="width:672px;height:480px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-dcbac24a4b293a8f4842">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"createMapPane","args":["tmap401",401]},{"method":"addProviderTiles","args":["Esri.WorldTopoMap",null,"Esri.WorldTopoMap",{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"pane":"tilePane"}]},{"method":"addCircles","args":[[35.04984497,35.05550831,35.05165428,35.0548464,35.05071159,35.05249625,35.05065137,35.05041618,35.05570091,35.05002313,35.04891244,35.05511924,35.05511924,35.04824914,35.05720511,35.05034814,35.05225242,35.05284356,35.05411424,35.04889576,35.05044697,35.06059962,35.0615126,35.05568202,35.04131459,35.06233771,35.06352676,35.06486428,35.06596295],[-86.01369419,-86.00519017,-86.00700342,-86.00671127,-86.00739887,-85.99817925,-86.00598119,-86.01373594,-86.00024908,-86.0176595,-86.01006991,-85.99990376,-85.99990376,-86.00202304,-86.00732013,-86.01545994,-86.00683137,-86.0067784,-86.00681603,-86.02837249,-86.01581609,-86.04003533,-86.0407566,-86.01856506,-86.02094707,-86.04134997,-86.04253228,-86.04228889,-86.04194144],[91.1509145576456,89.574699201233,87.1569446770343,87.1569446770343,83.8248652252299,83.2565545014926,82.108133228835,81.5278564648683,79.7617006592283,78.8637917437427,77.9555412036149,77.3441157540802,76.1065300525826,74.8484842298678,72.2667208418715,71.6067369642623,70.6051948146673,70.2681752540448,70.2681752540448,66.8045330849144,63.8985836339245,60.0687787255736,56.8193763368636,53.3725104996791,52.4754296263538,50.6336092860713,50.1625887295557,38.9777706018074,15.4073166521579],["D1","D7","D4","D6","D3","K2","K3","T8","T9","T7","D2","B2.1","B2","K1","K4","W7","S4","D5","D5.1","F1","W6","T6","T5","W2","W8","T4","T3","T2","T1"],"wChem2map",{"interactive":true,"className":"","pane":"tmap401","stroke":true,"color":"#666666","weight":1,"opacity":0.5,"fill":true,"fillColor":["#8DD3C7","#8DD3C7","#8DD3C7","#8DD3C7","#8DD3C7","#FFFFB3","#FFFFB3","#BEBADA","#BEBADA","#BEBADA","#8DD3C7","#FFFFB3","#FFFFB3","#FFFFB3","#FFFFB3","#FFFFB3","#8DD3C7","#8DD3C7","#8DD3C7","#FFFFB3","#FFFFB3","#BEBADA","#BEBADA","#FFFFB3","#FFFFB3","#BEBADA","#BEBADA","#BEBADA","#BEBADA"],"fillOpacity":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]},["<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>D1<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>175<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>siteType<\/nobr><\/td><td align=\"right\"><nobr>dripwater<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>D7<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>169<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>siteType<\/nobr><\/td><td align=\"right\"><nobr>dripwater<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>D4<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>160<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>siteType<\/nobr><\/td><td align=\"right\"><nobr>dripwater<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>D6<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>160<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>siteType<\/nobr><\/td><td align=\"right\"><nobr>dripwater<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>D3<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>148<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>siteType<\/nobr><\/td><td align=\"right\"><nobr>dripwater<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>K2<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>146<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>siteType<\/nobr><\/td><td align=\"right\"><nobr>tributary<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>K3<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>142<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>siteType<\/nobr><\/td><td align=\"right\"><nobr>tributary<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>T8<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>140<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>siteType<\/nobr><\/td><td align=\"right\"><nobr>trunk<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>T9<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>134<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>siteType<\/nobr><\/td><td align=\"right\"><nobr>trunk<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>T7<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>131<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>siteType<\/nobr><\/td><td align=\"right\"><nobr>trunk<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>D2<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>128<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>siteType<\/nobr><\/td><td align=\"right\"><nobr>dripwater<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>B2<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>126<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>siteType<\/nobr><\/td><td align=\"right\"><nobr>tributary<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>B2<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>122<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>siteType<\/nobr><\/td><td align=\"right\"><nobr>tributary<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>K1<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>118<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>siteType<\/nobr><\/td><td align=\"right\"><nobr>tributary<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>K4<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>110<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>siteType<\/nobr><\/td><td align=\"right\"><nobr>tributary<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>W7<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>108<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>siteType<\/nobr><\/td><td align=\"right\"><nobr>tributary<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>S4<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>105<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>siteType<\/nobr><\/td><td align=\"right\"><nobr>dripwater<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>D5<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>104<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>siteType<\/nobr><\/td><td align=\"right\"><nobr>dripwater<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>D5<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>104<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>siteType<\/nobr><\/td><td align=\"right\"><nobr>dripwater<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>F1<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>94<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>siteType<\/nobr><\/td><td align=\"right\"><nobr>tributary<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>W6<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>86<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>siteType<\/nobr><\/td><td align=\"right\"><nobr>tributary<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>T6<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>76<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>siteType<\/nobr><\/td><td align=\"right\"><nobr>trunk<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>T5<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>68<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>siteType<\/nobr><\/td><td align=\"right\"><nobr>trunk<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>W2<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>60<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>siteType<\/nobr><\/td><td align=\"right\"><nobr>tributary<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>W8<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>58<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>siteType<\/nobr><\/td><td align=\"right\"><nobr>tributary<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>T4<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>54<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>siteType<\/nobr><\/td><td align=\"right\"><nobr>trunk<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>T3<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>53<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>siteType<\/nobr><\/td><td align=\"right\"><nobr>trunk<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>T2<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>32<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>siteType<\/nobr><\/td><td align=\"right\"><nobr>trunk<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>T1<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>5<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>siteType<\/nobr><\/td><td align=\"right\"><nobr>trunk<\/nobr><\/td><\/tr><\/table><\/div>"],null,["D1","D7","D4","D6","D3","K2","K3","T8","T9","T7","D2","B2","B2","K1","K4","W7","S4","D5","D5","F1","W6","T6","T5","W2","W8","T4","T3","T2","T1"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null,null]},{"method":"addLegend","args":[{"colors":["#8DD3C7","#FFFFB3","#BEBADA"],"labels":["dripwater","tributary","trunk"],"na_color":null,"na_label":"NA","opacity":1,"position":"topright","type":"unknown","title":"siteType","extra":null,"layerId":"legend401","className":"info legend wChem2map","group":"wChem2map"}]},{"method":"addLayersControl","args":[[],"wChem2map",{"collapsed":true,"autoZIndex":true,"position":"topleft"}]}],"limits":{"lat":[35.04131459,35.06596295],"lng":[-86.04253228,-85.99817925]},"fitBounds":[35.04131459,-86.04253228,35.06596295,-85.99817925,[]]},"evals":[],"jsHooks":{"render":[{"code":"function(el, x, data) {\n  return (\n\t\t\t\t\t\tfunction(el, x) {\n\t\t\t\t\t\t\tvar tldiv = document.getElementsByClassName(\"leaflet-top leaflet-left\")[0];\n\t\t\t\t\t\t\tvar titlediv = document.createElement('div');\n\t\t\t\t\t\t\ttitlediv.className = \"info legend leaflet-control\";\n\t\t\t\t\t\t\ttitlediv.innerHTML = \"<b>Total Hardness 5-175 mg/L<\/b>\";\n\t\t\t\t\t\t\ttldiv.insertBefore(titlediv, tldiv.childNodes[0]);\n\t\t\t\t\t\t}).call(this.getMap(), el, x, data);\n}","data":null}]}}</script>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb423-1"><a href="statistical-summaries-and-tests.html#cb423-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">aov</span>(TH<span class="sc">~</span>siteType, <span class="at">data =</span> wChemData))</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## siteType     2  79172   39586   20.59 1.07e-07 ***
## Residuals   67 128815    1923                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb425-1"><a href="statistical-summaries-and-tests.html#cb425-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_basemap</span>(leaflet<span class="sc">::</span>providers<span class="sc">$</span>Esri.WorldTopoMap) <span class="sc">+</span> </span>
<span id="cb425-2"><a href="statistical-summaries-and-tests.html#cb425-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(wChem2map) <span class="sc">+</span> <span class="fu">tm_symbols</span>(<span class="at">col=</span><span class="st">&quot;Lithology&quot;</span>, <span class="at">size=</span><span class="st">&quot;TH&quot;</span>, <span class="at">scale=</span><span class="dv">2</span>)</span></code></pre></div>
<div id="htmlwidget-d86fee53d70fbd1a8ce9" style="width:672px;height:480px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-d86fee53d70fbd1a8ce9">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"createMapPane","args":["tmap401",401]},{"method":"addProviderTiles","args":["Esri.WorldTopoMap",null,"Esri.WorldTopoMap",{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"pane":"tilePane"}]},{"method":"addCircles","args":[[35.04984497,35.05550831,35.05165428,35.0548464,35.05071159,35.05249625,35.05065137,35.05041618,35.05570091,35.05002313,35.04891244,35.05511924,35.05511924,35.04824914,35.05720511,35.05034814,35.05225242,35.05284356,35.05411424,35.04889576,35.05044697,35.06059962,35.0615126,35.05568202,35.04131459,35.06233771,35.06352676,35.06486428,35.06596295],[-86.01369419,-86.00519017,-86.00700342,-86.00671127,-86.00739887,-85.99817925,-86.00598119,-86.01373594,-86.00024908,-86.0176595,-86.01006991,-85.99990376,-85.99990376,-86.00202304,-86.00732013,-86.01545994,-86.00683137,-86.0067784,-86.00681603,-86.02837249,-86.01581609,-86.04003533,-86.0407566,-86.01856506,-86.02094707,-86.04134997,-86.04253228,-86.04228889,-86.04194144],[91.1509145576456,89.574699201233,87.1569446770343,87.1569446770343,83.8248652252299,83.2565545014926,82.108133228835,81.5278564648683,79.7617006592283,78.8637917437427,77.9555412036149,77.3441157540802,76.1065300525826,74.8484842298678,72.2667208418715,71.6067369642623,70.6051948146673,70.2681752540448,70.2681752540448,66.8045330849144,63.8985836339245,60.0687787255736,56.8193763368636,53.3725104996791,52.4754296263538,50.6336092860713,50.1625887295557,38.9777706018074,15.4073166521579],["D1","D7","D4","D6","D3","K2","K3","T8","T9","T7","D2","B2.1","B2","K1","K4","W7","S4","D5","D5.1","F1","W6","T6","T5","W2","W8","T4","T3","T2","T1"],"wChem2map",{"interactive":true,"className":"","pane":"tmap401","stroke":true,"color":"#666666","weight":1,"opacity":0.5,"fill":true,"fillColor":["#8DD3C7","#8DD3C7","#8DD3C7","#8DD3C7","#8DD3C7","#8DD3C7","#8DD3C7","#8DD3C7","#8DD3C7","#8DD3C7","#8DD3C7","#8DD3C7","#8DD3C7","#FFFFB3","#FFFFB3","#8DD3C7","#8DD3C7","#8DD3C7","#8DD3C7","#8DD3C7","#8DD3C7","#FFFFB3","#FFFFB3","#FFFFB3","#FFFFB3","#FFFFB3","#FFFFB3","#FFFFB3","#BEBADA"],"fillOpacity":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]},["<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>D1<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>175<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Lithology<\/nobr><\/td><td align=\"right\"><nobr>limestone<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>D7<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>169<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Lithology<\/nobr><\/td><td align=\"right\"><nobr>limestone<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>D4<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>160<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Lithology<\/nobr><\/td><td align=\"right\"><nobr>limestone<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>D6<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>160<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Lithology<\/nobr><\/td><td align=\"right\"><nobr>limestone<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>D3<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>148<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Lithology<\/nobr><\/td><td align=\"right\"><nobr>limestone<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>K2<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>146<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Lithology<\/nobr><\/td><td align=\"right\"><nobr>limestone<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>K3<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>142<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Lithology<\/nobr><\/td><td align=\"right\"><nobr>limestone<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>T8<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>140<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Lithology<\/nobr><\/td><td align=\"right\"><nobr>limestone<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>T9<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>134<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Lithology<\/nobr><\/td><td align=\"right\"><nobr>limestone<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>T7<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>131<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Lithology<\/nobr><\/td><td align=\"right\"><nobr>limestone<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>D2<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>128<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Lithology<\/nobr><\/td><td align=\"right\"><nobr>limestone<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>B2<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>126<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Lithology<\/nobr><\/td><td align=\"right\"><nobr>limestone<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>B2<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>122<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Lithology<\/nobr><\/td><td align=\"right\"><nobr>limestone<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>K1<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>118<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Lithology<\/nobr><\/td><td align=\"right\"><nobr>mix<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>K4<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>110<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Lithology<\/nobr><\/td><td align=\"right\"><nobr>mix<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>W7<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>108<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Lithology<\/nobr><\/td><td align=\"right\"><nobr>limestone<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>S4<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>105<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Lithology<\/nobr><\/td><td align=\"right\"><nobr>limestone<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>D5<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>104<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Lithology<\/nobr><\/td><td align=\"right\"><nobr>limestone<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>D5<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>104<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Lithology<\/nobr><\/td><td align=\"right\"><nobr>limestone<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>F1<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>94<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Lithology<\/nobr><\/td><td align=\"right\"><nobr>limestone<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>W6<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>86<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Lithology<\/nobr><\/td><td align=\"right\"><nobr>limestone<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>T6<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>76<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Lithology<\/nobr><\/td><td align=\"right\"><nobr>mix<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>T5<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>68<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Lithology<\/nobr><\/td><td align=\"right\"><nobr>mix<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>W2<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>60<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Lithology<\/nobr><\/td><td align=\"right\"><nobr>mix<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>W8<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>58<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Lithology<\/nobr><\/td><td align=\"right\"><nobr>mix<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>T4<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>54<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Lithology<\/nobr><\/td><td align=\"right\"><nobr>mix<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>T3<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>53<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Lithology<\/nobr><\/td><td align=\"right\"><nobr>mix<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>T2<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>32<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Lithology<\/nobr><\/td><td align=\"right\"><nobr>mix<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>T1<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>5<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Lithology<\/nobr><\/td><td align=\"right\"><nobr>sandstone<\/nobr><\/td><\/tr><\/table><\/div>"],null,["D1","D7","D4","D6","D3","K2","K3","T8","T9","T7","D2","B2","B2","K1","K4","W7","S4","D5","D5","F1","W6","T6","T5","W2","W8","T4","T3","T2","T1"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null,null]},{"method":"addLegend","args":[{"colors":["#8DD3C7","#FFFFB3","#BEBADA"],"labels":["limestone","mix","sandstone"],"na_color":null,"na_label":"NA","opacity":1,"position":"topright","type":"unknown","title":"Lithology","extra":null,"layerId":"legend401","className":"info legend wChem2map","group":"wChem2map"}]},{"method":"addLayersControl","args":[[],"wChem2map",{"collapsed":true,"autoZIndex":true,"position":"topleft"}]}],"limits":{"lat":[35.04131459,35.06596295],"lng":[-86.04253228,-85.99817925]},"fitBounds":[35.04131459,-86.04253228,35.06596295,-85.99817925,[]]},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb426-1"><a href="statistical-summaries-and-tests.html#cb426-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">aov</span>(TH<span class="sc">~</span>Lithology, <span class="at">data =</span> wChemData))</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## Lithology    3  98107   32702   19.64 3.28e-09 ***
## Residuals   66 109881    1665                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb428-1"><a href="statistical-summaries-and-tests.html#cb428-1" aria-hidden="true" tabindex="-1"></a>wChemData <span class="sc">%&gt;%</span></span>
<span id="cb428-2"><a href="statistical-summaries-and-tests.html#cb428-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>TH, <span class="at">fill=</span>siteType)) <span class="sc">+</span></span>
<span id="cb428-3"><a href="statistical-summaries-and-tests.html#cb428-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>() <span class="sc">+</span></span>
<span id="cb428-4"><a href="statistical-summaries-and-tests.html#cb428-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Lithology <span class="sc">~</span> .)</span></code></pre></div>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-194-1.png" width="672" /></p>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb429-1"><a href="statistical-summaries-and-tests.html#cb429-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(raster)</span>
<span id="cb429-2"><a href="statistical-summaries-and-tests.html#cb429-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">&quot;plot&quot;</span>)</span>
<span id="cb429-3"><a href="statistical-summaries-and-tests.html#cb429-3" aria-hidden="true" tabindex="-1"></a>rasPath <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata/SinkingCove&quot;</span>,<span class="st">&quot;HillshadeSinkingCove.tif&quot;</span>,<span class="at">package=</span><span class="st">&quot;iGIScData&quot;</span>)</span>
<span id="cb429-4"><a href="statistical-summaries-and-tests.html#cb429-4" aria-hidden="true" tabindex="-1"></a>hillsh <span class="ot">&lt;-</span> <span class="fu">raster</span>(rasPath)</span>
<span id="cb429-5"><a href="statistical-summaries-and-tests.html#cb429-5" aria-hidden="true" tabindex="-1"></a>bounds <span class="ot">&lt;-</span> <span class="fu">st_bbox</span>(wChem)</span>
<span id="cb429-6"><a href="statistical-summaries-and-tests.html#cb429-6" aria-hidden="true" tabindex="-1"></a>xrange <span class="ot">&lt;-</span> bounds<span class="sc">$</span>xmax <span class="sc">-</span> bounds<span class="sc">$</span>xmin</span>
<span id="cb429-7"><a href="statistical-summaries-and-tests.html#cb429-7" aria-hidden="true" tabindex="-1"></a>yrange <span class="ot">&lt;-</span> bounds<span class="sc">$</span>ymax <span class="sc">-</span> bounds<span class="sc">$</span>ymin</span>
<span id="cb429-8"><a href="statistical-summaries-and-tests.html#cb429-8" aria-hidden="true" tabindex="-1"></a>xMIN <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(bounds<span class="sc">$</span>xmin <span class="sc">-</span> xrange<span class="sc">/</span><span class="dv">10</span>)</span>
<span id="cb429-9"><a href="statistical-summaries-and-tests.html#cb429-9" aria-hidden="true" tabindex="-1"></a>xMAX <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(bounds<span class="sc">$</span>xmax <span class="sc">+</span> xrange<span class="sc">/</span><span class="dv">10</span>)</span>
<span id="cb429-10"><a href="statistical-summaries-and-tests.html#cb429-10" aria-hidden="true" tabindex="-1"></a>yMIN <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(bounds<span class="sc">$</span>ymin <span class="sc">-</span> yrange<span class="sc">/</span><span class="dv">10</span>)</span>
<span id="cb429-11"><a href="statistical-summaries-and-tests.html#cb429-11" aria-hidden="true" tabindex="-1"></a>yMAX <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(bounds<span class="sc">$</span>ymax <span class="sc">+</span> yrange<span class="sc">/</span><span class="dv">10</span>)</span>
<span id="cb429-12"><a href="statistical-summaries-and-tests.html#cb429-12" aria-hidden="true" tabindex="-1"></a><span class="co">#st_bbox(c(xmin = 16.1, xmax = 16.6, ymax = 48.6, ymin = 47.9), crs = st_crs(4326))</span></span>
<span id="cb429-13"><a href="statistical-summaries-and-tests.html#cb429-13" aria-hidden="true" tabindex="-1"></a>newbounds <span class="ot">&lt;-</span> <span class="fu">st_bbox</span>(<span class="fu">c</span>(<span class="at">xmin=</span>xMIN, <span class="at">xmax=</span>xMAX, <span class="at">ymin=</span>yMIN, <span class="at">ymax=</span>yMAX), <span class="at">crs=</span> <span class="fu">st_crs</span>(<span class="dv">4326</span>))</span>
<span id="cb429-14"><a href="statistical-summaries-and-tests.html#cb429-14" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(hillsh,<span class="at">bbox=</span>newbounds) <span class="sc">+</span></span>
<span id="cb429-15"><a href="statistical-summaries-and-tests.html#cb429-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_raster</span>(<span class="at">palette=</span><span class="st">&quot;-Greys&quot;</span>,<span class="at">legend.show=</span>F,<span class="at">n=</span><span class="dv">20</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span> <span class="fu">tm_shape</span>(wChem) <span class="sc">+</span> </span>
<span id="cb429-16"><a href="statistical-summaries-and-tests.html#cb429-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_symbols</span>(<span class="at">size=</span><span class="st">&quot;TH&quot;</span>, <span class="at">col=</span><span class="st">&quot;Lithology&quot;</span>, <span class="at">scale=</span><span class="dv">2</span>, <span class="at">shape=</span><span class="st">&quot;siteType&quot;</span>) <span class="sc">+</span></span>
<span id="cb429-17"><a href="statistical-summaries-and-tests.html#cb429-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_legend</span>() <span class="sc">+</span></span>
<span id="cb429-18"><a href="statistical-summaries-and-tests.html#cb429-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">&quot;left&quot;</span>, <span class="st">&quot;bottom&quot;</span>)) <span class="sc">+</span></span>
<span id="cb429-19"><a href="statistical-summaries-and-tests.html#cb429-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_graticules</span>(<span class="at">lines=</span>F)</span></code></pre></div>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-195-1.png" width="672" /></p>
<p>Some observations and caveats from the above:</p>
<ul>
<li><p>There’s pretty clearly a difference between surface waters (trunk and tributary) and cave dripwaters (from stalactites) in terms of solutes. Analysis of variance simply confirms the obvious.</p></li>
<li><p>There’s also pretty clearly a difference among lithologies on the basis of solutes, not surprising since limestone is much more soluble than sandstones. Similarly, analysis of variance confirms the obvious.</p></li>
<li><p>The data may not be sufficiently normally distributed, and limestone hardness values are bimodal (largely due to the inaccessibility of waters in the trunk cave passages travelling 2 km through the Bangor limestone),<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a> though analysis of variance is less sensitive to this than a t test.</p></li>
<li><p>While shale creates springs, shale strata are very thin, with most of them in the “mix” category, or form the boundary between the two major limestone formations. Tributary streams appear to cross the shale in caves that were inaccessible for sampling. We visually confirmed this in one cave, but this exploration required some challenging rappel work to access, so we were not able to sample.
<img src = "img/CaveExploringVertical.png"></p></li>
<li><p>The geologic structure here is essentially flat, with sandstones on the plateau surface and the most massive limestones – the Bangor and Monteagle limestones – all below 400 m elevation.
<img src="img/UpperSinkingCoveGeology.png"></p></li>
<li><p>While the rapid increase in solutes happens when Cave Cove Creek starts draining through the much more soluble limestone until reaches saturation, the distance traveled by the water (reflected by a drop in elevation) can be seen:</p></li>
</ul>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb430-1"><a href="statistical-summaries-and-tests.html#cb430-1" aria-hidden="true" tabindex="-1"></a>wChemData <span class="sc">%&gt;%</span></span>
<span id="cb430-2"><a href="statistical-summaries-and-tests.html#cb430-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Elevation, <span class="at">y=</span>TH, <span class="at">col=</span>Lithology)) <span class="sc">+</span> </span>
<span id="cb430-3"><a href="statistical-summaries-and-tests.html#cb430-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb430-4"><a href="statistical-summaries-and-tests.html#cb430-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span> <span class="st">&quot;lm&quot;</span>)</span></code></pre></div>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-196-1.png" width="672" /></p>
</div>
</div>
<div id="correlation" class="section level3" number="7.3.2">
<h3><span class="header-section-number">7.3.2</span> Correlation</h3>
<p>r = Pearson’s product-moment correlation – negative or positive</p>
<p>r<sup>2</sup> = amount of variance in one variable “explained” by the other – always positive.</p>
<p>Can show with a pairs plot: <code>pairs(dataframe)</code>, but is tricky</p>
<p>Here’s an easier method from the psych package [<strong><code>sierra</code></strong>]</p>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="statistical-summaries-and-tests.html#cb431-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb431-2"><a href="statistical-summaries-and-tests.html#cb431-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs.panels</span>(sierraFeb <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(LATITUDE, LONGITUDE, ELEVATION, PRECIPITATION, TEMPERATURE))</span></code></pre></div>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-197-1.png" width="672" /></p>
</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="3">
<li id="fn3"><p>We tried very hard to get into that cave that must extend from upper Cave Cove then under Farmer Cove to a spring in Wolf Cove – we have die traces to prove it<a href="statistical-summaries-and-tests.html#fnref3" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="spatial-data-and-maps.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="modeling-in-r.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["EnvDataSci.pdf", "EnvDataSci.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
