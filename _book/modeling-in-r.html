<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>8 Modeling in R | Introduction to Environmental Data Science</title>
  <meta name="description" content="Background, concepts and exercises for using R for environmental data science. The focus is on applying the R language and various libraries for data abstraction, transformation, data analysis, spatial data/mapping, statistical modeling, and time series, applied to environmental research. Applies exploratory data analysis methods and tidyverse approaches in R, and includes contributed chapters presenting research applications, with associated data and code packages." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="8 Modeling in R | Introduction to Environmental Data Science" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Background, concepts and exercises for using R for environmental data science. The focus is on applying the R language and various libraries for data abstraction, transformation, data analysis, spatial data/mapping, statistical modeling, and time series, applied to environmental research. Applies exploratory data analysis methods and tidyverse approaches in R, and includes contributed chapters presenting research applications, with associated data and code packages." />
  <meta name="github-repo" content="iGISc/EnvDataSci" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="8 Modeling in R | Introduction to Environmental Data Science" />
  
  <meta name="twitter:description" content="Background, concepts and exercises for using R for environmental data science. The focus is on applying the R language and various libraries for data abstraction, transformation, data analysis, spatial data/mapping, statistical modeling, and time series, applied to environmental research. Applies exploratory data analysis methods and tidyverse approaches in R, and includes contributed chapters presenting research applications, with associated data and code packages." />
  



<meta name="date" content="2021-05-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="statistical-summaries-and-tests.html"/>
<link rel="next" href="time-series-visualization-analysis.html"/>
<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.2/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.18/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.3/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.3/leaflet-providers-plugin.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Environmental Data Science</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#tools-for-environmental-data-science"><i class="fa fa-check"></i><b>1.1</b> Tools for Environmental Data Science</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#big-data-data-mining-and-exploratory-data-analysis"><i class="fa fa-check"></i><b>1.2</b> Big Data, Data Mining, and Exploratory Data Analysis</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#exploratory-data-analysis"><i class="fa fa-check"></i><b>1.2.1</b> Exploratory Data Analysis</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#software-and-data-well-need"><i class="fa fa-check"></i><b>1.3</b> Software and data we’ll need</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="index.html"><a href="index.html#data"><i class="fa fa-check"></i><b>1.3.1</b> Data</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>I R for Exploratory Data Analysis</b></span></li>
<li class="chapter" data-level="2" data-path="introduction-to-r.html"><a href="introduction-to-r.html"><i class="fa fa-check"></i><b>2</b> Introduction to R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#variables"><i class="fa fa-check"></i><b>2.1</b> Variables</a></li>
<li class="chapter" data-level="2.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#functions"><i class="fa fa-check"></i><b>2.2</b> Functions</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#expressions-and-statements"><i class="fa fa-check"></i><b>2.3</b> Expressions and Statements</a></li>
<li class="chapter" data-level="2.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#data-types"><i class="fa fa-check"></i><b>2.4</b> Data Types</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#integers"><i class="fa fa-check"></i><b>2.4.1</b> Integers</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="introduction-to-r.html"><a href="introduction-to-r.html#rectangular-data"><i class="fa fa-check"></i><b>2.5</b> Rectangular data</a></li>
<li class="chapter" data-level="2.6" data-path="introduction-to-r.html"><a href="introduction-to-r.html#data-structures-in-r"><i class="fa fa-check"></i><b>2.6</b> Data Structures in R</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#vectors"><i class="fa fa-check"></i><b>2.6.1</b> Vectors</a></li>
<li class="chapter" data-level="2.6.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#lists"><i class="fa fa-check"></i><b>2.6.2</b> Lists</a></li>
<li class="chapter" data-level="2.6.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#matrices"><i class="fa fa-check"></i><b>2.6.3</b> Matrices</a></li>
<li class="chapter" data-level="2.6.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#data-frames"><i class="fa fa-check"></i><b>2.6.4</b> Data frames</a></li>
<li class="chapter" data-level="2.6.5" data-path="introduction-to-r.html"><a href="introduction-to-r.html#factors"><i class="fa fa-check"></i><b>2.6.5</b> Factors</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="introduction-to-r.html"><a href="introduction-to-r.html#programming-scripts-in-rstudio"><i class="fa fa-check"></i><b>2.7</b> Programming scripts in RStudio</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#subsetting-with-logic"><i class="fa fa-check"></i><b>2.7.1</b> Subsetting with logic</a></li>
<li class="chapter" data-level="2.7.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#apply-functions"><i class="fa fa-check"></i><b>2.7.2</b> Apply functions</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="introduction-to-r.html"><a href="introduction-to-r.html#exercises"><i class="fa fa-check"></i><b>2.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-abstraction.html"><a href="data-abstraction.html"><i class="fa fa-check"></i><b>3</b> Data Abstraction</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-abstraction.html"><a href="data-abstraction.html#background-exploratory-data-analysis"><i class="fa fa-check"></i><b>3.1</b> Background: Exploratory Data Analysis</a></li>
<li class="chapter" data-level="3.2" data-path="data-abstraction.html"><a href="data-abstraction.html#the-tidyverse-and-what-well-explore-in-this-chapter"><i class="fa fa-check"></i><b>3.2</b> The Tidyverse and what we’ll explore in this chapter</a></li>
<li class="chapter" data-level="3.3" data-path="data-abstraction.html"><a href="data-abstraction.html#tibbles"><i class="fa fa-check"></i><b>3.3</b> Tibbles</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="data-abstraction.html"><a href="data-abstraction.html#read_csv-vs.-read.csv"><i class="fa fa-check"></i><b>3.3.1</b> <code>read_csv</code> vs. <code>read.csv</code></a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="data-abstraction.html"><a href="data-abstraction.html#statistical-summary-of-variables"><i class="fa fa-check"></i><b>3.4</b> Statistical summary of variables</a></li>
<li class="chapter" data-level="3.5" data-path="data-abstraction.html"><a href="data-abstraction.html#visualizing-data-with-a-tukey-box-plot"><i class="fa fa-check"></i><b>3.5</b> Visualizing data with a Tukey box plot</a></li>
<li class="chapter" data-level="3.6" data-path="data-abstraction.html"><a href="data-abstraction.html#database-operations-with-dplyr"><i class="fa fa-check"></i><b>3.6</b> Database operations with <code>dplyr</code></a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="data-abstraction.html"><a href="data-abstraction.html#select-mutate-and-the-pipe"><i class="fa fa-check"></i><b>3.6.1</b> Select, mutate, and the pipe</a></li>
<li class="chapter" data-level="3.6.2" data-path="data-abstraction.html"><a href="data-abstraction.html#filter"><i class="fa fa-check"></i><b>3.6.2</b> filter</a></li>
<li class="chapter" data-level="3.6.3" data-path="data-abstraction.html"><a href="data-abstraction.html#writing-a-data-frame-to-a-csv"><i class="fa fa-check"></i><b>3.6.3</b> Writing a data frame to a csv</a></li>
<li class="chapter" data-level="3.6.4" data-path="data-abstraction.html"><a href="data-abstraction.html#summarize-by-group"><i class="fa fa-check"></i><b>3.6.4</b> Summarize by group</a></li>
<li class="chapter" data-level="3.6.5" data-path="data-abstraction.html"><a href="data-abstraction.html#count"><i class="fa fa-check"></i><b>3.6.5</b> Count</a></li>
<li class="chapter" data-level="3.6.6" data-path="data-abstraction.html"><a href="data-abstraction.html#sorting-after-summarizing"><i class="fa fa-check"></i><b>3.6.6</b> Sorting after summarizing</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="data-abstraction.html"><a href="data-abstraction.html#the-dot-operator"><i class="fa fa-check"></i><b>3.7</b> The dot operator</a></li>
<li class="chapter" data-level="3.8" data-path="data-abstraction.html"><a href="data-abstraction.html#exercises-1"><i class="fa fa-check"></i><b>3.8</b> Exercises</a></li>
<li class="chapter" data-level="3.9" data-path="data-abstraction.html"><a href="data-abstraction.html#string-abstraction"><i class="fa fa-check"></i><b>3.9</b> String Abstraction</a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="data-abstraction.html"><a href="data-abstraction.html#detecting-matches"><i class="fa fa-check"></i><b>3.9.1</b> Detecting matches</a></li>
<li class="chapter" data-level="3.9.2" data-path="data-abstraction.html"><a href="data-abstraction.html#subsetting-strings"><i class="fa fa-check"></i><b>3.9.2</b> Subsetting Strings</a></li>
<li class="chapter" data-level="3.9.3" data-path="data-abstraction.html"><a href="data-abstraction.html#string-length"><i class="fa fa-check"></i><b>3.9.3</b> String Length</a></li>
<li class="chapter" data-level="3.9.4" data-path="data-abstraction.html"><a href="data-abstraction.html#replacing-substrings-with-other-text-mutating-strings"><i class="fa fa-check"></i><b>3.9.4</b> Replacing substrings with other text (“mutating” strings)</a></li>
<li class="chapter" data-level="3.9.5" data-path="data-abstraction.html"><a href="data-abstraction.html#concatenating-and-splitting"><i class="fa fa-check"></i><b>3.9.5</b> Concatenating and splitting</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="data-abstraction.html"><a href="data-abstraction.html#dates-and-times-with-lubridate"><i class="fa fa-check"></i><b>3.10</b> Dates and times with <code>lubridate</code></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="visualization.html"><a href="visualization.html"><i class="fa fa-check"></i><b>4</b> Visualization</a>
<ul>
<li class="chapter" data-level="4.1" data-path="visualization.html"><a href="visualization.html#ggplot2"><i class="fa fa-check"></i><b>4.1</b> ggplot2</a></li>
<li class="chapter" data-level="4.2" data-path="visualization.html"><a href="visualization.html#plotting-one-variable"><i class="fa fa-check"></i><b>4.2</b> Plotting one variable</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="visualization.html"><a href="visualization.html#histogram"><i class="fa fa-check"></i><b>4.2.1</b> Histogram</a></li>
<li class="chapter" data-level="4.2.2" data-path="visualization.html"><a href="visualization.html#density-plot"><i class="fa fa-check"></i><b>4.2.2</b> Density Plot</a></li>
<li class="chapter" data-level="4.2.3" data-path="visualization.html"><a href="visualization.html#boxplot"><i class="fa fa-check"></i><b>4.2.3</b> boxplot</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="visualization.html"><a href="visualization.html#plotting-two-variables"><i class="fa fa-check"></i><b>4.3</b> Plotting two variables</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="visualization.html"><a href="visualization.html#two-continuous-variables"><i class="fa fa-check"></i><b>4.3.1</b> Two continuous variables</a></li>
<li class="chapter" data-level="4.3.2" data-path="visualization.html"><a href="visualization.html#two-variables-one-discrete"><i class="fa fa-check"></i><b>4.3.2</b> Two variables, one discrete</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="visualization.html"><a href="visualization.html#color-systems"><i class="fa fa-check"></i><b>4.4</b> Color systems</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="visualization.html"><a href="visualization.html#color-from-variable-in-aesthetics"><i class="fa fa-check"></i><b>4.4.1</b> Color from variable, in aesthetics</a></li>
<li class="chapter" data-level="4.4.2" data-path="visualization.html"><a href="visualization.html#trend-line"><i class="fa fa-check"></i><b>4.4.2</b> Trend line</a></li>
<li class="chapter" data-level="4.4.3" data-path="visualization.html"><a href="visualization.html#general-symbology"><i class="fa fa-check"></i><b>4.4.3</b> General symbology</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="visualization.html"><a href="visualization.html#titles-and-subtitles"><i class="fa fa-check"></i><b>4.5</b> Titles and subtitles</a></li>
<li class="chapter" data-level="4.6" data-path="visualization.html"><a href="visualization.html#pairs-plot"><i class="fa fa-check"></i><b>4.6</b> Pairs Plot</a></li>
<li class="chapter" data-level="4.7" data-path="visualization.html"><a href="visualization.html#exercises-2"><i class="fa fa-check"></i><b>4.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-transformation.html"><a href="data-transformation.html"><i class="fa fa-check"></i><b>5</b> Data Transformation</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-transformation.html"><a href="data-transformation.html#data-joins"><i class="fa fa-check"></i><b>5.1</b> Data joins</a></li>
<li class="chapter" data-level="5.2" data-path="data-transformation.html"><a href="data-transformation.html#set-operations"><i class="fa fa-check"></i><b>5.2</b> Set Operations</a></li>
<li class="chapter" data-level="5.3" data-path="data-transformation.html"><a href="data-transformation.html#binding-rows-and-columns"><i class="fa fa-check"></i><b>5.3</b> Binding Rows and Columns</a></li>
<li class="chapter" data-level="5.4" data-path="data-transformation.html"><a href="data-transformation.html#pivotting-data-frames"><i class="fa fa-check"></i><b>5.4</b> Pivotting data frames</a></li>
</ul></li>
<li class="part"><span><b>II Spatial</b></span></li>
<li class="chapter" data-level="6" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html"><i class="fa fa-check"></i><b>6</b> Spatial Data and Maps</a>
<ul>
<li class="chapter" data-level="6.1" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#spatial-data"><i class="fa fa-check"></i><b>6.1</b> Spatial Data</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#examples-of-simple-geometry-building-in-sf"><i class="fa fa-check"></i><b>6.1.1</b> Examples of simple geometry building in sf</a></li>
<li class="chapter" data-level="6.1.2" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#building-a-mappable-sfc-from-scratch"><i class="fa fa-check"></i><b>6.1.2</b> Building a mappable sfc from scratch</a></li>
<li class="chapter" data-level="6.1.3" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#creating-features-from-shapefiles-or-tables"><i class="fa fa-check"></i><b>6.1.3</b> Creating features from shapefiles or tables</a></li>
<li class="chapter" data-level="6.1.4" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#coordinate-referencing-system"><i class="fa fa-check"></i><b>6.1.4</b> Coordinate Referencing System</a></li>
<li class="chapter" data-level="6.1.5" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#spatial-join-st_join"><i class="fa fa-check"></i><b>6.1.5</b> Spatial join <code>st_join</code></a></li>
<li class="chapter" data-level="6.1.6" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#plotting-maps-in-the-base-plot-system"><i class="fa fa-check"></i><b>6.1.6</b> Plotting maps in the base plot system</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#raster-gis-in-r"><i class="fa fa-check"></i><b>6.2</b> Raster GIS in R</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#raster-from-scratch"><i class="fa fa-check"></i><b>6.2.1</b> Raster from scratch</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#ggplot2-for-maps"><i class="fa fa-check"></i><b>6.3</b> ggplot2 for maps</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#rasters-in-ggplot2"><i class="fa fa-check"></i><b>6.3.1</b> Rasters in ggplot2</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#tmap"><i class="fa fa-check"></i><b>6.4</b> tmap</a></li>
<li class="chapter" data-level="6.5" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#interactive-maps"><i class="fa fa-check"></i><b>6.5</b> Interactive Maps</a></li>
<li class="chapter" data-level="6.6" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#exercises-3"><i class="fa fa-check"></i><b>6.6</b> Exercises</a></li>
</ul></li>
<li class="part"><span><b>III Statistics &amp; Modeling</b></span></li>
<li class="chapter" data-level="7" data-path="statistical-summaries-and-tests.html"><a href="statistical-summaries-and-tests.html"><i class="fa fa-check"></i><b>7</b> Statistical Summaries and Tests</a>
<ul>
<li class="chapter" data-level="7.1" data-path="statistical-summaries-and-tests.html"><a href="statistical-summaries-and-tests.html#goals-of-statistical-analysis"><i class="fa fa-check"></i><b>7.1</b> Goals of statistical analysis</a></li>
<li class="chapter" data-level="7.2" data-path="statistical-summaries-and-tests.html"><a href="statistical-summaries-and-tests.html#summary-statistics"><i class="fa fa-check"></i><b>7.2</b> Summary Statistics</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="statistical-summaries-and-tests.html"><a href="statistical-summaries-and-tests.html#summarize-by-group-stratifying-a-summary"><i class="fa fa-check"></i><b>7.2.1</b> Summarize by group: <em>stratifying a summary</em></a></li>
<li class="chapter" data-level="7.2.2" data-path="statistical-summaries-and-tests.html"><a href="statistical-summaries-and-tests.html#boxplot-for-visualizing-distributions-by-group"><i class="fa fa-check"></i><b>7.2.2</b> Boxplot for visualizing distributions by group</a></li>
<li class="chapter" data-level="7.2.3" data-path="statistical-summaries-and-tests.html"><a href="statistical-summaries-and-tests.html#generating-pseudorandom-numbers"><i class="fa fa-check"></i><b>7.2.3</b> Generating pseudorandom numbers</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="statistical-summaries-and-tests.html"><a href="statistical-summaries-and-tests.html#statistical-tests"><i class="fa fa-check"></i><b>7.3</b> Statistical tests</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="statistical-summaries-and-tests.html"><a href="statistical-summaries-and-tests.html#comparing-samples-and-groupings"><i class="fa fa-check"></i><b>7.3.1</b> Comparing samples and groupings</a></li>
<li class="chapter" data-level="7.3.2" data-path="statistical-summaries-and-tests.html"><a href="statistical-summaries-and-tests.html#correlation"><i class="fa fa-check"></i><b>7.3.2</b> Correlation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="modeling-in-r.html"><a href="modeling-in-r.html"><i class="fa fa-check"></i><b>8</b> Modeling in R</a>
<ul>
<li class="chapter" data-level="8.1" data-path="modeling-in-r.html"><a href="modeling-in-r.html#some-common-statistical-models"><i class="fa fa-check"></i><b>8.1</b> Some common statistical models</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="modeling-in-r.html"><a href="modeling-in-r.html#analysis-of-covariance"><i class="fa fa-check"></i><b>8.1.1</b> Analysis of Covariance</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="modeling-in-r.html"><a href="modeling-in-r.html#generalized-linear-model-glm"><i class="fa fa-check"></i><b>8.2</b> Generalized Linear Model (GLM)</a></li>
<li class="chapter" data-level="8.3" data-path="modeling-in-r.html"><a href="modeling-in-r.html#models-employing-machine-learning"><i class="fa fa-check"></i><b>8.3</b> Models Employing Machine Learning</a></li>
<li class="chapter" data-level="8.4" data-path="modeling-in-r.html"><a href="modeling-in-r.html#spatial-statistical-analysis"><i class="fa fa-check"></i><b>8.4</b> Spatial Statistical Analysis</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="modeling-in-r.html"><a href="modeling-in-r.html#spatial-autocorrelation"><i class="fa fa-check"></i><b>8.4.1</b> Spatial Autocorrelation</a></li>
<li class="chapter" data-level="8.4.2" data-path="modeling-in-r.html"><a href="modeling-in-r.html#mapping-residuals"><i class="fa fa-check"></i><b>8.4.2</b> Mapping Residuals</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV Time Series</b></span></li>
<li class="chapter" data-level="9" data-path="time-series-visualization-analysis.html"><a href="time-series-visualization-analysis.html"><i class="fa fa-check"></i><b>9</b> Time Series Visualization &amp; Analysis</a>
<ul>
<li class="chapter" data-level="9.1" data-path="time-series-visualization-analysis.html"><a href="time-series-visualization-analysis.html#creation-of-time-series-ts-data"><i class="fa fa-check"></i><b>9.1</b> Creation of time series (ts) data</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="time-series-visualization-analysis.html"><a href="time-series-visualization-analysis.html#frequency-setting"><i class="fa fa-check"></i><b>9.1.1</b> frequency setting</a></li>
<li class="chapter" data-level="9.1.2" data-path="time-series-visualization-analysis.html"><a href="time-series-visualization-analysis.html#data-logger-data-from-marble-mountains-resurgence"><i class="fa fa-check"></i><b>9.1.2</b> Data logger data from Marble Mountains resurgence</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="time-series-visualization-analysis.html"><a href="time-series-visualization-analysis.html#data-smoothing-methods"><i class="fa fa-check"></i><b>9.2</b> Data smoothing methods</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="time-series-visualization-analysis.html"><a href="time-series-visualization-analysis.html#moving-average-ma"><i class="fa fa-check"></i><b>9.2.1</b> moving average (ma)</a></li>
<li class="chapter" data-level="9.2.2" data-path="time-series-visualization-analysis.html"><a href="time-series-visualization-analysis.html#loess-local-regression-smoothing"><i class="fa fa-check"></i><b>9.2.2</b> loess (local regression) smoothing</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="time-series-visualization-analysis.html"><a href="time-series-visualization-analysis.html#decomposing-time-series"><i class="fa fa-check"></i><b>9.3</b> Decomposing time series</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="time-series-visualization-analysis.html"><a href="time-series-visualization-analysis.html#lag-regression"><i class="fa fa-check"></i><b>9.3.1</b> lag regression</a></li>
<li class="chapter" data-level="9.3.2" data-path="time-series-visualization-analysis.html"><a href="time-series-visualization-analysis.html#ensemble-average"><i class="fa fa-check"></i><b>9.3.2</b> Ensemble Average</a></li>
<li class="chapter" data-level="9.3.3" data-path="time-series-visualization-analysis.html"><a href="time-series-visualization-analysis.html#julian-dates"><i class="fa fa-check"></i><b>9.3.3</b> Julian Dates</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="time-series-visualization-analysis.html"><a href="time-series-visualization-analysis.html#learning-more-about-time-series-in-r"><i class="fa fa-check"></i><b>9.4</b> Learning more about time series in R</a></li>
</ul></li>
<li class="part"><span><b>V Communication &amp; Special Topics</b></span></li>
<li class="chapter" data-level="10" data-path="communication.html"><a href="communication.html"><i class="fa fa-check"></i><b>10</b> Communication</a></li>
<li class="chapter" data-level="" data-path="appendix-building-a-data-package-for-github.html"><a href="appendix-building-a-data-package-for-github.html"><i class="fa fa-check"></i>Appendix: Building a Data Package for GitHub</a>
<ul>
<li><a href="appendix-building-a-data-package-for-github.html#rda-files"><code>rda</code> files</a>
<ul>
<li><a href="appendix-building-a-data-package-for-github.html#usethisuse_data"><code>usethis::use_data()</code></a></li>
<li><a href="appendix-building-a-data-package-for-github.html#usethiscreate_package"><code>usethis::create_package()</code></a></li>
<li><a href="appendix-building-a-data-package-for-github.html#devtoolsdocument"><code>devtools::document()</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix-building-a-data-package-for-github.html"><a href="appendix-building-a-data-package-for-github.html#raw-data"><i class="fa fa-check"></i>Raw data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to Environmental Data Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="modeling-in-r" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Modeling in R</h1>
<p><em>under construction</em></p>
<div id="some-common-statistical-models" class="section level2" number="8.1">
<h2><span class="header-section-number">8.1</span> Some common statistical models</h2>
<ul>
<li><code>lm(y ~ x)</code> linear regression</li>
<li><code>lm(y ~ x1 + x2 + x3)</code> multiple regression</li>
<li><code>glm(y ~ x, family = poisson)</code> generalized linear model, poisson distribution;
see ?family to see those supported, including binomial, gaussian, poisson, etc.</li>
<li><code>aov(y ~ x)</code> analysis of variance (same as lm except in the summary)</li>
<li>gam(y ~ x) generalized additive models</li>
<li>tree(y ~ x) or rpart(y ~ x) regression/classification trees</li>
</ul>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb428-1"><a href="modeling-in-r.html#cb428-1" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(TEMPERATURE <span class="sc">~</span> ELEVATION, <span class="at">data =</span> sierraFeb)</span>
<span id="cb428-2"><a href="modeling-in-r.html#cb428-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = TEMPERATURE ~ ELEVATION, data = sierraFeb)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -2.9126 -1.0466 -0.0027  0.7940  4.5327 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 11.8813804  0.3825302   31.06   &lt;2e-16 ***
## ELEVATION   -0.0061018  0.0002968  -20.56   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.533 on 60 degrees of freedom
## Multiple R-squared:  0.8757, Adjusted R-squared:  0.8736 
## F-statistic: 422.6 on 1 and 60 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Probably the most important statistic is the p value for the predictor variable ELEVATION, which in this case is very small &lt;2e-16.</p>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-194-1.png" width="672" /></p>
<pre><code>## 
## Call:
## lm(formula = TEMPERATURE ~ ELEVATION, data = sierraFeb)
## 
## Coefficients:
## (Intercept)    ELEVATION  
##   11.881380    -0.006102</code></pre>
<p><strong>Making Predictions</strong></p>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="modeling-in-r.html#cb431-1" aria-hidden="true" tabindex="-1"></a>eqn</span></code></pre></div>
<pre><code>## [1] &quot;temperature = 11.88 + -0.006*elevation + e&quot;</code></pre>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb433-1"><a href="modeling-in-r.html#cb433-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> model1<span class="sc">$</span>coefficients[<span class="dv">1</span>]</span>
<span id="cb433-2"><a href="modeling-in-r.html#cb433-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> model1<span class="sc">$</span>coefficients[<span class="dv">2</span>]</span>
<span id="cb433-3"><a href="modeling-in-r.html#cb433-3" aria-hidden="true" tabindex="-1"></a>elevations <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">500</span>, <span class="dv">1000</span>, <span class="dv">1500</span>, <span class="dv">2000</span>)</span>
<span id="cb433-4"><a href="modeling-in-r.html#cb433-4" aria-hidden="true" tabindex="-1"></a>elevations</span></code></pre></div>
<pre><code>## [1]  500 1000 1500 2000</code></pre>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb435-1"><a href="modeling-in-r.html#cb435-1" aria-hidden="true" tabindex="-1"></a>tempEstimate <span class="ot">&lt;-</span> a <span class="sc">+</span> b <span class="sc">*</span> elevations</span>
<span id="cb435-2"><a href="modeling-in-r.html#cb435-2" aria-hidden="true" tabindex="-1"></a>tempEstimate</span></code></pre></div>
<pre><code>## [1]  8.8304692  5.7795580  2.7286468 -0.3222645</code></pre>
<div id="analysis-of-covariance" class="section level3" number="8.1.1">
<h3><span class="header-section-number">8.1.1</span> Analysis of Covariance</h3>
<p>Same purpose as Analysis of Variance, but also takes into account the influence of other variables called covariates. In a way, combines a linear model with an analysis of variance.</p>
<p><em>“Are water samples from streams draining sandstone, limestone, and shale different based on pH, while taking into account elevation?”</em></p>
<p>Response variable is modeled from the factor (ANOVA) plus the covariate (regression)</p>
<ul>
<li>ANOVA: pH ~ rocktype</li>
<li>Regression: pH ~ elevation</li>
<li>ANCOVA: pH ~ rocktype + elevation
<ul>
<li>Yet shouldn’t involve interaction between rocktype and elevation</li>
</ul></li>
</ul>
<p><strong>Example: stream types distinguished by discharge and slope</strong></p>
<p>Three common river types are meandering, braided and anastomosed. For each, their slope
varies by bankfull discharge in a relationship that looks something like:</p>
<p><img src="img/SbyQ_rivers.png"></p>
<p><img src="img/braided.png" alt="braided">
<img src="img/meandering.png" alt="meandering">
<img src="img/anastomosed.png" alt="anastomosed"></p>
<p>No interaction between covariate and factor</p>
<ul>
<li>No relationship between discharge and channel type.<br />
</li>
<li>Another interpretation: the slope of the relationship between the covariate and response variable is about the same for each group; only the intercept differs. Assumes parallel slopes.</li>
</ul>
<p><code>log10(S) ~ strtype * log10(Q)</code> … interaction between covariate and factor</p>
<p><code>log10(S) ~ strtype + log10(Q)</code> … no interaction, parallel slopes</p>
<p>If models are not significantly different, remove interaction term due to parsimony, and satisfies this ANCOVA requirement.</p>
<div class="sourceCode" id="cb437"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb437-1"><a href="modeling-in-r.html#cb437-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb437-2"><a href="modeling-in-r.html#cb437-2" aria-hidden="true" tabindex="-1"></a>csvPath <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>,<span class="st">&quot;streams.csv&quot;</span>, <span class="at">package=</span><span class="st">&quot;iGIScData&quot;</span>)</span>
<span id="cb437-3"><a href="modeling-in-r.html#cb437-3" aria-hidden="true" tabindex="-1"></a>streams <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(csvPath)</span>
<span id="cb437-4"><a href="modeling-in-r.html#cb437-4" aria-hidden="true" tabindex="-1"></a>streams<span class="sc">$</span>strtype <span class="ot">&lt;-</span> <span class="fu">factor</span>(streams<span class="sc">$</span>type, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;Anastomosing&quot;</span>,<span class="st">&quot;Braided&quot;</span>,<span class="st">&quot;Meandering&quot;</span>))</span>
<span id="cb437-5"><a href="modeling-in-r.html#cb437-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(streams)</span></code></pre></div>
<pre><code>##      type                 Q                S                    strtype  
##  Length:41          Min.   :     6   Min.   :0.000011   Anastomosing: 8  
##  Class :character   1st Qu.:    15   1st Qu.:0.000100   Braided     :12  
##  Mode  :character   Median :    40   Median :0.000700   Meandering  :21  
##                     Mean   :  4159   Mean   :0.001737                    
##                     3rd Qu.:   550   3rd Qu.:0.002800                    
##                     Max.   :100000   Max.   :0.009500</code></pre>
<div class="sourceCode" id="cb439"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb439-1"><a href="modeling-in-r.html#cb439-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(streams, <span class="fu">aes</span>(Q, S, <span class="at">color=</span>strtype)) <span class="sc">+</span></span>
<span id="cb439-2"><a href="modeling-in-r.html#cb439-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-196-1.png" width="672" /></p>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb440-1"><a href="modeling-in-r.html#cb440-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales) <span class="co"># needed for the trans_format function below</span></span>
<span id="cb440-2"><a href="modeling-in-r.html#cb440-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(streams, <span class="fu">aes</span>(Q, S, <span class="at">color=</span>strtype)) <span class="sc">+</span></span>
<span id="cb440-3"><a href="modeling-in-r.html#cb440-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb440-4"><a href="modeling-in-r.html#cb440-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="fu">log10_trans</span>(),</span>
<span id="cb440-5"><a href="modeling-in-r.html#cb440-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">trans_format</span>(<span class="st">&quot;log10&quot;</span>, <span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x))) <span class="sc">+</span></span>
<span id="cb440-6"><a href="modeling-in-r.html#cb440-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">trans=</span><span class="fu">log10_trans</span>(),</span>
<span id="cb440-7"><a href="modeling-in-r.html#cb440-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">trans_format</span>(<span class="st">&quot;log10&quot;</span>, <span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x)))</span></code></pre></div>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-196-2.png" width="672" /></p>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb441-1"><a href="modeling-in-r.html#cb441-1" aria-hidden="true" tabindex="-1"></a>ancova <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log10</span>(S)<span class="sc">~</span>strtype<span class="sc">*</span><span class="fu">log10</span>(Q), <span class="at">data=</span>streams)</span>
<span id="cb441-2"><a href="modeling-in-r.html#cb441-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ancova)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = log10(S) ~ strtype * log10(Q), data = streams)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.63636 -0.13903 -0.00032  0.12652  0.60750 
## 
## Coefficients:
##                            Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                -3.91819    0.31094 -12.601 1.45e-14 ***
## strtypeBraided              2.20085    0.35383   6.220 3.96e-07 ***
## strtypeMeandering           1.63479    0.33153   4.931 1.98e-05 ***
## log10(Q)                   -0.43537    0.18073  -2.409   0.0214 *  
## strtypeBraided:log10(Q)    -0.01488    0.19102  -0.078   0.9384    
## strtypeMeandering:log10(Q)  0.05183    0.18748   0.276   0.7838    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.2656 on 35 degrees of freedom
## Multiple R-squared:  0.9154, Adjusted R-squared:  0.9033 
## F-statistic: 75.73 on 5 and 35 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb443-1"><a href="modeling-in-r.html#cb443-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(ancova)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: log10(S)
##                  Df  Sum Sq Mean Sq  F value    Pr(&gt;F)    
## strtype           2 18.3914  9.1957 130.3650 &lt; 2.2e-16 ***
## log10(Q)          1  8.2658  8.2658 117.1821 1.023e-12 ***
## strtype:log10(Q)  2  0.0511  0.0255   0.3619    0.6989    
## Residuals        35  2.4688  0.0705                       
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb445-1"><a href="modeling-in-r.html#cb445-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Now an additive model, which does not have that interaction</span></span>
<span id="cb445-2"><a href="modeling-in-r.html#cb445-2" aria-hidden="true" tabindex="-1"></a>ancova2 <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log10</span>(S)<span class="sc">~</span>strtype<span class="sc">+</span><span class="fu">log10</span>(Q), <span class="at">data=</span>streams)</span>
<span id="cb445-3"><a href="modeling-in-r.html#cb445-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(ancova2)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: log10(S)
##           Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
## strtype    2 18.3914  9.1957  135.02 &lt; 2.2e-16 ***
## log10(Q)   1  8.2658  8.2658  121.37  3.07e-13 ***
## Residuals 37  2.5199  0.0681                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb447-1"><a href="modeling-in-r.html#cb447-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(ancova,ancova2)   </span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Model 1: log10(S) ~ strtype * log10(Q)
## Model 2: log10(S) ~ strtype + log10(Q)
##   Res.Df    RSS Df Sum of Sq      F Pr(&gt;F)
## 1     35 2.4688                           
## 2     37 2.5199 -2 -0.051051 0.3619 0.6989</code></pre>
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb449-1"><a href="modeling-in-r.html#cb449-1" aria-hidden="true" tabindex="-1"></a>   <span class="co"># not significantly different, so model simplification is justified</span></span>
<span id="cb449-2"><a href="modeling-in-r.html#cb449-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb449-3"><a href="modeling-in-r.html#cb449-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Now we remove the strtype term</span></span>
<span id="cb449-4"><a href="modeling-in-r.html#cb449-4" aria-hidden="true" tabindex="-1"></a>ancova3 <span class="ot">=</span> <span class="fu">update</span>(ancova2, <span class="sc">~</span> . <span class="sc">-</span> strtype)  </span>
<span id="cb449-5"><a href="modeling-in-r.html#cb449-5" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(ancova2,ancova3)  </span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Model 1: log10(S) ~ strtype + log10(Q)
## Model 2: log10(S) ~ log10(Q)
##   Res.Df     RSS Df Sum of Sq      F    Pr(&gt;F)    
## 1     37  2.5199                                  
## 2     39 25.5099 -2    -22.99 168.78 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb451-1"><a href="modeling-in-r.html#cb451-1" aria-hidden="true" tabindex="-1"></a>   <span class="co"># Goes too far.  Removing the strtype creates a significantly different model</span></span>
<span id="cb451-2"><a href="modeling-in-r.html#cb451-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb451-3"><a href="modeling-in-r.html#cb451-3" aria-hidden="true" tabindex="-1"></a><span class="fu">step</span>(ancova)</span></code></pre></div>
<pre><code>## Start:  AIC=-103.2
## log10(S) ~ strtype * log10(Q)
## 
##                    Df Sum of Sq    RSS     AIC
## - strtype:log10(Q)  2  0.051051 2.5199 -106.36
## &lt;none&gt;                          2.4688 -103.20
## 
## Step:  AIC=-106.36
## log10(S) ~ strtype + log10(Q)
## 
##            Df Sum of Sq     RSS      AIC
## &lt;none&gt;                   2.5199 -106.364
## - log10(Q)  1    8.2658 10.7857  -48.750
## - strtype   2   22.9901 25.5099  -15.455</code></pre>
<pre><code>## 
## Call:
## lm(formula = log10(S) ~ strtype + log10(Q), data = streams)
## 
## Coefficients:
##       (Intercept)     strtypeBraided  strtypeMeandering           log10(Q)  
##           -3.9583             2.1453             1.7294            -0.4109</code></pre>
<p><strong>Part of general linear model (lm)</strong></p>
<p>ANOVA &amp; ANCOVA are applications of a general linear model.</p>
<ul>
<li>Uses lm in R</li>
<li>Response variable is continuous, assumed normally distributed</li>
</ul>
<p><em>Not the same as Generalized Linear Model (GLM)</em></p>
<ul>
<li><em>With GLM, response variable may be from count data (e.g. Poisson), probabilities of occurrence (logistic regression) or other non-normal distributions.</em></li>
</ul>
<p><code>mymodel = lm(log10(s) ~ strtype + log10(Q))</code></p>
<ul>
<li>The linear model, with categorical explanatory variable + covariate</li>
</ul>
<p><code>anova(mymodel)</code></p>
<ul>
<li>Displays the Analysis of Variance table from the linear model</li>
</ul>
</div>
</div>
<div id="generalized-linear-model-glm" class="section level2" number="8.2">
<h2><span class="header-section-number">8.2</span> Generalized Linear Model (GLM)</h2>
<p>The glm in R allows you to work with various types of data using various distributions, described as families such as:</p>
<ul>
<li>gaussian : normal distribution – what is used with lm</li>
<li>binomial : logit – used with probabilities.
<ul>
<li>Used for <em>logistic regression</em></li>
</ul></li>
<li>poisson : for counts. Commonly used for species counts.</li>
<li>see help(glm) for other examples</li>
</ul>
<p>Great explanation of poisson distribution using meteor showers at:</p>
<p><a href="https://towardsdatascience.com/the-poisson-distribution-and-poisson-process-explained-4e2cb17d459">https://towardsdatascience.com/the-poisson-distribution-and-poisson-process-explained-4e2cb17d459</a></p>
</div>
<div id="models-employing-machine-learning" class="section level2" number="8.3">
<h2><span class="header-section-number">8.3</span> Models Employing Machine Learning</h2>
<p><em>under construction, to include neural network model of environmental data</em></p>
</div>
<div id="spatial-statistical-analysis" class="section level2" number="8.4">
<h2><span class="header-section-number">8.4</span> Spatial Statistical Analysis</h2>
<p>Spatial statistical analysis brings in the spatial dimension to a statistical analysis,
ranging from visual analysis of patterns to specialized spatial statistical methods.
There are many applications for these methods in environmental research, since
spatial patterns are generally highly relevant. We might ask:</p>
<ul>
<li>What patterns can we see?</li>
<li>What is the effect of scale?</li>
<li>Relationships among variables – do they vary spatially?</li>
</ul>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-197-1.png" width="672" /></p>
<div id="spatial-autocorrelation" class="section level3" number="8.4.1">
<h3><span class="header-section-number">8.4.1</span> Spatial Autocorrelation</h3>
<p>[Need to add a Moran’s I section here]</p>
</div>
<div id="mapping-residuals" class="section level3" number="8.4.2">
<h3><span class="header-section-number">8.4.2</span> Mapping Residuals</h3>
<p>If the <em>residuals</em> from regression are spatially autocorrelated, look for patterns in the residuals to find other explanatory variables.</p>
<div class="sourceCode" id="cb454"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb454-1"><a href="modeling-in-r.html#cb454-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb454-2"><a href="modeling-in-r.html#cb454-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(iGIScData)</span>
<span id="cb454-3"><a href="modeling-in-r.html#cb454-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf); <span class="fu">library</span>(raster)</span>
<span id="cb454-4"><a href="modeling-in-r.html#cb454-4" aria-hidden="true" tabindex="-1"></a>rasPath <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;ca_hillsh_WGS84.tif&quot;</span>, <span class="at">package=</span><span class="st">&quot;iGIScData&quot;</span>)</span>
<span id="cb454-5"><a href="modeling-in-r.html#cb454-5" aria-hidden="true" tabindex="-1"></a>hillsh <span class="ot">&lt;-</span> <span class="fu">raster</span>(rasPath)</span>
<span id="cb454-6"><a href="modeling-in-r.html#cb454-6" aria-hidden="true" tabindex="-1"></a>hillshpts <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">rasterToPoints</span>(hillsh))</span>
<span id="cb454-7"><a href="modeling-in-r.html#cb454-7" aria-hidden="true" tabindex="-1"></a>CAbasemap <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb454-8"><a href="modeling-in-r.html#cb454-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_raster</span>(<span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">fill=</span>ca_hillsh_WGS84), hillshpts) <span class="sc">+</span> <span class="fu">guides</span>(<span class="at">fill=</span>F) <span class="sc">+</span></span>
<span id="cb454-9"><a href="modeling-in-r.html#cb454-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data=</span>CA_counties, <span class="at">fill=</span><span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb454-10"><a href="modeling-in-r.html#cb454-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">&quot;#606060&quot;</span>, <span class="at">high =</span> <span class="st">&quot;#FFFFFF&quot;</span>) <span class="sc">+</span></span>
<span id="cb454-11"><a href="modeling-in-r.html#cb454-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&#39;&#39;</span>, <span class="at">y=</span><span class="st">&#39;&#39;</span>)</span>
<span id="cb454-12"><a href="modeling-in-r.html#cb454-12" aria-hidden="true" tabindex="-1"></a>sierra <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(<span class="fu">filter</span>(sierraFeb, <span class="sc">!</span><span class="fu">is.na</span>(TEMPERATURE)), <span class="at">coords=</span><span class="fu">c</span>(<span class="st">&quot;LONGITUDE&quot;</span>, <span class="st">&quot;LATITUDE&quot;</span>), <span class="at">crs=</span><span class="dv">4326</span>)</span>
<span id="cb454-13"><a href="modeling-in-r.html#cb454-13" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(TEMPERATURE <span class="sc">~</span> ELEVATION, <span class="at">data =</span> sierra)</span>
<span id="cb454-14"><a href="modeling-in-r.html#cb454-14" aria-hidden="true" tabindex="-1"></a>cc <span class="ot">&lt;-</span> model1<span class="sc">$</span>coefficients</span>
<span id="cb454-15"><a href="modeling-in-r.html#cb454-15" aria-hidden="true" tabindex="-1"></a>sierra<span class="sc">$</span>resid <span class="ot">&lt;-</span> <span class="fu">resid</span>(model1)</span>
<span id="cb454-16"><a href="modeling-in-r.html#cb454-16" aria-hidden="true" tabindex="-1"></a>sierra<span class="sc">$</span>predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(model1) </span>
<span id="cb454-17"><a href="modeling-in-r.html#cb454-17" aria-hidden="true" tabindex="-1"></a>eqn <span class="ot">=</span> <span class="fu">paste</span>(<span class="st">&quot;temperature =&quot;</span>, <span class="fu">paste</span>(<span class="fu">round</span>(cc[<span class="dv">1</span>],<span class="dv">2</span>), <span class="fu">paste</span>(<span class="fu">round</span>(cc[<span class="sc">-</span><span class="dv">1</span>], <span class="at">digits=</span><span class="dv">3</span>), <span class="at">sep=</span><span class="st">&quot;*&quot;</span>, <span class="at">collapse=</span><span class="st">&quot; + &quot;</span>, <span class="fu">paste</span>(<span class="st">&quot;elevation&quot;</span>)), <span class="at">sep=</span><span class="st">&quot; + &quot;</span>), <span class="st">&quot;+ e&quot;</span>)</span>
<span id="cb454-18"><a href="modeling-in-r.html#cb454-18" aria-hidden="true" tabindex="-1"></a>ct <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>,<span class="st">&quot;CA_places.shp&quot;</span>,<span class="at">package=</span><span class="st">&quot;iGIScData&quot;</span>))</span>
<span id="cb454-19"><a href="modeling-in-r.html#cb454-19" aria-hidden="true" tabindex="-1"></a>ct<span class="sc">$</span>AREANAME_pad <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">str_replace_all</span>(ct<span class="sc">$</span>AREANAME, <span class="st">&#39;[A-Za-z]&#39;</span>,<span class="st">&#39; &#39;</span>), ct<span class="sc">$</span>AREANAME)</span>
<span id="cb454-20"><a href="modeling-in-r.html#cb454-20" aria-hidden="true" tabindex="-1"></a>bounds <span class="ot">&lt;-</span> <span class="fu">st_bbox</span>(sierra)</span>
<span id="cb454-21"><a href="modeling-in-r.html#cb454-21" aria-hidden="true" tabindex="-1"></a>sierrabasemap <span class="ot">&lt;-</span> CAbasemap <span class="sc">+</span> </span>
<span id="cb454-22"><a href="modeling-in-r.html#cb454-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data=</span>ct) <span class="sc">+</span></span>
<span id="cb454-23"><a href="modeling-in-r.html#cb454-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf_text</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">label=</span>AREANAME_pad), <span class="at">data=</span>ct, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">nudge_x =</span> <span class="fl">0.1</span>, <span class="at">nudge_y =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb454-24"><a href="modeling-in-r.html#cb454-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_sf</span>(<span class="at">xlim =</span> <span class="fu">c</span>(bounds[<span class="dv">1</span>], bounds[<span class="dv">3</span>]), <span class="at">ylim =</span> <span class="fu">c</span>(bounds[<span class="dv">2</span>],bounds[<span class="dv">4</span>]))</span>
<span id="cb454-25"><a href="modeling-in-r.html#cb454-25" aria-hidden="true" tabindex="-1"></a>sierrabasemap <span class="sc">+</span></span>
<span id="cb454-26"><a href="modeling-in-r.html#cb454-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">color =</span> resid), <span class="at">alpha=</span><span class="fl">0.7</span>, <span class="at">data=</span>sierra, <span class="at">size=</span><span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb454-27"><a href="modeling-in-r.html#cb454-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gradient2</span>(<span class="at">low=</span><span class="st">&quot;blue&quot;</span>, <span class="at">mid=</span><span class="st">&quot;ivory2&quot;</span>, <span class="at">high=</span><span class="st">&quot;red&quot;</span>, </span>
<span id="cb454-28"><a href="modeling-in-r.html#cb454-28" aria-hidden="true" tabindex="-1"></a>                        <span class="at">midpoint=</span><span class="fu">mean</span>(sierra<span class="sc">$</span>resid)) <span class="sc">+</span></span>
<span id="cb454-29"><a href="modeling-in-r.html#cb454-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_sf</span>(<span class="at">xlim =</span> <span class="fu">c</span>(bounds[<span class="dv">1</span>], bounds[<span class="dv">3</span>]), <span class="at">ylim =</span> <span class="fu">c</span>(bounds[<span class="dv">2</span>],bounds[<span class="dv">4</span>]))  <span class="sc">+</span></span>
<span id="cb454-30"><a href="modeling-in-r.html#cb454-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Residuals&quot;</span>, <span class="at">subtitle=</span>eqn) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.85</span>)) <span class="sc">+</span> </span>
<span id="cb454-31"><a href="modeling-in-r.html#cb454-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&#39;cm&#39;</span>), </span>
<span id="cb454-32"><a href="modeling-in-r.html#cb454-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>))</span></code></pre></div>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-198-1.png" width="672" /></p>

</div>
</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="statistical-summaries-and-tests.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="time-series-visualization-analysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["EnvDataSci.pdf", "EnvDataSci.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
