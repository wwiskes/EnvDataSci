<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Data Transformation | Introduction to Environmental Data Science</title>
  <meta name="description" content="Background, concepts and exercises for using R for environmental data science. The focus is on applying the R language and various libraries for data abstraction, transformation, data analysis, spatial data/mapping, statistical modeling, and time series, applied to environmental research. Applies exploratory data analysis methods and tidyverse approaches in R, and includes contributed chapters presenting research applications, with associated data and code packages." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Data Transformation | Introduction to Environmental Data Science" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Background, concepts and exercises for using R for environmental data science. The focus is on applying the R language and various libraries for data abstraction, transformation, data analysis, spatial data/mapping, statistical modeling, and time series, applied to environmental research. Applies exploratory data analysis methods and tidyverse approaches in R, and includes contributed chapters presenting research applications, with associated data and code packages." />
  <meta name="github-repo" content="iGISc/EnvDataSci" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Data Transformation | Introduction to Environmental Data Science" />
  
  <meta name="twitter:description" content="Background, concepts and exercises for using R for environmental data science. The focus is on applying the R language and various libraries for data abstraction, transformation, data analysis, spatial data/mapping, statistical modeling, and time series, applied to environmental research. Applies exploratory data analysis methods and tidyverse approaches in R, and includes contributed chapters presenting research applications, with associated data and code packages." />
  



<meta name="date" content="2021-05-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="visualization.html"/>
<link rel="next" href="spatial-data-and-maps.html"/>
<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.2/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.3/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.3/leaflet-providers-plugin.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Environmental Data Science</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#tools-for-environmental-data-science"><i class="fa fa-check"></i><b>1.1</b> Tools for Environmental Data Science</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#big-data-data-mining-and-exploratory-data-analysis"><i class="fa fa-check"></i><b>1.2</b> Big Data, Data Mining, and Exploratory Data Analysis</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#exploratory-data-analysis"><i class="fa fa-check"></i><b>1.2.1</b> Exploratory Data Analysis</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#software-and-data-well-need"><i class="fa fa-check"></i><b>1.3</b> Software and data we’ll need</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="index.html"><a href="index.html#data"><i class="fa fa-check"></i><b>1.3.1</b> Data</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>I R for Exploratory Data Analysis</b></span></li>
<li class="chapter" data-level="2" data-path="introduction-to-r.html"><a href="introduction-to-r.html"><i class="fa fa-check"></i><b>2</b> Introduction to R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#variables"><i class="fa fa-check"></i><b>2.1</b> Variables</a></li>
<li class="chapter" data-level="2.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#functions"><i class="fa fa-check"></i><b>2.2</b> Functions</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#expressions-and-statements"><i class="fa fa-check"></i><b>2.3</b> Expressions and Statements</a></li>
<li class="chapter" data-level="2.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#data-types"><i class="fa fa-check"></i><b>2.4</b> Data Types</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#integers"><i class="fa fa-check"></i><b>2.4.1</b> Integers</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="introduction-to-r.html"><a href="introduction-to-r.html#rectangular-data"><i class="fa fa-check"></i><b>2.5</b> Rectangular data</a></li>
<li class="chapter" data-level="2.6" data-path="introduction-to-r.html"><a href="introduction-to-r.html#data-structures-in-r"><i class="fa fa-check"></i><b>2.6</b> Data Structures in R</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#vectors"><i class="fa fa-check"></i><b>2.6.1</b> Vectors</a></li>
<li class="chapter" data-level="2.6.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#lists"><i class="fa fa-check"></i><b>2.6.2</b> Lists</a></li>
<li class="chapter" data-level="2.6.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#matrices"><i class="fa fa-check"></i><b>2.6.3</b> Matrices</a></li>
<li class="chapter" data-level="2.6.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#data-frames"><i class="fa fa-check"></i><b>2.6.4</b> Data frames</a></li>
<li class="chapter" data-level="2.6.5" data-path="introduction-to-r.html"><a href="introduction-to-r.html#factors"><i class="fa fa-check"></i><b>2.6.5</b> Factors</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="introduction-to-r.html"><a href="introduction-to-r.html#programming-scripts-in-rstudio"><i class="fa fa-check"></i><b>2.7</b> Programming scripts in RStudio</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#subsetting-with-logic"><i class="fa fa-check"></i><b>2.7.1</b> Subsetting with logic</a></li>
<li class="chapter" data-level="2.7.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#apply-functions"><i class="fa fa-check"></i><b>2.7.2</b> Apply functions</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="introduction-to-r.html"><a href="introduction-to-r.html#exercises"><i class="fa fa-check"></i><b>2.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-abstraction.html"><a href="data-abstraction.html"><i class="fa fa-check"></i><b>3</b> Data Abstraction</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-abstraction.html"><a href="data-abstraction.html#background-exploratory-data-analysis"><i class="fa fa-check"></i><b>3.1</b> Background: Exploratory Data Analysis</a></li>
<li class="chapter" data-level="3.2" data-path="data-abstraction.html"><a href="data-abstraction.html#the-tidyverse-and-what-well-explore-in-this-chapter"><i class="fa fa-check"></i><b>3.2</b> The Tidyverse and what we’ll explore in this chapter</a></li>
<li class="chapter" data-level="3.3" data-path="data-abstraction.html"><a href="data-abstraction.html#tibbles"><i class="fa fa-check"></i><b>3.3</b> Tibbles</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="data-abstraction.html"><a href="data-abstraction.html#read_csv-vs.-read.csv"><i class="fa fa-check"></i><b>3.3.1</b> <code>read_csv</code> vs. <code>read.csv</code></a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="data-abstraction.html"><a href="data-abstraction.html#statistical-summary-of-variables"><i class="fa fa-check"></i><b>3.4</b> Statistical summary of variables</a></li>
<li class="chapter" data-level="3.5" data-path="data-abstraction.html"><a href="data-abstraction.html#visualizing-data-with-a-tukey-box-plot"><i class="fa fa-check"></i><b>3.5</b> Visualizing data with a Tukey box plot</a></li>
<li class="chapter" data-level="3.6" data-path="data-abstraction.html"><a href="data-abstraction.html#database-operations-with-dplyr"><i class="fa fa-check"></i><b>3.6</b> Database operations with <code>dplyr</code></a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="data-abstraction.html"><a href="data-abstraction.html#select-mutate-and-the-pipe"><i class="fa fa-check"></i><b>3.6.1</b> Select, mutate, and the pipe</a></li>
<li class="chapter" data-level="3.6.2" data-path="data-abstraction.html"><a href="data-abstraction.html#filter"><i class="fa fa-check"></i><b>3.6.2</b> filter</a></li>
<li class="chapter" data-level="3.6.3" data-path="data-abstraction.html"><a href="data-abstraction.html#writing-a-data-frame-to-a-csv"><i class="fa fa-check"></i><b>3.6.3</b> Writing a data frame to a csv</a></li>
<li class="chapter" data-level="3.6.4" data-path="data-abstraction.html"><a href="data-abstraction.html#summarize-by-group"><i class="fa fa-check"></i><b>3.6.4</b> Summarize by group</a></li>
<li class="chapter" data-level="3.6.5" data-path="data-abstraction.html"><a href="data-abstraction.html#count"><i class="fa fa-check"></i><b>3.6.5</b> Count</a></li>
<li class="chapter" data-level="3.6.6" data-path="data-abstraction.html"><a href="data-abstraction.html#sorting-after-summarizing"><i class="fa fa-check"></i><b>3.6.6</b> Sorting after summarizing</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="data-abstraction.html"><a href="data-abstraction.html#the-dot-operator"><i class="fa fa-check"></i><b>3.7</b> The dot operator</a></li>
<li class="chapter" data-level="3.8" data-path="data-abstraction.html"><a href="data-abstraction.html#exercises-1"><i class="fa fa-check"></i><b>3.8</b> Exercises</a></li>
<li class="chapter" data-level="3.9" data-path="data-abstraction.html"><a href="data-abstraction.html#string-abstraction"><i class="fa fa-check"></i><b>3.9</b> String Abstraction</a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="data-abstraction.html"><a href="data-abstraction.html#detecting-matches"><i class="fa fa-check"></i><b>3.9.1</b> Detecting matches</a></li>
<li class="chapter" data-level="3.9.2" data-path="data-abstraction.html"><a href="data-abstraction.html#subsetting-strings"><i class="fa fa-check"></i><b>3.9.2</b> Subsetting Strings</a></li>
<li class="chapter" data-level="3.9.3" data-path="data-abstraction.html"><a href="data-abstraction.html#string-length"><i class="fa fa-check"></i><b>3.9.3</b> String Length</a></li>
<li class="chapter" data-level="3.9.4" data-path="data-abstraction.html"><a href="data-abstraction.html#replacing-substrings-with-other-text-mutating-strings"><i class="fa fa-check"></i><b>3.9.4</b> Replacing substrings with other text (“mutating” strings)</a></li>
<li class="chapter" data-level="3.9.5" data-path="data-abstraction.html"><a href="data-abstraction.html#concatenating-and-splitting"><i class="fa fa-check"></i><b>3.9.5</b> Concatenating and splitting</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="data-abstraction.html"><a href="data-abstraction.html#dates-and-times-with-lubridate"><i class="fa fa-check"></i><b>3.10</b> Dates and times with <code>lubridate</code></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="visualization.html"><a href="visualization.html"><i class="fa fa-check"></i><b>4</b> Visualization</a>
<ul>
<li class="chapter" data-level="4.1" data-path="visualization.html"><a href="visualization.html#ggplot2"><i class="fa fa-check"></i><b>4.1</b> ggplot2</a></li>
<li class="chapter" data-level="4.2" data-path="visualization.html"><a href="visualization.html#plotting-one-variable"><i class="fa fa-check"></i><b>4.2</b> Plotting one variable</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="visualization.html"><a href="visualization.html#histogram"><i class="fa fa-check"></i><b>4.2.1</b> Histogram</a></li>
<li class="chapter" data-level="4.2.2" data-path="visualization.html"><a href="visualization.html#density-plot"><i class="fa fa-check"></i><b>4.2.2</b> Density Plot</a></li>
<li class="chapter" data-level="4.2.3" data-path="visualization.html"><a href="visualization.html#boxplot"><i class="fa fa-check"></i><b>4.2.3</b> boxplot</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="visualization.html"><a href="visualization.html#plotting-two-variables"><i class="fa fa-check"></i><b>4.3</b> Plotting two variables</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="visualization.html"><a href="visualization.html#two-continuous-variables"><i class="fa fa-check"></i><b>4.3.1</b> Two continuous variables</a></li>
<li class="chapter" data-level="4.3.2" data-path="visualization.html"><a href="visualization.html#two-variables-one-discrete"><i class="fa fa-check"></i><b>4.3.2</b> Two variables, one discrete</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="visualization.html"><a href="visualization.html#color-systems"><i class="fa fa-check"></i><b>4.4</b> Color systems</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="visualization.html"><a href="visualization.html#color-from-variable-in-aesthetics"><i class="fa fa-check"></i><b>4.4.1</b> Color from variable, in aesthetics</a></li>
<li class="chapter" data-level="4.4.2" data-path="visualization.html"><a href="visualization.html#trend-line"><i class="fa fa-check"></i><b>4.4.2</b> Trend line</a></li>
<li class="chapter" data-level="4.4.3" data-path="visualization.html"><a href="visualization.html#general-symbology"><i class="fa fa-check"></i><b>4.4.3</b> General symbology</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="visualization.html"><a href="visualization.html#titles-and-subtitles"><i class="fa fa-check"></i><b>4.5</b> Titles and subtitles</a></li>
<li class="chapter" data-level="4.6" data-path="visualization.html"><a href="visualization.html#pairs-plot"><i class="fa fa-check"></i><b>4.6</b> Pairs Plot</a></li>
<li class="chapter" data-level="4.7" data-path="visualization.html"><a href="visualization.html#exercises-2"><i class="fa fa-check"></i><b>4.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-transformation.html"><a href="data-transformation.html"><i class="fa fa-check"></i><b>5</b> Data Transformation</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-transformation.html"><a href="data-transformation.html#data-joins"><i class="fa fa-check"></i><b>5.1</b> Data joins</a></li>
<li class="chapter" data-level="5.2" data-path="data-transformation.html"><a href="data-transformation.html#set-operations"><i class="fa fa-check"></i><b>5.2</b> Set Operations</a></li>
<li class="chapter" data-level="5.3" data-path="data-transformation.html"><a href="data-transformation.html#binding-rows-and-columns"><i class="fa fa-check"></i><b>5.3</b> Binding Rows and Columns</a></li>
<li class="chapter" data-level="5.4" data-path="data-transformation.html"><a href="data-transformation.html#pivotting-data-frames"><i class="fa fa-check"></i><b>5.4</b> Pivotting data frames</a></li>
</ul></li>
<li class="part"><span><b>II Spatial</b></span></li>
<li class="chapter" data-level="6" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html"><i class="fa fa-check"></i><b>6</b> Spatial Data and Maps</a>
<ul>
<li class="chapter" data-level="6.1" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#spatial-data"><i class="fa fa-check"></i><b>6.1</b> Spatial Data</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#examples-of-simple-geometry-building-in-sf"><i class="fa fa-check"></i><b>6.1.1</b> Examples of simple geometry building in sf</a></li>
<li class="chapter" data-level="6.1.2" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#building-a-mappable-sfc-from-scratch"><i class="fa fa-check"></i><b>6.1.2</b> Building a mappable sfc from scratch</a></li>
<li class="chapter" data-level="6.1.3" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#creating-features-from-shapefiles-or-tables"><i class="fa fa-check"></i><b>6.1.3</b> Creating features from shapefiles or tables</a></li>
<li class="chapter" data-level="6.1.4" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#coordinate-referencing-system"><i class="fa fa-check"></i><b>6.1.4</b> Coordinate Referencing System</a></li>
<li class="chapter" data-level="6.1.5" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#spatial-join-st_join"><i class="fa fa-check"></i><b>6.1.5</b> Spatial join <code>st_join</code></a></li>
<li class="chapter" data-level="6.1.6" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#plotting-maps-in-the-base-plot-system"><i class="fa fa-check"></i><b>6.1.6</b> Plotting maps in the base plot system</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#raster-gis-in-r"><i class="fa fa-check"></i><b>6.2</b> Raster GIS in R</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#raster-from-scratch"><i class="fa fa-check"></i><b>6.2.1</b> Raster from scratch</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#ggplot2-for-maps"><i class="fa fa-check"></i><b>6.3</b> ggplot2 for maps</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#rasters-in-ggplot2"><i class="fa fa-check"></i><b>6.3.1</b> Rasters in ggplot2</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#tmap"><i class="fa fa-check"></i><b>6.4</b> tmap</a></li>
<li class="chapter" data-level="6.5" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#interactive-maps"><i class="fa fa-check"></i><b>6.5</b> Interactive Maps</a></li>
<li class="chapter" data-level="6.6" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#exercises-3"><i class="fa fa-check"></i><b>6.6</b> Exercises</a></li>
</ul></li>
<li class="part"><span><b>III Statistics &amp; Modeling</b></span></li>
<li class="chapter" data-level="7" data-path="statistical-summaries-and-tests.html"><a href="statistical-summaries-and-tests.html"><i class="fa fa-check"></i><b>7</b> Statistical Summaries and Tests</a>
<ul>
<li class="chapter" data-level="7.1" data-path="statistical-summaries-and-tests.html"><a href="statistical-summaries-and-tests.html#goals-of-statistical-analysis"><i class="fa fa-check"></i><b>7.1</b> Goals of statistical analysis</a></li>
<li class="chapter" data-level="7.2" data-path="statistical-summaries-and-tests.html"><a href="statistical-summaries-and-tests.html#summary-statistics"><i class="fa fa-check"></i><b>7.2</b> Summary Statistics</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="statistical-summaries-and-tests.html"><a href="statistical-summaries-and-tests.html#summarize-by-group-stratifying-a-summary"><i class="fa fa-check"></i><b>7.2.1</b> Summarize by group: <em>stratifying a summary</em></a></li>
<li class="chapter" data-level="7.2.2" data-path="statistical-summaries-and-tests.html"><a href="statistical-summaries-and-tests.html#boxplot-for-visualizing-distributions-by-group"><i class="fa fa-check"></i><b>7.2.2</b> Boxplot for visualizing distributions by group</a></li>
<li class="chapter" data-level="7.2.3" data-path="statistical-summaries-and-tests.html"><a href="statistical-summaries-and-tests.html#generating-pseudorandom-numbers"><i class="fa fa-check"></i><b>7.2.3</b> Generating pseudorandom numbers</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="statistical-summaries-and-tests.html"><a href="statistical-summaries-and-tests.html#statistical-tests"><i class="fa fa-check"></i><b>7.3</b> Statistical tests</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="statistical-summaries-and-tests.html"><a href="statistical-summaries-and-tests.html#comparing-samples-and-groupings"><i class="fa fa-check"></i><b>7.3.1</b> Comparing samples and groupings</a></li>
<li class="chapter" data-level="7.3.2" data-path="statistical-summaries-and-tests.html"><a href="statistical-summaries-and-tests.html#correlation"><i class="fa fa-check"></i><b>7.3.2</b> Correlation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="modeling-in-r.html"><a href="modeling-in-r.html"><i class="fa fa-check"></i><b>8</b> Modeling in R</a>
<ul>
<li class="chapter" data-level="8.1" data-path="modeling-in-r.html"><a href="modeling-in-r.html#some-common-models"><i class="fa fa-check"></i><b>8.1</b> Some common models</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="modeling-in-r.html"><a href="modeling-in-r.html#analysis-of-covariance"><i class="fa fa-check"></i><b>8.1.1</b> Analysis of Covariance</a></li>
<li class="chapter" data-level="8.1.2" data-path="modeling-in-r.html"><a href="modeling-in-r.html#generalized-linear-model-glm"><i class="fa fa-check"></i><b>8.1.2</b> Generalized Linear Model (GLM)</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="modeling-in-r.html"><a href="modeling-in-r.html#spatial-statistical-analysis"><i class="fa fa-check"></i><b>8.2</b> Spatial Statistical Analysis</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="modeling-in-r.html"><a href="modeling-in-r.html#spatial-autocorrelation"><i class="fa fa-check"></i><b>8.2.1</b> Spatial Autocorrelation</a></li>
<li class="chapter" data-level="8.2.2" data-path="modeling-in-r.html"><a href="modeling-in-r.html#mapping-residuals"><i class="fa fa-check"></i><b>8.2.2</b> Mapping Residuals</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV Time Series</b></span></li>
<li class="chapter" data-level="9" data-path="time-series-visualization-analysis.html"><a href="time-series-visualization-analysis.html"><i class="fa fa-check"></i><b>9</b> Time Series Visualization &amp; Analysis</a>
<ul>
<li class="chapter" data-level="9.1" data-path="time-series-visualization-analysis.html"><a href="time-series-visualization-analysis.html#creation-of-time-series-ts-data"><i class="fa fa-check"></i><b>9.1</b> Creation of time series (ts) data</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="time-series-visualization-analysis.html"><a href="time-series-visualization-analysis.html#frequency-setting"><i class="fa fa-check"></i><b>9.1.1</b> frequency setting</a></li>
<li class="chapter" data-level="9.1.2" data-path="time-series-visualization-analysis.html"><a href="time-series-visualization-analysis.html#data-logger-data-from-marble-mountains-resurgence"><i class="fa fa-check"></i><b>9.1.2</b> Data logger data from Marble Mountains resurgence</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="time-series-visualization-analysis.html"><a href="time-series-visualization-analysis.html#data-smoothing-methods"><i class="fa fa-check"></i><b>9.2</b> Data smoothing methods</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="time-series-visualization-analysis.html"><a href="time-series-visualization-analysis.html#moving-average-ma"><i class="fa fa-check"></i><b>9.2.1</b> moving average (ma)</a></li>
<li class="chapter" data-level="9.2.2" data-path="time-series-visualization-analysis.html"><a href="time-series-visualization-analysis.html#loess-local-regression-smoothing"><i class="fa fa-check"></i><b>9.2.2</b> loess (local regression) smoothing</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="time-series-visualization-analysis.html"><a href="time-series-visualization-analysis.html#decomposing-time-series"><i class="fa fa-check"></i><b>9.3</b> Decomposing time series</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="time-series-visualization-analysis.html"><a href="time-series-visualization-analysis.html#lag-regression"><i class="fa fa-check"></i><b>9.3.1</b> lag regression</a></li>
<li class="chapter" data-level="9.3.2" data-path="time-series-visualization-analysis.html"><a href="time-series-visualization-analysis.html#ensemble-average"><i class="fa fa-check"></i><b>9.3.2</b> Ensemble Average</a></li>
<li class="chapter" data-level="9.3.3" data-path="time-series-visualization-analysis.html"><a href="time-series-visualization-analysis.html#julian-dates"><i class="fa fa-check"></i><b>9.3.3</b> Julian Dates</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="time-series-visualization-analysis.html"><a href="time-series-visualization-analysis.html#learning-more-about-time-series-in-r"><i class="fa fa-check"></i><b>9.4</b> Learning more about time series in R</a></li>
</ul></li>
<li class="part"><span><b>V Communication &amp; Special Topics</b></span></li>
<li class="chapter" data-level="10" data-path="communication.html"><a href="communication.html"><i class="fa fa-check"></i><b>10</b> Communication</a></li>
<li class="chapter" data-level="" data-path="appendix-building-a-data-package-for-github.html"><a href="appendix-building-a-data-package-for-github.html"><i class="fa fa-check"></i>Appendix: Building a Data Package for GitHub</a>
<ul>
<li><a href="appendix-building-a-data-package-for-github.html#rda-files"><code>rda</code> files</a>
<ul>
<li><a href="appendix-building-a-data-package-for-github.html#usethisuse_data"><code>usethis::use_data()</code></a></li>
<li><a href="appendix-building-a-data-package-for-github.html#usethiscreate_package"><code>usethis::create_package()</code></a></li>
<li><a href="appendix-building-a-data-package-for-github.html#devtoolsdocument"><code>devtools::document()</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix-building-a-data-package-for-github.html"><a href="appendix-building-a-data-package-for-github.html#raw-data"><i class="fa fa-check"></i>Raw data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to Environmental Data Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-transformation" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Data Transformation</h1>
<p>The goal of this section is to continue where we started in the earlier chapter on data abstraction with <strong><code>dplyr</code></strong> to look at more transformational functions, and <strong><code>tidyr</code></strong> adds other tools like pivot tables.</p>
<ul>
<li><strong><code>dplyr</code></strong> tools:
<ul>
<li>joins: <code>left_join</code>, <code>right_join</code>, <code>inner_join</code>, <code>full_join</code>, <code>semi_join</code>, <code>anti_join</code></li>
<li>set operations: <code>intersect</code>, <code>union</code>, <code>setdiff</code></li>
<li>binding rows and columns: <code>bind_cols</code>, <code>bind_rows</code></li>
</ul></li>
<li><strong><code>tidyr</code></strong> tools:
<ul>
<li>pivot tables: <code>pivot_longer</code>, <code>pivot_wider</code></li>
</ul></li>
</ul>
<p>The term “data wrangling” has been used for what we’re doing with these tools, and the
relevant cheat sheet is actually called “Data Wrangling”
<a href="https://rstudio.com/wp-content/uploads/2015/02/data-wrangling-cheatsheet.pdf">https://rstudio.com/wp-content/uploads/2015/02/data-wrangling-cheatsheet.pdf</a></p>
<div id="data-joins" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Data joins</h2>
<p>To bring in variables from another data frame based on a common join field.
There are multiple types of joins. Probably the most common is <strong><code>left_join</code></strong> since it starts
from the data frame (or sf) you want to continue working with and bring in data
from an additional source. You’ll retain all records of the first data set.
For any non-matches, NA is assigned. [<strong><code>air_quality</code></strong>]</p>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="data-transformation.html#cb306-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb306-2"><a href="data-transformation.html#cb306-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(iGIScData)</span>
<span id="cb306-3"><a href="data-transformation.html#cb306-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb306-4"><a href="data-transformation.html#cb306-4" aria-hidden="true" tabindex="-1"></a>csvPath <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;CA_MdInc.csv&quot;</span>, <span class="at">package =</span> <span class="st">&quot;iGIScData&quot;</span>)</span>
<span id="cb306-5"><a href="data-transformation.html#cb306-5" aria-hidden="true" tabindex="-1"></a>income <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(csvPath) <span class="sc">%&gt;%</span></span>
<span id="cb306-6"><a href="data-transformation.html#cb306-6" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">select</span>(trID, HHinc2016) <span class="sc">%&gt;%</span></span>
<span id="cb306-7"><a href="data-transformation.html#cb306-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">HHinc2016 =</span> <span class="fu">as.numeric</span>(HHinc2016),</span>
<span id="cb306-8"><a href="data-transformation.html#cb306-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">joinid =</span> <span class="fu">str_c</span>(<span class="st">&quot;0&quot;</span>, trID)) <span class="sc">%&gt;%</span></span>
<span id="cb306-9"><a href="data-transformation.html#cb306-9" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">select</span>(joinid, HHinc2016)</span>
<span id="cb306-10"><a href="data-transformation.html#cb306-10" aria-hidden="true" tabindex="-1"></a>census <span class="ot">&lt;-</span> BayAreaTracts <span class="sc">%&gt;%</span></span>
<span id="cb306-11"><a href="data-transformation.html#cb306-11" aria-hidden="true" tabindex="-1"></a>   <span class="fu">left_join</span>(income, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;FIPS&quot;</span> <span class="ot">=</span> <span class="st">&quot;joinid&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb306-12"><a href="data-transformation.html#cb306-12" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">select</span>(FIPS, POP12_SQMI, POP2012, HHinc2016)</span>
<span id="cb306-13"><a href="data-transformation.html#cb306-13" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(census <span class="sc">%&gt;%</span> <span class="fu">st_set_geometry</span>(<span class="cn">NULL</span>))</span></code></pre></div>
<pre><code>##          FIPS POP12_SQMI POP2012 HHinc2016
## 1 06001400100   1118.797    2976    177417
## 2 06001400200   9130.435    2100    153125
## 3 06001400300  11440.476    4805     85313
## 4 06001400400  14573.077    3789     99539
## 5 06001400500  15582.609    3584     83650
## 6 06001400600  13516.667    1622     61597</code></pre>
<p>Other joins are:</p>
<ul>
<li><strong><code>right_join</code></strong> where you end up retaining all the rows of the second data set
and NA is assigned to non-matches</li>
<li><strong><code>inner_join</code></strong> where you only retain records for matches</li>
<li><strong><code>full_join</code></strong> where records are retained for both sides, and NAs assigned to non-matches</li>
</ul>
<p><strong>Right join example</strong>
We need to join NCDC monthly climate data for all California weather stations to a selection of 82 stations that are in the Sierra.</p>
<ul>
<li>The monthly data has 12 rows (1/month) for each station</li>
<li>The right_join gets all months for all stations, so we weed out the non-Sierra stations by removing NAs from a field only with Sierra station data [<strong><code>sierra</code></strong>]</li>
</ul>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="data-transformation.html#cb308-1" aria-hidden="true" tabindex="-1"></a>sierra <span class="ot">&lt;-</span> <span class="fu">right_join</span>(sierraStations, CA_ClimateNormals, <span class="at">by=</span><span class="st">&quot;STATION&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb308-2"><a href="data-transformation.html#cb308-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(STATION_NA)) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>STATION_NA)</span>
<span id="cb308-3"><a href="data-transformation.html#cb308-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sierra <span class="sc">%&gt;%</span> <span class="fu">filter</span>(DATE <span class="sc">==</span> <span class="st">&quot;01&quot;</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(NAME, ELEVATION, <span class="st">`</span><span class="at">MLY-TAVG-NORMAL</span><span class="st">`</span>), <span class="at">n=</span><span class="dv">10</span>)</span></code></pre></div>
<pre><code>## # A tibble: 10 x 3
##    NAME                              ELEVATION `MLY-TAVG-NORMAL`
##    &lt;chr&gt;                                 &lt;dbl&gt;             &lt;dbl&gt;
##  1 GROVELAND 2, CA US                    853.                5.6
##  2 CANYON DAM, CA US                    1390.                0.2
##  3 KERN RIVER PH 3, CA US                824.                7.6
##  4 DONNER MEMORIAL ST PARK, CA US       1810.               -1.9
##  5 BOWMAN DAM, CA US                    1641.                3  
##  6 BRUSH CREEK RANGER STATION, CA US    1085.               NA  
##  7 GRANT GROVE, CA US                   2012.                1.9
##  8 LEE VINING, CA US                    2072.               -1.2
##  9 OROVILLE MUNICIPAL AIRPORT, CA US      57.9               7.7
## 10 LEMON COVE, CA US                     156.                8.6</code></pre>
<p>The exact same thing however could be accomplished with an inner_join and
it doesn’t required removing the NAs:</p>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="data-transformation.html#cb310-1" aria-hidden="true" tabindex="-1"></a>sierraAlso <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(sierraStations, CA_ClimateNormals, <span class="at">by=</span><span class="st">&quot;STATION&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb310-2"><a href="data-transformation.html#cb310-2" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>STATION_NA)</span></code></pre></div>
</div>
<div id="set-operations" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Set Operations</h2>
<p>Set operations compare two data frames (or vectors) to handle observations or rows that
are the same for each, or not the same. The three set methods are:</p>
<ul>
<li><code>dplyr::</code><strong><code>intersect(x,y)</code></strong> retains rows that appear in <em>both</em> x and y</li>
<li><code>dplyr::</code><strong><code>union(x,y)</code></strong> retains rows that appear in either or both of x and y</li>
<li><code>dplyr::</code><strong><code>setdiff(x,y)</code></strong> retains rows that appear in x but not in y</li>
</ul>
<p>[<strong><code>generic_methods</code></strong>]</p>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="data-transformation.html#cb311-1" aria-hidden="true" tabindex="-1"></a>squares <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb311-2"><a href="data-transformation.html#cb311-2" aria-hidden="true" tabindex="-1"></a>evens <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">100</span>,<span class="dv">2</span>)</span>
<span id="cb311-3"><a href="data-transformation.html#cb311-3" aria-hidden="true" tabindex="-1"></a>squares</span></code></pre></div>
<pre><code>##  [1]   1   4   9  16  25  36  49  64  81 100</code></pre>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="data-transformation.html#cb313-1" aria-hidden="true" tabindex="-1"></a>evens</span></code></pre></div>
<pre><code>##  [1]   0   2   4   6   8  10  12  14  16  18  20  22  24  26  28  30  32  34  36  38  40  42  44  46  48  50  52  54  56  58  60  62  64  66
## [35]  68  70  72  74  76  78  80  82  84  86  88  90  92  94  96  98 100</code></pre>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="data-transformation.html#cb315-1" aria-hidden="true" tabindex="-1"></a><span class="fu">intersect</span>(squares,evens)</span></code></pre></div>
<pre><code>## [1]   4  16  36  64 100</code></pre>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="data-transformation.html#cb317-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(<span class="fu">union</span>(squares,evens))</span></code></pre></div>
<pre><code>##  [1]   0   1   2   4   6   8   9  10  12  14  16  18  20  22  24  25  26  28  30  32  34  36  38  40  42  44  46  48  49  50  52  54  56  58
## [35]  60  62  64  66  68  70  72  74  76  78  80  81  82  84  86  88  90  92  94  96  98 100</code></pre>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="data-transformation.html#cb319-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(<span class="fu">setdiff</span>(squares,evens))</span></code></pre></div>
<pre><code>## [1]  1  9 25 49 81</code></pre>
</div>
<div id="binding-rows-and-columns" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> Binding Rows and Columns</h2>
<p>These <code>dplyr</code> functions are similar to <code>cbind</code> and <code>rbind</code> in base R, but always
creates data frames. For instance, <code>cbind</code> usually creates matrices, and make all vectors
the same class. Note that in <code>bind_cols</code>, the order of data in rows must be the same.</p>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="data-transformation.html#cb321-1" aria-hidden="true" tabindex="-1"></a>states <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(<span class="at">abb=</span>state.abb,</span>
<span id="cb321-2"><a href="data-transformation.html#cb321-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">name=</span>state.name,</span>
<span id="cb321-3"><a href="data-transformation.html#cb321-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">region=</span>state.region,</span>
<span id="cb321-4"><a href="data-transformation.html#cb321-4" aria-hidden="true" tabindex="-1"></a>                    state.x77)</span>
<span id="cb321-5"><a href="data-transformation.html#cb321-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(states)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 11
##   abb   name       region Population Income Illiteracy `Life Exp` Murder `HS Grad` Frost   Area
##   &lt;chr&gt; &lt;chr&gt;      &lt;fct&gt;       &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
## 1 AL    Alabama    South        3615   3624        2.1       69.0   15.1      41.3    20  50708
## 2 AK    Alaska     West          365   6315        1.5       69.3   11.3      66.7   152 566432
## 3 AZ    Arizona    West         2212   4530        1.8       70.6    7.8      58.1    15 113417
## 4 AR    Arkansas   South        2110   3378        1.9       70.7   10.1      39.9    65  51945
## 5 CA    California West        21198   5114        1.1       71.7   10.3      62.6    20 156361
## 6 CO    Colorado   West         2541   4884        0.7       72.1    6.8      63.9   166 103766</code></pre>
<p>To compare, note that <code>cbind</code> converts numeric fields to character when any other
field is character, and character fields are converted to character integers where there are any repeats,
which would require manipulating them into factors:</p>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="data-transformation.html#cb323-1" aria-hidden="true" tabindex="-1"></a>states <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">cbind</span>(<span class="at">abb=</span>state.abb, </span>
<span id="cb323-2"><a href="data-transformation.html#cb323-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">name=</span>state.name, </span>
<span id="cb323-3"><a href="data-transformation.html#cb323-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">region=</span>state.region,</span>
<span id="cb323-4"><a href="data-transformation.html#cb323-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">division=</span>state.division,</span>
<span id="cb323-5"><a href="data-transformation.html#cb323-5" aria-hidden="true" tabindex="-1"></a>                          state.x77))</span>
<span id="cb323-6"><a href="data-transformation.html#cb323-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(states)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 12
##   abb   name       region division Population Income Illiteracy `Life Exp` Murder `HS Grad` Frost Area  
##   &lt;chr&gt; &lt;chr&gt;      &lt;chr&gt;  &lt;chr&gt;    &lt;chr&gt;      &lt;chr&gt;  &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;  &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt; 
## 1 AL    Alabama    2      4        3615       3624   2.1        69.05      15.1   41.3      20    50708 
## 2 AK    Alaska     4      9        365        6315   1.5        69.31      11.3   66.7      152   566432
## 3 AZ    Arizona    4      8        2212       4530   1.8        70.55      7.8    58.1      15    113417
## 4 AR    Arkansas   2      5        2110       3378   1.9        70.66      10.1   39.9      65    51945 
## 5 CA    California 4      9        21198      5114   1.1        71.71      10.3   62.6      20    156361
## 6 CO    Colorado   4      8        2541       4884   0.7        72.06      6.8    63.9      166   103766</code></pre>
</div>
<div id="pivotting-data-frames" class="section level2" number="5.4">
<h2><span class="header-section-number">5.4</span> Pivotting data frames</h2>
<p>Pivot tables are a popular tool in Excel, allowing you to transform your data to be more
useful in a particular analysis. A common need to pivot is 2+ variables with the same data where the variable name should be a factor. <code>Tidyr</code> has <strong><code>pivot_wider</code></strong> and <strong><code>pivot_longer</code></strong>.</p>
<ul>
<li><strong><code>pivot_wider</code></strong> pivots rows into variables.</li>
<li><strong><code>pivot_longer</code></strong> pivots variables into rows, creating factors.</li>
</ul>
<p>In our meadows study cross-section <span class="citation">(<a href="references.html#ref-NDVI" role="doc-biblioref">Davis et al. 2020</a>)</span> created by intersecting normalized difference vegetation index (NDVI) values from multispectral drone imagery with surveyed elevation and vegetation types (xeric, mesic, and hydric), we have fields <code>NDVIgrowing</code> from a July 2019 growing season and <code>NDVIsenescent</code> from a September 2020 dry season, but would like ‘growing’ and ‘senescent’ to be factors with a single <code>NDVI</code> variable. This is how we used <code>pivot_longer</code> to accomplish this, using data from the <code>iGIScData</code> data package [<strong><code>NDVI</code></strong>]:</p>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="data-transformation.html#cb325-1" aria-hidden="true" tabindex="-1"></a>XSptsPheno <span class="ot">&lt;-</span> XSptsNDVI <span class="sc">%&gt;%</span></span>
<span id="cb325-2"><a href="data-transformation.html#cb325-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">&quot;NDVI&quot;</span>), </span>
<span id="cb325-3"><a href="data-transformation.html#cb325-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">names_to =</span> <span class="st">&quot;phenology&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;NDVI&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb325-4"><a href="data-transformation.html#cb325-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">phenology =</span> <span class="fu">str_sub</span>(phenology, <span class="dv">5</span>, <span class="fu">str_length</span>(phenology)))</span></code></pre></div>
<p>Then to do the opposite use <code>pivot_wider</code>:</p>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="data-transformation.html#cb326-1" aria-hidden="true" tabindex="-1"></a>XSptsPheno <span class="sc">%&gt;%</span></span>
<span id="cb326-2"><a href="data-transformation.html#cb326-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> phenology, <span class="at">names_prefix =</span> <span class="st">&quot;NDVI&quot;</span>, </span>
<span id="cb326-3"><a href="data-transformation.html#cb326-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> NDVI)</span></code></pre></div>
<pre><code>## # A tibble: 29 x 6
##    DistNtoS elevation vegetation      geometry                    NDVIgrowing NDVIsenescent
##       &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;           &lt;chr&gt;                             &lt;dbl&gt;         &lt;dbl&gt;
##  1      0       1510. Artemisia       c(718649.456, 4397466.714)        0.326         0.140
##  2     16.7     1510. mixed graminoid c(718649.4309, 4397450.077)       0.627         0.259
##  3     28.6     1510. mixed graminoid c(718649.413, 4397438.222)        0.686         0.329
##  4     30.5     1510. mixed graminoid c(718649.4101, 4397436.33)        0.668         0.282
##  5     31.1     1510. mixed graminoid c(718649.4092, 4397435.732)       0.655         0.266
##  6     33.4     1510. mixed graminoid c(718649.4058, 4397433.441)       0.617         0.274
##  7     35.6     1510. mixed graminoid c(718649.4025, 4397431.249)       0.623         0.275
##  8     37       1510. mixed graminoid c(718649.4004, 4397429.854)       0.589         0.242
##  9     74       1510. mixed graminoid c(718649.3448, 4397392.994)       0.641         0.325
## 10    101       1510. mixed graminoid c(718649.3042, 4397366.097)       0.558         0.312
## # ... with 19 more rows</code></pre>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="data-transformation.html#cb328-1" aria-hidden="true" tabindex="-1"></a>XSptsPheno</span></code></pre></div>
<pre><code>## # A tibble: 58 x 6
##    DistNtoS elevation vegetation      geometry                    phenology  NDVI
##       &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;           &lt;chr&gt;                       &lt;chr&gt;     &lt;dbl&gt;
##  1      0       1510. Artemisia       c(718649.456, 4397466.714)  growing   0.326
##  2      0       1510. Artemisia       c(718649.456, 4397466.714)  senescent 0.140
##  3     16.7     1510. mixed graminoid c(718649.4309, 4397450.077) growing   0.627
##  4     16.7     1510. mixed graminoid c(718649.4309, 4397450.077) senescent 0.259
##  5     28.6     1510. mixed graminoid c(718649.413, 4397438.222)  growing   0.686
##  6     28.6     1510. mixed graminoid c(718649.413, 4397438.222)  senescent 0.329
##  7     30.5     1510. mixed graminoid c(718649.4101, 4397436.33)  growing   0.668
##  8     30.5     1510. mixed graminoid c(718649.4101, 4397436.33)  senescent 0.282
##  9     31.1     1510. mixed graminoid c(718649.4092, 4397435.732) growing   0.655
## 10     31.1     1510. mixed graminoid c(718649.4092, 4397435.732) senescent 0.266
## # ... with 48 more rows</code></pre>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb330-1"><a href="data-transformation.html#cb330-1" aria-hidden="true" tabindex="-1"></a>XSptsPheno <span class="sc">%&gt;%</span></span>
<span id="cb330-2"><a href="data-transformation.html#cb330-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb330-3"><a href="data-transformation.html#cb330-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(elevation, NDVI, <span class="at">shape=</span>vegetation, </span>
<span id="cb330-4"><a href="data-transformation.html#cb330-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> phenology), <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb330-5"><a href="data-transformation.html#cb330-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(elevation, NDVI, </span>
<span id="cb330-6"><a href="data-transformation.html#cb330-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> phenology), <span class="at">method=</span><span class="st">&quot;lm&quot;</span>)</span></code></pre></div>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-134-1.png" width="672" /></p>
<p>Pivots turn out to be commonly useful. Runoff graphing from the Eucalyptus/Oak study <span class="citation">(<a href="references.html#ref-eucoak" role="doc-biblioref">Thompson, Davis, and Oliphant 2016</a>)</span> also benefited
from a pivot_longer [<strong><code>eucoak</code></strong>]:</p>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="data-transformation.html#cb331-1" aria-hidden="true" tabindex="-1"></a>eucoakrainfallrunoffTDR <span class="sc">%&gt;%</span></span>
<span id="cb331-2"><a href="data-transformation.html#cb331-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">&quot;runoffL&quot;</span>),</span>
<span id="cb331-3"><a href="data-transformation.html#cb331-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;tree&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;runoffL&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb331-4"><a href="data-transformation.html#cb331-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tree =</span> <span class="fu">str_sub</span>(tree, <span class="fu">str_length</span>(tree)<span class="sc">-</span><span class="dv">2</span>, <span class="fu">str_length</span>(tree))) <span class="sc">%&gt;%</span></span>
<span id="cb331-5"><a href="data-transformation.html#cb331-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(site, runoffL)) <span class="sc">+</span></span>
<span id="cb331-6"><a href="data-transformation.html#cb331-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(tree <span class="sc">~</span> .)</span></code></pre></div>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-135-1.png" width="672" /></p>
<p><strong>Combining a pivot with bind_rows to create a runoff/rainfall scatterplot colored by tree</strong></p>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb332-1"><a href="data-transformation.html#cb332-1" aria-hidden="true" tabindex="-1"></a>runoffPivot <span class="ot">&lt;-</span> eucoakrainfallrunoffTDR <span class="sc">%&gt;%</span></span>
<span id="cb332-2"><a href="data-transformation.html#cb332-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">&quot;runoffL&quot;</span>),</span>
<span id="cb332-3"><a href="data-transformation.html#cb332-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;tree&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;runoffL&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb332-4"><a href="data-transformation.html#cb332-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tree =</span> <span class="fu">str_sub</span>(tree, <span class="fu">str_length</span>(tree)<span class="sc">-</span><span class="dv">2</span>, <span class="fu">str_length</span>(tree)),</span>
<span id="cb332-5"><a href="data-transformation.html#cb332-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">Date =</span> <span class="fu">as.Date</span>(date, <span class="st">&quot;%m/%d/%Y&quot;</span>))</span>
<span id="cb332-6"><a href="data-transformation.html#cb332-6" aria-hidden="true" tabindex="-1"></a>euc <span class="ot">&lt;-</span> runoffPivot <span class="sc">%&gt;%</span></span>
<span id="cb332-7"><a href="data-transformation.html#cb332-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(tree <span class="sc">==</span> <span class="st">&quot;euc&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb332-8"><a href="data-transformation.html#cb332-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rain_subcanopy =</span> rain_euc,</span>
<span id="cb332-9"><a href="data-transformation.html#cb332-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">slope =</span> slope_euc,    <span class="at">aspect =</span> aspect_euc,</span>
<span id="cb332-10"><a href="data-transformation.html#cb332-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">surface_tension =</span> surface_tension_euc,</span>
<span id="cb332-11"><a href="data-transformation.html#cb332-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">runoff_rainfall_ratio =</span> runoff_rainfall_ratio_euc) <span class="sc">%&gt;%</span></span>
<span id="cb332-12"><a href="data-transformation.html#cb332-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(site, <span class="st">`</span><span class="at">site #</span><span class="st">`</span>, tree, Date, month, rain_mm, </span>
<span id="cb332-13"><a href="data-transformation.html#cb332-13" aria-hidden="true" tabindex="-1"></a>         rain_subcanopy, slope, aspect, runoffL,     </span>
<span id="cb332-14"><a href="data-transformation.html#cb332-14" aria-hidden="true" tabindex="-1"></a>         surface_tension, runoff_rainfall_ratio)</span>
<span id="cb332-15"><a href="data-transformation.html#cb332-15" aria-hidden="true" tabindex="-1"></a>oak <span class="ot">&lt;-</span> runoffPivot <span class="sc">%&gt;%</span></span>
<span id="cb332-16"><a href="data-transformation.html#cb332-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(tree <span class="sc">==</span> <span class="st">&quot;oak&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb332-17"><a href="data-transformation.html#cb332-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rain_subcanopy =</span> rain_oak,</span>
<span id="cb332-18"><a href="data-transformation.html#cb332-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">slope =</span> slope_oak, <span class="at">aspect =</span> aspect_oak,</span>
<span id="cb332-19"><a href="data-transformation.html#cb332-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">surface_tension =</span> surface_tension_oak,</span>
<span id="cb332-20"><a href="data-transformation.html#cb332-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">runoff_rainfall_ratio =</span> runoff_rainfall_ratio_oak) <span class="sc">%&gt;%</span></span>
<span id="cb332-21"><a href="data-transformation.html#cb332-21" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(site, <span class="st">`</span><span class="at">site #</span><span class="st">`</span>, tree, Date, month, rain_mm, </span>
<span id="cb332-22"><a href="data-transformation.html#cb332-22" aria-hidden="true" tabindex="-1"></a>         rain_subcanopy, slope, aspect, runoffL, </span>
<span id="cb332-23"><a href="data-transformation.html#cb332-23" aria-hidden="true" tabindex="-1"></a>         surface_tension, runoff_rainfall_ratio)</span>
<span id="cb332-24"><a href="data-transformation.html#cb332-24" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(euc, oak) <span class="sc">%&gt;%</span></span>
<span id="cb332-25"><a href="data-transformation.html#cb332-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb332-26"><a href="data-transformation.html#cb332-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> rain_mm, <span class="at">y =</span> runoffL, <span class="at">color =</span> tree)) <span class="sc">+</span></span>
<span id="cb332-27"><a href="data-transformation.html#cb332-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> rain_mm, <span class="at">y=</span> runoffL, <span class="at">color =</span> tree), </span>
<span id="cb332-28"><a href="data-transformation.html#cb332-28" aria-hidden="true" tabindex="-1"></a>              <span class="at">method =</span> <span class="st">&quot;lm&quot;</span>) <span class="sc">+</span></span>
<span id="cb332-29"><a href="data-transformation.html#cb332-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;seagreen4&quot;</span>, <span class="st">&quot;orange3&quot;</span>))</span></code></pre></div>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-136-1.png" width="672" /></p>
<p><strong>Using pivot_wider with traffic stop data</strong> <span class="citation">(<a href="references.html#ref-Engel" role="doc-biblioref">Engel 2020</a>)</span></p>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="data-transformation.html#cb333-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb333-2"><a href="data-transformation.html#cb333-2" aria-hidden="true" tabindex="-1"></a>csvPath <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>,<span class="st">&quot;MS_trafficstops_bw_age.csv&quot;</span>, <span class="at">package=</span><span class="st">&quot;iGIScData&quot;</span>)</span>
<span id="cb333-3"><a href="data-transformation.html#cb333-3" aria-hidden="true" tabindex="-1"></a>trafficStops <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(csvPath) <span class="sc">%&gt;%</span></span>
<span id="cb333-4"><a href="data-transformation.html#cb333-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">year</span>(stop_date))</span>
<span id="cb333-5"><a href="data-transformation.html#cb333-5" aria-hidden="true" tabindex="-1"></a>trafficCounts <span class="ot">&lt;-</span> trafficStops <span class="sc">%&gt;%</span></span>
<span id="cb333-6"><a href="data-transformation.html#cb333-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(year,violation_raw)</span>
<span id="cb333-7"><a href="data-transformation.html#cb333-7" aria-hidden="true" tabindex="-1"></a>trafficCounts <span class="sc">%&gt;%</span></span>
<span id="cb333-8"><a href="data-transformation.html#cb333-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> year, </span>
<span id="cb333-9"><a href="data-transformation.html#cb333-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> n)</span></code></pre></div>
<pre><code>## # A tibble: 19 x 5
##    violation_raw                                               `2013` `2014` `2015` `2016`
##    &lt;chr&gt;                                                        &lt;int&gt;  &lt;int&gt;  &lt;int&gt;  &lt;int&gt;
##  1 ??                                                            5018   4368   2935    682
##  2 Careless driving                                               607    561    709    270
##  3 Child or youth restraint not used properly as required        1313    873    709    286
##  4 Driving while license suspended                               3258   2306   2455    516
##  5 Driving wrong way                                               40     33     38     14
##  6 Expired or no non-commercial driver license or permit         1433    984   1166    358
##  7 Failure to comply with financial responsibility law              1      1     NA     NA
##  8 Failure to maintain required liability insurance              7096   5193   7889   2874
##  9 Failure to obey sign or traffic control device                 607    356    388    122
## 10 Failure to yield right of way (FTY ROW)                        292    206    203     65
## 11 Following too closely                                          179    117    153     41
## 12 Improper passing                                               178    155    178     71
## 13 Improper turn                                                   65     54     67     22
## 14 Operating without equipment as required by law                 967    744    964    425
## 15 Other (non-mapped)                                             421    289    365    129
## 16 Reckless driving                                               233    229    284    125
## 17 Seat belt not used properly as required                       7027   5768   4912   2547
## 18 Speeding                                                       713    948    978    167
## 19 Speeding - Regulated or posted speed limit and actual speed  39818  31888  38721  15044</code></pre>
<p>Note that this table is <em>not</em> tidy, but provides a useful table for a report.</p>

</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="visualization.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="spatial-data-and-maps.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["EnvDataSci.pdf", "EnvDataSci.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
